import{d as e,s as t,c as a}from"../js1/_pinia-796b47ce.js";import{j as l,o as n,K as r,L as i,U as o,ad as s,f as u,i as d,e as p,a as c,M as m,V as h,c as g,a6 as f,R as b,S as _,T as y,al as v,am as x,r as w,p as S,u as k,H as V,h as j,Z as D,E as A,w as C,Q as I,an as T}from"../js1/_@vue-46c95455.js";import{z as L,E,a as J,b as N,c as P,d as O,e as R,f as M,g as U,h as z,i as F,j as $,k as q,l as K,m as X,n as Y,o as B,p as G,q as H,r as Q,s as W,t as Z,u as ee,v as te,w as ae,x as le,y as ne,A as re,B as ie,C as oe}from"../js1/_element-plus-4dc71243.js";import{K as se,L as ue,M as de,N as pe,O as ce,P as me}from"../js1/__vendor-8d669b31.js";import{y as he,q as ge,A as fe}from"../js1/_@element-plus-983fc0bb.js";import{u as be,r as _e,w as ye}from"../js1/_xlsx-504b59f4.js";!function(){const e=document.createElement("link").relList;if(!(e&&e.supports&&e.supports("modulepreload"))){for(const e of document.querySelectorAll('link[rel="modulepreload"]'))t(e);new MutationObserver((e=>{for(const a of e)if("childList"===a.type)for(const e of a.addedNodes)"LINK"===e.tagName&&"modulepreload"===e.rel&&t(e)})).observe(document,{childList:!0,subtree:!0})}function t(e){if(e.ep)return;e.ep=!0;const t=function(e){const t={};return e.integrity&&(t.integrity=e.integrity),e.referrerpolicy&&(t.referrerPolicy=e.referrerpolicy),"use-credentials"===e.crossorigin?t.credentials="include":"anonymous"===e.crossorigin?t.credentials="omit":t.credentials="same-origin",t}(e);fetch(e.href,t)}}();const ve=(e,t)=>{const a=e.__vccOpts||e;for(const[l,n]of t)a[l]=n;return a};const xe=ve(l({name:"App",setup:()=>({zIndex:3e3,locale:L})}),[["render",function(e,t,a,l,u,d){const p=s("router-view"),c=E;return n(),r(c,{locale:e.locale,"z-index":e.zIndex},{default:i((()=>[o(p)])),_:1},8,["locale","z-index"])}]]),we=[{name:"奥德赛",leibie:"日本",parent:"本田"},{name:"宝马",leibie:"德国",parent:""},{name:"北京现代",leibie:"其他",parent:""},{name:"奔驰",leibie:"德国",parent:""},{name:"奥迪",leibie:"德国",parent:""},{name:"比亚迪",leibie:"中国",parent:""},{name:"别克",leibie:"美国",parent:""},{name:"宾利",leibie:"英国",parent:""},{name:"长安",leibie:"中国",parent:""},{name:"大众",leibie:"德国",parent:""},{name:"谛艾仕",leibie:"法国",parent:""},{name:"帝豪",leibie:"中国",parent:""},{name:"东风日产",leibie:"其他",parent:""},{name:"东风天龙",leibie:"中国",parent:"吉利"},{name:"东风雪铁龙",leibie:"其他",parent:""},{name:"东风悦达起亚",leibie:"其他",parent:""},{name:"风神",leibie:"中国",parent:""},{name:"丰田",leibie:"日本",parent:""},{name:"广丰",leibie:"日本",parent:"丰田"},{name:"福特",leibie:"美国",parent:""},{name:"福田",leibie:"中国",parent:""},{name:"广汽本田",leibie:"其他",parent:""},{name:"哈弗",leibie:"中国",parent:""},{name:"江淮",leibie:"中国",parent:""},{name:"捷豹",leibie:"英国",parent:""},{name:"晶马",leibie:"中国",parent:""},{name:"凯迪拉克",leibie:"美国",parent:"江铃"},{name:"路虎",leibie:"英国",parent:""},{name:"玛莎拉蒂",leibie:"意大利",parent:""},{name:"马自达",leibie:"日本",parent:""},{name:"尼桑",leibie:"日本",parent:""},{name:"欧曼",leibie:"其他",parent:""},{name:"荣威",leibie:"中国",parent:""},{name:"三菱",leibie:"日本",parent:""},{name:"尚酷",leibie:"德国",parent:"大众"},{name:"斯柯达",leibie:"德国",parent:""},{name:"索兰托",leibie:"韩国",parent:"起亚"},{name:"特斯拉",leibie:"美国",parent:""},{name:"沃尔沃",leibie:"瑞典",parent:""},{name:"五菱",leibie:"中国",parent:""},{name:"现代",leibie:"韩国",parent:""},{name:"雪佛兰",leibie:"美国",parent:""},{name:"雅阁",leibie:"日本",parent:"本田"},{name:"缤智",leibie:"日本",parent:"本田"},{name:"英菲尼迪",leibie:"日本",parent:""},{name:"中华",leibie:"中国",parent:""},{name:"中骏",leibie:"中国",parent:""},{name:"中联",leibie:"中国",parent:""},{name:"东风",leibie:"中国",parent:""},{name:"克莱斯勒",leibie:"美国",parent:""},{name:"北京",leibie:"中国",parent:""},{name:"长城",leibie:"中国",parent:""},{name:"奥铃",leibie:"中国",parent:"福田"},{name:"海马",leibie:"中国",parent:""},{name:"红旗",leibie:"中国",parent:""},{name:"几何",leibie:"中国",parent:"吉利"},{name:"庆铃",leibie:"中国",parent:""},{name:"思威",leibie:"日本",parent:"本田"},{name:"腾势",leibie:"其他",parent:""},{name:"翼虎",leibie:"中国",parent:"长安"},{name:"欧拉",leibie:"中国",parent:"长城"},{name:"远程",leibie:"中国",parent:"吉利"},{name:"圣玛托",leibie:"美国",parent:""},{name:"捷途",leibie:"中国",parent:"奇瑞"},{name:"长城风骏7",leibie:"中国",parent:"长城"}],Se=e=>{let t="无品牌类别",a=()=>{let a=[];return null!=e.value&&e.value.length>0&&(a=e.value.split("\n")),a.length>0&&(a=a.filter((e=>null!=e&&e.length>0))),0==a.length?[]:a.map((e=>{let a=e.split("\t"),l={};l.date=a[0]&&a[0].trim()||"无日期",l.dingsunyuan=a[1]&&a[1].trim()||"无定损员",l.xiaoshouyuan=a[2]&&a[2].trim()||"无销售员",l.chepai=a[3]&&a[3].trim()||"车牌",l.pinpai=a[4]&&a[4].trim()||"品牌",l.isChengJiao=!(!a[5]||"是"!=a[5].trim()),l.jine=a[6]&&parseInt(a[6].trim())||0,l.pinpai_leibie=t;try{"品牌"!=l.pinpai&&(l.pinpai_leibie=(n=l.pinpai,we.filter((e=>e.name==n||e.parent==n)))[0].leibie)}catch(r){console.error(l,r)}var n;return l}))};const l=u((()=>a())),n=u((()=>{let e=0;return l.value&&l.value.length>0&&l.value.forEach((t=>{isNaN(t.jine)||(e+=t.jine)})),e})),r=u((()=>l.value&&l.value.length>0?l.value.filter((e=>e.pinpai_leibie==t)):[])),i=u((()=>{let e=0,t=[];return l.value&&l.value.length>0&&(t=l.value.filter((t=>!!t.isChengJiao&&(e+=t.jine,!0)))),{list:t,totalAmount:e}}));return{dataList:l,totalAmount:n,chengJiaoData:i,noPinPaiDataList:r}},ke=(e,t,a)=>u((()=>function(){let l=["询价单数","询价金额","供应单数","供应金额","未供应单数","未供应金额"],n=[];if(e.value&&e.value.length>0){n.push({key:l[0],num:e.value.length,rate:1}),n.push({key:l[1],num:t.value,rate:1}),n.push({key:l[2],num:a.value.list.length,rate:a.value.list.length/e.value.length}),n.push({key:l[3],num:a.value.totalAmount,rate:a.value.totalAmount/t.value});let r=e.value.length-a.value.list.length;n.push({key:l[4],num:r,rate:r/e.value.length});let i=t.value-a.value.totalAmount;n.push({key:l[5],num:i,rate:i/t.value})}return n}())),Ve=l({name:"TotalAnalyse",setup(){const e=d("dataList"),t=d("totalAmount"),a=d("chengJiaoData"),l=ke(e,t,a);return p((()=>{new se("#totalTable")})),{totalAnalyse:l}}}),je=c("span",null,"报价总量分析",-1);const De=ve(Ve,[["render",function(e,t,a,l,s,u){const d=J,p=N,c=P;return n(),r(c,{class:"box-card",id:"totalCard"},{header:i((()=>[je])),default:i((()=>[o(p,{data:e.totalAnalyse,id:"totalTable","data-clipboard-target":"#totalCard",style:{width:"100%"},size:"small"},{default:i((()=>[o(d,{type:"index",label:"序号"}),o(d,{prop:"key",label:"类型"}),o(d,{prop:"num",label:"数量"}),o(d,{prop:"rate",label:"占比"})])),_:1},8,["data"])])),_:1})}]]);const Ae=(e,t)=>{function a(){let a={};return e.value&&e.value.length>0&&(e.value.sort(((e,t)=>e.pinpai_leibie.localeCompare(t.pinpai_leibie))),e.value.forEach((e=>{var t;a[e.pinpai_leibie]?function(e,t){e.total+=1,e.jine+=t.jine,e.chengJiaoTotal+=t.isChengJiao?1:0,e.chengJiaoJine+=t.isChengJiao&&t.jine||0}(a[e.pinpai_leibie],e):a[e.pinpai_leibie]={pinpai_leibie:(t=e).pinpai_leibie,total:1,jine:t.jine,totalRate:0,jineRate:0,chengJiaoTotal:t.isChengJiao?1:0,chengJiaoJine:t.isChengJiao&&t.jine||0}})),function(e,t,a){Object.keys(e).forEach((l=>{e[l].totalRate=e[l].total/t,e[l].jineRate=e[l].jine/a}))}(a,e.value.length,t.value)),a}return u((()=>a()))},Ce=l({name:"PinPaiAnalyse",setup(){const e=d("dataList"),t=d("totalAmount"),a=Ae(e,t),l=u((()=>Object.values(a.value)));return p((()=>{new se("#pinpaiTable")})),{tableData:l}}}),Ie=c("span",null,"品牌构成分析",-1);const Te=ve(Ce,[["render",function(e,t,a,l,s,u){const d=J,p=N,c=P;return n(),r(c,{class:"box-card",id:"pinpaiCard"},{header:i((()=>[Ie])),default:i((()=>[o(p,{data:e.tableData,id:"pinpaiTable","data-clipboard-target":"#pinpaiCard",style:{width:"100%"},size:"small","show-summary":""},{default:i((()=>[o(d,{type:"index",label:"序号"}),o(d,{prop:"pinpai_leibie",label:"类型"}),o(d,{prop:"total",label:"数量（份）"}),o(d,{prop:"jine",label:"金额"}),o(d,{prop:"totalRate",label:"数量占比"}),o(d,{prop:"jineRate",label:"金额占比"}),o(d,{prop:"chengJiaoTotal",label:"成交数量"}),o(d,{prop:"chengJiaoJine",label:"成交金额"})])),_:1},8,["data"])])),_:1})}]]);const Le=(e,t)=>{let a=()=>{let a={};return e.value&&e.value.length>0&&(e.value.sort(((e,t)=>e.dingsunyuan.localeCompare(t.dingsunyuan))),e.value.forEach((e=>{var t;a[e.dingsunyuan]?function(e,t){e.total+=1,e.jine+=t.jine,e.chengJiaoTotal+=t.isChengJiao?1:0,e.chengJiaoJine+=t.isChengJiao&&t.jine||0}(a[e.dingsunyuan],e):a[e.dingsunyuan]={total:1,jine:(t=e).jine,totalRate:0,jineRate:0,chengJiaoTotal:t.isChengJiao?1:0,chengJiaoJine:t.isChengJiao&&t.jine||0,dingsunyuan:t.dingsunyuan}})),function(e,t,a){Object.keys(e).forEach((l=>{e[l].totalRate=e[l].total/t,e[l].jineRate=e[l].jine/a}))}(a,e.value.length,t.value)),a};return u((()=>a()))},Ee=l({name:"DingSunYuanAnalyse",setup(){const e=d("dataList"),t=d("totalAmount"),a=Le(e,t),l=u((()=>Object.values(a.value)));return p((()=>{new se("#dsytable")})),{tableData:l}}}),Je=c("span",null,"定损员分析",-1);const Ne=ve(Ee,[["render",function(e,t,a,l,s,u){const d=J,p=N,c=P;return n(),r(c,{class:"box-card",id:"dsycard"},{header:i((()=>[Je])),default:i((()=>[o(p,{data:e.tableData,id:"dsytable","data-clipboard-target":"#dsycard",style:{width:"100%"},size:"small","show-summary":""},{default:i((()=>[o(d,{type:"index",label:"序号"}),o(d,{prop:"dingsunyuan",label:"类型"}),o(d,{prop:"total",label:"数量（份）"}),o(d,{prop:"jine",label:"金额"}),o(d,{prop:"totalRate",label:"数量占比"}),o(d,{prop:"jineRate",label:"金额占比"}),o(d,{prop:"chengJiaoTotal",label:"成交数量"}),o(d,{prop:"chengJiaoJine",label:"成交金额"})])),_:1},8,["data"])])),_:1})}]]),Pe=l({name:"DingSunYuanAnalyse",setup(){const e=d("dataList"),t=u((()=>{let t={};return e.value&&e.value.length>0?(e.value.sort(((e,t)=>e.xiaoshouyuan.localeCompare(t.xiaoshouyuan))),e.value.forEach((e=>{t[e.xiaoshouyuan]?(t[e.xiaoshouyuan].total+=1,t[e.xiaoshouyuan].chengJiaoTotal+=e.isChengJiao?1:0):t[e.xiaoshouyuan]={xiaoshouyuan:e.xiaoshouyuan,total:1,chengJiaoTotal:e.isChengJiao?1:0}})),Object.values(t)):[]}));return p((()=>{new se("#xsytable")})),{tableData:t}}}),Oe=c("span",null,"销售员分析",-1);const Re=ve(Pe,[["render",function(e,t,a,l,s,u){const d=J,p=N,c=P;return n(),r(c,{class:"box-card",id:"xsycard"},{header:i((()=>[Oe])),default:i((()=>[o(p,{data:e.tableData,id:"xsytable","data-clipboard-target":"#xsycard",style:{width:"100%"},size:"small","show-summary":""},{default:i((()=>[o(d,{type:"index",label:"序号"}),o(d,{prop:"xiaoshouyuan",label:"销售员"}),o(d,{prop:"total",label:"总量"}),o(d,{prop:"chengJiaoTotal",label:"成交数量"})])),_:1},8,["data"])])),_:1})}]]),Me=l({name:"NoPinPaiList",setup(){const e=d("noPinPaiList"),t=u((()=>e.value.length>0));return{noPinPaiList:e,showable:t}}}),Ue=(e=>(v("data-v-6cec74d4"),e=e(),x(),e))((()=>c("span",null,"无品牌类型",-1)));const ze=l({name:"TongJi",components:{TotalAnalyse:De,PinPaiAnalyse:Te,DingSunYuanAnalyse:Ne,XiaoShouYuanAnalyse:Re,NoPinPaiList:ve(Me,[["render",function(e,t,a,l,o,s){const u=O,d=P;return m((n(),r(d,{class:"box-card"},{header:i((()=>[Ue])),default:i((()=>[(n(!0),g(y,null,f(e.noPinPaiList,((e,t)=>(n(),r(u,{key:t},{default:i((()=>[b(_(e.pinpai),1)])),_:2},1024)))),128))])),_:1},512)),[[h,e.showable]])}],["__scopeId","data-v-6cec74d4"]])},setup(){const e={date:"日期",dingsunyuan:"定损员",xiaoshouyuan:"销售员",chepai:"车牌",pinpai:"品牌",isChengJiao:"是否成交",jine:"金额",pinpai_leibie:"品牌类别"},t=w(""),{dataList:a,totalAmount:l,chengJiaoData:n,noPinPaiDataList:r}=Se(t);return S("dataList",a),S("totalAmount",l),S("chengJiaoData",n),S("noPinPaiList",r),{headTableItem:e,content:t,dataList:a,totalAmount:l,chengJiaoData:n}}}),Fe={style:{width:"100%"}};const $e=ve(ze,[["render",function(e,t,a,l,r,u){const d=R,p=M,m=s("no-pin-pai-list"),h=s("total-analyse"),b=s("ding-sun-yuan-analyse"),v=U,x=s("xiao-shou-yuan-analyse"),w=s("pin-pai-analyse");return n(),g(y,null,[o(p,null,{default:i((()=>[c("table",Fe,[c("tr",null,[(n(!0),g(y,null,f(e.headTableItem,((e,t)=>(n(),g("th",{key:t},_(e),1)))),128))])]),o(d,{modelValue:e.content,"onUpdate:modelValue":t[0]||(t[0]=t=>e.content=t),rows:22,type:"textarea",placeholder:"请复制数据至此"},null,8,["modelValue"])])),_:1}),o(p,null,{default:i((()=>[o(m)])),_:1}),o(p,{gutter:10},{default:i((()=>[o(v,{span:12},{default:i((()=>[o(h),o(b)])),_:1}),o(v,{span:12},{default:i((()=>[o(x),o(w)])),_:1})])),_:1})],64)}]]),qe=e=>(v("data-v-e82166c8"),e=e(),x(),e),Ke={class:"card-header"},Xe=qe((()=>c("span",{style:{color:"var(--el-color-info)"}},"点击可自动复制",-1))),Ye=qe((()=>c("span",null,"计算后结果",-1))),Be=qe((()=>c("span",null,"结果",-1))),Ge=ve(l({__name:"result",props:{showComputedList:Array,totalCount:[Number,String],showList:Array,region:String},setup(e){const{toClipboard:t}=ue(),a=w("https://docs.qq.com/sheet/DS0FkVVhwd29KdHNk"),l=async e=>{try{if(null==e)return;let a=Array.isArray(e)&&e.join("\n")||e.toString();await t(a),F({message:"复制成功",type:"success"})}catch(a){console.error(a),F.error(a.message||"真奇怪，不知道哪里错了。")}};return(t,r)=>{const s=z,u=U,d=M,p=P;return n(),g("div",null,[o(p,null,{header:i((()=>[c("div",Ke,[Xe,o(s,{type:"primary",href:k(a),target:"_blank"},{default:i((()=>[b("打开腾讯文档")])),_:1},8,["href"])])])),default:i((()=>[o(d,{gutter:10},{default:i((()=>[o(u,{span:10},{default:i((()=>[V(t.$slots,"default",{},void 0,!0)])),_:3}),o(u,{span:14,onClick:r[0]||(r[0]=t=>l(e.totalCount))},{default:i((()=>[b(" 总计："+_(e.totalCount),1)])),_:1})])),_:3})])),_:3}),o(d,null,{default:i((()=>[o(u,{span:16},{default:i((()=>[o(p,{onClick:r[1]||(r[1]=t=>l(e.showComputedList))},{header:i((()=>[Ye])),default:i((()=>[(n(!0),g(y,null,f(e.showComputedList,((e,t)=>(n(),g("div",{key:t},_(e),1)))),128))])),_:1})])),_:1}),o(u,{span:8},{default:i((()=>[o(p,{onClick:r[2]||(r[2]=t=>l(e.showList))},{header:i((()=>[Be])),default:i((()=>[(n(!0),g(y,null,f(e.showList,((e,t)=>(n(),g("div",{key:t},_(e),1)))),128))])),_:1})])),_:1})])),_:1})])}}}),[["__scopeId","data-v-e82166c8"]]),He={class:"upload-wapper"},Qe={class:"el-image"},We=["src"],Ze={class:"tips"},et=c("small",{style:{color:"var(--el-text-color-disabled)"}},"图片可缩放，也可移动",-1),tt=c("div",{class:"el-upload__text"},"拖拽或上传文件",-1),at=l({__name:"upload",setup(e){const t=w(),a=w(""),l=w(1),r=w(1);w(null);const{handleMousedown:s,handleMousemove:u,handleMouseup:d,translate:p,init:m}=(()=>{const e={x:0,y:0},t=j({x:0,y:0});let a=!1;return{handleMousedown:t=>{a=!0,e.x=t.clientX,e.y=t.clientY,t.preventDefault()},handleMousemove:l=>(a&&(t.x=l.clientX-e.x,t.y=l.clientY-e.y),!1),handleMouseup:e=>{a=!1},translate:t,init:()=>{t.x=0,t.y=0}}})(),h=e=>{e&&e.hasOwnProperty("url")&&(a.value=e.url||"")},f=()=>{r.value=1,m()},_=e=>{t.value.clearFiles();const a=e[0];a.uid=+new Date,t.value.handleStart(a)},y=e=>(e.deltaY<0?r.value<2?r.value+=.2:r.value=2:e.deltaY>0&&(r.value>.4?r.value-=.2:r.value=.4),!1);return(e,m)=>{const v=$,x=q;return n(),g("div",He,[c("div",Qe,[c("img",{src:k(a),onWheel:y,onMousemove:m[0]||(m[0]=(...e)=>k(u)&&k(u)(...e)),onMousedown:m[1]||(m[1]=(...e)=>k(s)&&k(s)(...e)),onMouseup:m[2]||(m[2]=(...e)=>k(d)&&k(d)(...e)),style:D({transform:"scale("+k(r)+") translate("+k(p).x+"px, "+k(p).y+"px)","object-fit":"contain"}),class:"el-image__inner"},null,44,We)]),c("p",Ze,[et,c("span",{onClick:f},[b("图片还原"),o(v,null,{default:i((()=>[o(k(he))])),_:1})])]),o(x,{action:"#",drag:"",ref_key:"upload",ref:t,"auto-upload":!1,limit:k(l),"list-type":"picture","on-change":h,"on-exceed":_},{default:i((()=>[o(v,{class:"el-icon--upload"},{default:i((()=>[o(k(ge))])),_:1}),tt])),_:1},8,["limit"])])}}}),lt=c("legend",null,"分隔符：",-1),nt=l({__name:"index",setup(e){const t=w(""),a=w(["请在此输入输入","一行一组","以空格相格","例如：","123 32 23 3","56 65 45 3","234 42 34 6"].join("\n")),l={SPACE:{label:"空格",value:" "},X:{label:"X;",value:"X"}},s=w(""),d=w(l.SPACE.value);let p=u((()=>{let e=t.value.trim();if(!e)return[];let a=e.split("\n");return a&&0!=a.length?(a[0].includes(l.X.value)?d.value=l.X.value:d.value=l.SPACE.value,a.map((e=>{let t=function(e,t){if(t==l.SPACE.value)return e.trim().split(t);if(t==l.X.value){let a=e.trim().split(t),l=a[2].split(";");return[a[0],a[1],l[0],l[1]]}}(e,d.value);return{len:t[0],width:t[1],height:t[2],count:t[3]}}))):[]})),m=u((()=>p.value.map((e=>e.len+"X"+e.width+"X"+e.height+";"+e.count)))),h=u((()=>p.value.map((e=>e.len+"X"+e.width+"X"+e.height+"X"+e.count+"="+e.len*e.width*e.height*e.count)))),v=u((()=>{let e=0;return p.value.forEach((t=>{e+=t.len*t.width*t.height*t.count})),e}));return(e,u)=>{const p=R,x=U,w=K,S=X,V=M;return n(),r(V,{gutter:20},{default:i((()=>[o(x,{span:10},{default:i((()=>[o(Ge,{"total-count":k(v),"show-computed-list":k(h),"show-list":k(m),region:k(s)},{default:i((()=>[o(p,{modelValue:k(s),"onUpdate:modelValue":u[0]||(u[0]=e=>A(s)?s.value=e:null),placeholder:"请输入地区"},{prepend:i((()=>[b("地区")])),_:1},8,["modelValue"])])),_:1},8,["total-count","show-computed-list","show-list","region"])])),_:1}),o(x,{span:4},{default:i((()=>[c("fieldset",null,[lt,o(S,{modelValue:k(d),"onUpdate:modelValue":u[1]||(u[1]=e=>A(d)?d.value=e:null)},{default:i((()=>[(n(),g(y,null,f(l,(e=>o(w,{label:e.value,size:"small",border:""},{default:i((()=>[b(_(e.label),1)])),_:2},1032,["label"]))),64))])),_:1},8,["modelValue"])]),o(p,{modelValue:k(t),"onUpdate:modelValue":u[2]||(u[2]=e=>A(t)?t.value=e:null),rows:20,type:"textarea",placeholder:k(a),style:{"font-size":"large"}},null,8,["modelValue","placeholder"])])),_:1}),o(x,{span:10},{default:i((()=>[o(at)])),_:1})])),_:1})}}}),rt="1.4.0",it={class:"version"},ot=ve(l({__name:"index",setup(e){const t=w(rt);return(e,a)=>(n(),g("div",it,_(k(t)),1))}}),[["__scopeId","data-v-4d911824"]]),st=ve(l({__name:"AsideRouter",setup(e){const t=de().getRoutes().filter((e=>!e.meta.menuHidden));return(e,a)=>{const l=s("router-link");return n(),g("div",null,[(n(!0),g(y,null,f(k(t),(e=>(n(),r(l,{to:e.path,key:e.path,class:"link"},{default:i((()=>[b(_(e.meta.title),1)])),_:2},1032,["to"])))),128))])}}}),[["__scopeId","data-v-7023f654"]]),ut={},dt={style:{float:"right",cursor:"pointer"},href:"https://gitee.com/hzsn-csh/sn-tools",target:"_blank"},pt=[c("img",{alt:"Gitee",src:"/sn-tools/img/logo-gitee-g.svg",title:"Gitee — 基于 Git 的代码托管和研发协作平台",style:{height:"36px","margin-top":"12px"}},null,-1)];const ct=ve(ut,[["render",function(e,t){return n(),g("a",dt,pt)}]]);const mt=ve({},[["render",function(e,t){const a=ct,l=Y,u=st,d=ot,p=B,c=s("router-view"),m=G,h=H;return n(),r(h,null,{default:i((()=>[o(l,null,{default:i((()=>[b("小工具"),o(a)])),_:1}),o(h,{class:"container"},{default:i((()=>[o(p,{width:"200px"},{default:i((()=>[o(u),o(d)])),_:1}),o(m,null,{default:i((()=>[o(c)])),_:1})])),_:1})])),_:1})}],["__scopeId","data-v-4658b423"]]);const ht=ve({},[["render",function(e,t){const a=s("router-link"),l=P,u=U,d=M;return n(),r(d,{gutter:20},{default:i((()=>[o(u,{span:6},{default:i((()=>[o(l,null,{header:i((()=>[b("体积计算")])),default:i((()=>[o(a,{to:"/volume"},{default:i((()=>[b("体积计算")])),_:1})])),_:1})])),_:1}),o(u,{span:6},{default:i((()=>[o(l,null,{header:i((()=>[b("品牌统计")])),default:i((()=>[o(a,{to:"/tongji"},{default:i((()=>[b("品牌统计")])),_:1})])),_:1})])),_:1}),o(u,{span:6},{default:i((()=>[o(l,null,{header:i((()=>[b("鼎能面单")])),default:i((()=>[o(a,{to:"/dingnengorder"},{default:i((()=>[b("鼎能面单")])),_:1})])),_:1})])),_:1})])),_:1})}]]);const gt=ve({},[["render",function(e,t){const a=W,l=s("router-link"),u=Q;return n(),r(u,{icon:"error",title:"404","sub-title":"not found"},{extra:i((()=>[o(l,{to:"/"},{default:i((()=>[o(a,{type:"primary"},{default:i((()=>[b("回首页")])),_:1})])),_:1})])),_:1})}]]),ft={sender:[{required:!0,message:"请输入发货人",trigger:"blur"}],sender_phone:[{required:!0,message:"请输入发货人电话",trigger:"blur"}],recipient_company:[{required:!0,message:"请输入收货单位",trigger:"blur"}],recipient:[{required:!0,message:"请输入收货人",trigger:"blur"}],recipient_phone:[{required:!0,message:"请输入收货人电话",trigger:"blur"}],address:[{required:!0,message:"请输入收货地址",trigger:"blur"}],send_time:[{required:!0,message:"请输入发运时间",trigger:"change"}],recipient_time:[{required:!0,message:"请输入收货时间",trigger:"change"}],total_volume:[{type:"number",required:!0,message:"请输入总体积，数字类型",trigger:"blur"}],total_weight:[{type:"number",required:!0,message:"请输入总重量，数字类型",trigger:"blur"}],delivery_user:[{required:!0,message:"请输入提货人",trigger:"blur"}],remark:[]},bt=[{key:"zhixiang",value:0,text:"纸箱"},{key:"muxiang",value:0,text:"木箱"},{key:"tiejian",value:0,text:"铁件"},{key:"qita",value:0,text:"其他"}],_t=e("dingnengOrder",{state:()=>({dn_order_id:"",sender:"",sender_phone:"",recipient_company:"",recipient:"",recipient_phone:"",address:"",goodsList:[],send_time:0,recipient_time:0,total_volume:0,total_weight:0,delivery_user:"",remark:""}),getters:{total_count:e=>{let t=0;return e.goodsList.forEach((e=>{t+=e.value})),t}},actions:{createDNOrderId:()=>"DN"+(new Date).getTime()+Math.floor(1e3*Math.random()),getGoodsList:()=>Object.assign([],bt).map((e=>(e.value=0,e))),getFromStorage:()=>({sender:localStorage.getItem("sender")||"",sender_phone:localStorage.getItem("sender_phone")||"",delivery_user:localStorage.getItem("delivery_user")||""}),saveToStorage(){localStorage.setItem("sender",this.sender),localStorage.setItem("sender_phone",this.sender_phone),localStorage.setItem("delivery_user",this.delivery_user)},init(){this.$reset(),this.goodsList=this.getGoodsList(),this.dn_order_id=this.createDNOrderId();let e=this.getFromStorage();this.sender=e.sender,this.sender_phone=e.sender_phone,this.delivery_user=e.delivery_user,this.send_time=+new Date,this.recipient_time=+new Date}}}),yt={style:{width:"600px",margin:"auto"}},vt=c("h3",{style:{"text-align":"center",color:"var(--el-text-color-primary)"}},"创建面单",-1),xt=l({__name:"create",setup(e){const t=w(),a=_t();a.init();const l=a.$state,s=de(),u=async()=>{t&&await t.value.validate((e=>{e&&(a.saveToStorage(),s.push({name:"dingnengOrderPrint"}))}))},d=()=>{t&&a.init()};return(e,a)=>{const s=R,p=Z,c=U,m=M,h=ee,_=te,v=W,x=ae;return n(),g("div",yt,[vt,o(x,{ref_key:"elFormRef",ref:t,model:k(l),rules:k(ft),"label-width":"100px"},{default:i((()=>[o(m,null,{default:i((()=>[o(c,{span:12},{default:i((()=>[o(p,{label:"发货人",prop:"sender"},{default:i((()=>[o(s,{modelValue:k(l).sender,"onUpdate:modelValue":a[0]||(a[0]=e=>k(l).sender=e),placeholder:"请输入发货人",clearable:"",style:{width:"100%"}},null,8,["modelValue"])])),_:1})])),_:1}),o(c,{span:12},{default:i((()=>[o(p,{label:"发货人电话",prop:"sender_phone"},{default:i((()=>[o(s,{modelValue:k(l).sender_phone,"onUpdate:modelValue":a[1]||(a[1]=e=>k(l).sender_phone=e),placeholder:"请输入发货人电话",clearable:"",style:{width:"100%"}},null,8,["modelValue"])])),_:1})])),_:1})])),_:1}),o(p,{label:"收货单位",prop:"recipient_company"},{default:i((()=>[o(s,{modelValue:k(l).recipient_company,"onUpdate:modelValue":a[2]||(a[2]=e=>k(l).recipient_company=e),placeholder:"请输入收货单位",clearable:"",style:{width:"100%"}},null,8,["modelValue"])])),_:1}),o(m,null,{default:i((()=>[o(c,{span:12},{default:i((()=>[o(p,{label:"收货人",prop:"recipient"},{default:i((()=>[o(s,{modelValue:k(l).recipient,"onUpdate:modelValue":a[3]||(a[3]=e=>k(l).recipient=e),placeholder:"请输入收货人",clearable:"",style:{width:"100%"}},null,8,["modelValue"])])),_:1})])),_:1}),o(c,{span:12},{default:i((()=>[o(p,{label:"收货人电话",prop:"recipient_phone"},{default:i((()=>[o(s,{modelValue:k(l).recipient_phone,"onUpdate:modelValue":a[4]||(a[4]=e=>k(l).recipient_phone=e),placeholder:"请输入收货人电话",clearable:"",style:{width:"100%"}},null,8,["modelValue"])])),_:1})])),_:1})])),_:1}),o(p,{label:"收货地址",prop:"address"},{default:i((()=>[o(s,{modelValue:k(l).address,"onUpdate:modelValue":a[5]||(a[5]=e=>k(l).address=e),placeholder:"请输入收货地址",clearable:"",style:{width:"100%"}},null,8,["modelValue"])])),_:1}),o(m,null,{default:i((()=>[(n(!0),g(y,null,f(k(l).goodsList,((e,t)=>(n(),r(c,{span:12,key:e.key},{default:i((()=>[o(p,{label:e.text},{default:i((()=>[o(h,{modelValue:e.value,"onUpdate:modelValue":t=>e.value=t,placeholder:"请输入"+e.text,step:1,max:1e3},null,8,["modelValue","onUpdate:modelValue","placeholder"])])),_:2},1032,["label"])])),_:2},1024)))),128))])),_:1}),o(m,null,{default:i((()=>[o(c,{span:12},{default:i((()=>[o(p,{label:"发运时间",prop:"send_time"},{default:i((()=>[o(_,{type:"datetime",modelValue:k(l).send_time,"onUpdate:modelValue":a[6]||(a[6]=e=>k(l).send_time=e),placeholder:"请输入发运时间",clearable:"","value-format":"x"},null,8,["modelValue"])])),_:1})])),_:1}),o(c,{span:12},{default:i((()=>[o(p,{label:"收货时间",prop:"recipient_time"},{default:i((()=>[o(_,{type:"datetime",modelValue:k(l).recipient_time,"onUpdate:modelValue":a[7]||(a[7]=e=>k(l).recipient_time=e),placeholder:"请输入收货时间",clearable:"","value-format":"x"},null,8,["modelValue"])])),_:1})])),_:1})])),_:1}),o(m,null,{default:i((()=>[o(c,{span:12},{default:i((()=>[o(p,{label:"总体积",prop:"total_volume"},{default:i((()=>[o(s,{modelValue:k(l).total_volume,"onUpdate:modelValue":a[8]||(a[8]=e=>k(l).total_volume=e),modelModifiers:{number:!0},placeholder:"请输入总体积",clearable:"",style:{width:"100%"}},{append:i((()=>[b("m³")])),_:1},8,["modelValue"])])),_:1})])),_:1}),o(c,{span:12},{default:i((()=>[o(p,{label:"总重量",prop:"total_weight"},{default:i((()=>[o(s,{modelValue:k(l).total_weight,"onUpdate:modelValue":a[9]||(a[9]=e=>k(l).total_weight=e),modelModifiers:{number:!0},placeholder:"请输入总重量",clearable:""},{append:i((()=>[b("KG")])),_:1},8,["modelValue"])])),_:1})])),_:1})])),_:1}),o(p,{label:"提货人",prop:"delivery_user"},{default:i((()=>[o(s,{modelValue:k(l).delivery_user,"onUpdate:modelValue":a[10]||(a[10]=e=>k(l).delivery_user=e),placeholder:"请输入提货人",clearable:"",style:{width:"100%"}},null,8,["modelValue"])])),_:1}),o(p,{label:"备注",prop:"remark"},{default:i((()=>[o(s,{modelValue:k(l).remark,"onUpdate:modelValue":a[11]||(a[11]=e=>k(l).remark=e),type:"textarea",placeholder:"请输入备注",autosize:{minRows:4,maxRows:4},style:{width:"100%"}},null,8,["modelValue"])])),_:1}),o(p,{size:"large"},{default:i((()=>[o(v,{type:"primary",onClick:u},{default:i((()=>[b("打印")])),_:1}),o(v,{onClick:d},{default:i((()=>[b("重置")])),_:1})])),_:1})])),_:1},8,["model","rules"])])}}}),wt=e("dingnengSettings",(()=>{const e="printFontSize",t=()=>{const t=localStorage.getItem(e);return console.log("getFromStorage",t),null==t||null==t?1:parseFloat(t)},a=t(),l=w(a);return{fontSize:l,getFromStorage:t,saveToStorage:()=>{localStorage.setItem(e,""+l.value)}}})),St=l({__name:"barcode",props:{code:{type:String,required:!0}},setup(e){const{code:t}=e,a=w(null);p((()=>{a.value&&l(a.value,t)}));const l=(e,t)=>{pe(e,t,{displayValue:!1,height:60})};return(e,t)=>(n(),g("svg",{ref_key:"barcodeRef",ref:a},null,512))}}),kt=e=>(v("data-v-a92fa01f"),e=e(),x(),e),Vt=kt((()=>c("div",{class:"order-header"},[c("img",{height:"40",width:"40",src:"/sn-tools/img/dingneng.png"}),c("span",null,"杭州鼎能供应链发运单")],-1))),jt={style:{margin:"10px 0 0 0"}},Dt={style:{"text-align":"center"}},At={colspan:"3"},Ct={colspan:"2"},It={colspan:"5"},Tt={colspan:"3"},Lt={colspan:"2"},Et={colspan:"5"},Jt=kt((()=>c("tr",null,[c("td",{colspan:"5",style:{"text-align":"center",padding:"10px 0px","font-size":"1.12em"}}," 货物详情 ")],-1))),Nt=kt((()=>c("td",{style:{"text-align":"center"}},"合计",-1))),Pt={style:{"text-align":"center"}},Ot={colspan:"3"},Rt={colspan:"2"},Mt={colspan:"5"},Ut={colspan:"3"},zt=kt((()=>c("td",{colspan:"2"},"签收人：",-1))),Ft={colspan:"5"},$t={style:{border:"none"}},qt={colspan:"5"},Kt={class:"other-wapper"},Xt={class:"print-btn-wapper"},Yt={class:"print-btn-wapper"},Bt={class:"print-btn-wapper"},Gt=ve(l({__name:"print",setup(e){const a=de(),l=_t(),r=wt(),s=l.$state,d=w(!1),{fontSize:p}=t(r),m=e=>{r.saveToStorage()},h=u((()=>{let e=new Date(s.send_time);return e.getFullYear()+"年"+(e.getMonth()+1)+"月"+e.getDate()+"日"})),v=u((()=>{let e=new Date(s.recipient_time);return e.getFullYear()+"年"+(e.getMonth()+1)+"月"+e.getDate()+"日"})),x=()=>{d.value=!0,a.back()},S=()=>{window.print()};return(e,t)=>{const a=ee,r=W;return n(),g(y,null,[c("div",{class:"order-wapper print",style:D({fontSize:k(p)+"em"})},[Vt,c("p",jt,"运单号："+_(k(s).dn_order_id),1),c("div",Dt,[o(St,{code:k(s).dn_order_id},null,8,["code"])]),c("table",null,[c("tbody",null,[c("tr",null,[c("td",At,"发货人："+_(k(s).sender),1),c("td",Ct,"电话："+_(k(s).sender_phone),1)]),c("tr",null,[c("td",It,"收货单位："+_(k(s).recipient_company),1)]),c("tr",null,[c("td",Tt,"收货人："+_(k(s).recipient),1),c("td",Lt,"电话："+_(k(s).recipient_phone),1)]),c("tr",null,[c("td",Et,"收货地址："+_(k(s).address),1)]),Jt,c("tr",null,[(n(!0),g(y,null,f(k(s).goodsList,(e=>(n(),g("td",{class:"border-right",key:e.key},_(e.text),1)))),128)),Nt]),c("tr",null,[(n(!0),g(y,null,f(k(s).goodsList,(e=>(n(),g("td",{class:"border-right",key:e.key},_(e.value),1)))),128)),c("td",Pt,_(k(l).total_count),1)]),c("tr",null,[c("td",Ot,"体积："+_(k(s).total_volume)+" m³",1),c("td",Rt,"重量："+_(k(s).total_weight)+" KG",1)]),c("tr",null,[c("td",Mt,"发运时间："+_(k(h)),1)]),c("tr",null,[c("td",Ut,"提货人："+_(k(s).delivery_user),1),zt]),c("tr",null,[c("td",Ft,"日期："+_(k(v)),1)]),c("tr",$t,[c("td",qt,"备注："+_(k(s).remark),1)])])])],4),c("div",Kt,[c("div",Xt,[o(a,{modelValue:k(p),"onUpdate:modelValue":t[0]||(t[0]=e=>A(p)?p.value=e:null),precision:2,step:.1,min:1,max:2,onChange:m,style:{width:"200px","margin-left":"74px"}},null,8,["modelValue","step"])]),c("div",Yt,[o(r,{type:"primary",class:"print-btn",onClick:S},{default:i((()=>[b("打印")])),_:1})]),c("div",Bt,[o(r,{onClick:x,loading:k(d)},{default:i((()=>[b("返回")])),_:1},8,["loading"])])])],64)}}}),[["__scopeId","data-v-a92fa01f"]]);function Ht(e,t){return e=Math.ceil(e),t=Math.floor(t),Math.floor(Math.random()*(t-e))+e}function Qt(e){return e<10&&"0"+e||e}function Wt(e){return e.label+e.id}function Zt(e){let t=localStorage.getItem(Wt(e));return t&&JSON.parse(t)||[]}const ea=/^(0|86|17951)?(13[0-9]|14[01456789]|15[012356789]|16[2567]|17[235678]|18[0-9]|19[012356789])[0-9]{8}$/;const ta=(e,t)=>{let a={};for(const l in e)if(Object.prototype.hasOwnProperty.call(e,l)){const t=e[l];a[l]=be.json_to_sheet(t)}!function(e,t){let a=URL.createObjectURL(e);var l,n=document.createElement("a");n.href=a,n.download=t||"",window.MouseEvent?l=new MouseEvent("click"):(l=document.createEvent("MouseEvents")).initMouseEvent("click",!0,!1,window,0,0,0,0,0,!1,!1,!1,!1,0,null),n.dispatchEvent(l),n.remove()}(function(e){var t={SheetNames:Object.keys(e),Sheets:{}};for(const l in e)if(Object.prototype.hasOwnProperty.call(e,l)){const a=e[l];t.Sheets[l]=a}var a=ye(t,{bookType:"xlsx",bookSST:!1,type:"binary"});return new Blob([function(e){for(var t=new ArrayBuffer(e.length),a=new Uint8Array(t),l=0;l!=e.length;++l)a[l]=255&e.charCodeAt(l);return t}(a)],{type:"application/octet-stream"})}(a),function(e,t){let a=t.lastIndexOf("."),l=1==e.length&&e[0]+"-"||"";return t.substring(0,a)+"-"+l+ +new Date+t.substring(a)}(Object.keys(a),t))};const aa=(e,t,a,l,n="\t")=>{let r=e.Sheets[e.SheetNames[t]],i=be.sheet_to_txt(r).split("\n");null==l&&(l=a.find((e=>i[0].includes(e.zhKey)||i[0].includes(e.key)))?1:0);let o=[],s=0;for(let u=l;u<i.length;u++){const e=i[u].trim();if(!e){s++;continue}let t=e.split(n),l={};for(const n of a)l[n.key]=t[n.index].trim(),l[n.key].length||s++;o.push(l)}return{list:o,emptyCount:s}},la="application/vnd.openxmlformats-officedocument.spreadsheetml.sheet",na=c("div",{class:"el-upload__text"},[b(" Drop file here or "),c("em",null,"click to upload")],-1),ra=l({__name:"upload",emits:["change"],setup(e,{emit:t}){const a=w(),{valiteFile:l,handleExceed:s,acceptType:u}=(e=>({valiteFile:(e,t)=>{let a=e.raw;if(a){if(a.type==la)return!0;F({type:"warning",message:"附件格式错误，请删除后重新上传！"})}else F({type:"warning",message:"请上传附件！"});return!1},handleExceed:t=>{e.value.clearFiles();const a=t[0];a.uid=Date.now(),e.value.handleStart(a)},acceptType:la}))(a),d=(e,a)=>{l(e,a)&&e.raw&&t("change",e.raw)};return(e,t)=>{const l=$;return n(),r(k(q),{drag:"",ref_key:"uploadRef",ref:a,action:"","on-change":d,"on-exceed":k(s),limit:1,accept:k(u),"auto-upload":!1},{default:i((()=>[o(l,{class:"el-icon--upload"},{default:i((()=>[o(k(fe))])),_:1}),na])),_:1},8,["on-exceed","accept"])}}}),ia=[{id:57,text:"陆放",label:"kluger"},{id:38,text:"荣放",label:"rav4"}],oa={index:-1,label:"全部"},sa="city",ua="username",da="phone",pa="series_id",ca="dealer_id",ma="company",ha="order_at";var ga=(e=>(e[e.DATA=0]="DATA",e[e.SERIES=1]="SERIES",e))(ga||{});const fa={data:{id:0,text:"数据"},seriesData:{id:1,text:"车系资料"}},ba=[{key:"city",zhKey:"城市",index:1},{key:"username",zhKey:"姓名",index:5},{key:"phone",zhKey:"电话",index:6}],_a=[{key:"dealerId",zhKey:"经销商编码",index:0},{key:"name",zhKey:"经销商名称",index:1},{key:"city",zhKey:"城市",index:2}],ya={hour:[9,10,11,12,13,14,15,16,17,18,19,20,21,22],weight:[9,6,3,2,1,3,4,3,3,8,8,4,2,1]},va=ya.weight.reduce(((e,t)=>e+t)),xa=e("ftmsStore",(()=>{let e=new Date;const t=w([new Date(e.getFullYear(),e.getMonth(),e.getDate()-1,18),new Date(e.getFullYear(),e.getMonth(),e.getDate(),17,30,0)]),a=j(fa),l=j({[ia[0].label]:Zt(ia[0]),[ia[1].label]:Zt(ia[1])});return{dateTime:t,uploadTypeRadioKeyList:a,seriesList:l,saveSeries:function(e,t){localStorage.setItem(Wt(t),JSON.stringify(e)),l[t.label]=e},hasSeriesData:function(e){return l[e.label].length>0}}})),wa={class:"title"},Sa=ve(l({__name:"RadioTitle",props:{text:{type:String,default:"项"}},setup:e=>(t,a)=>(n(),g("span",wa,_(e.text),1))}),[["__scopeId","data-v-9b2e10e3"]]),ka={style:{"margin-bottom":"20px"}},Va=ve(l({__name:"UploadTypeRadio",props:["modelValue"],emits:["update:modelValue"],setup(e,{emit:t}){const a=e,{uploadTypeRadioKeyList:l}=xa(),s=u({get:()=>a.modelValue,set:e=>t("update:modelValue",e)});return(e,t)=>{const a=le,u=X;return n(),g("div",ka,[o(Sa,{text:"数据类型"}),o(u,{modelValue:k(s),"onUpdate:modelValue":t[0]||(t[0]=e=>A(s)?s.value=e:null)},{default:i((()=>[(n(!0),g(y,null,f(k(l),(e=>(n(),r(a,{label:e.id,border:""},{default:i((()=>[b(_(e.text),1)])),_:2},1032,["label"])))),256))])),_:1},8,["modelValue"])])}}}),[["__scopeId","data-v-d5ddec6c"]]),ja=l({__name:"SnForm",setup(e){const{dateTime:a}=t(xa());return(e,t)=>{const l=te,s=Z,u=ae;return n(),r(u,{inline:!0,class:"demo-form-inline"},{default:i((()=>[o(s,{label:"时间范围"},{default:i((()=>[o(l,{modelValue:k(a),"onUpdate:modelValue":t[0]||(t[0]=e=>A(a)?a.value=e:null),type:"datetimerange","range-separator":"至","start-placeholder":"Start date","end-placeholder":"End date"},null,8,["modelValue"])])),_:1})])),_:1})}}});function Da(){const{dateTime:e}=xa();let t=function(e,t){let a=Ht(0,t);for(let l=0;l<e.length;l++)if(a-=e[l],a<=0)return l;return 0}(ya.weight,va),a=ya.hour[t],l=new Date(Ht(e[0].getTime(),e[1].getTime()));for(;l.getHours()!=a;)l=new Date(Ht(e[0].getTime(),e[1].getTime()));let n=l.getFullYear(),r=l.getMonth()+1,i=l.getDate(),o=Qt(l.getMinutes()),s=Qt(l.getSeconds());return n+"-"+Qt(r)+"-"+Qt(i)+" "+Qt(a)+":"+o+":"+s}function Aa(e,t){let a=ia.filter((t=>e.includes(t.text)));if(a.length>0)return a[0];if(a=ia.filter((e=>t.includes(e.text))),a.length>0)return a[0];throw new Error("没有从文件名或sheet name 中找到车系名称")}const Ca=(e,a)=>{const{seriesList:l}=t(xa());let n=l.value[a.label],r=e.map(((e,t)=>{let l={...e,seriesId:a.id};var n;return n=l.phone,ea.test(n.toString())||console.warn(`${t+1}:${l.phone}有误`),l})),i=new Set;r.forEach((e=>i.add(e.city)));let o={};return i.forEach((e=>{if(o[e]=n.filter((t=>t.city==e)),0==o[e].length)throw new Error(`没有该字段的车系数据：${e}`)})),function(e,t){e.forEach((e=>{let a=Ht(0,t[e.city].length),l=t[e.city][a];e.dealerId=l.dealerId,e.dealerName=l.name}))}(r,o),function(e){e.forEach((e=>{e.orderAt=Da()}))}(r),r.map((e=>{let t={};return t[sa]=e.city,t[ua]=e.username,t[da]=e.phone,t[ca]=e.dealerId,t[ma]=e.dealerName,t[pa]=e.seriesId,t[ha]=e.orderAt,t}))},Ia=()=>{const e=xa(),{uploadTypeRadioKeyList:a}=t(e),l=w(a.value.data.id),n=w(),r=j({visible:!1,sheetNames:[],sheetIndex:oa.index,fileName:""});C((()=>r.fileName),(()=>r.sheetIndex=oa.index));function i(e){if(e==ga.DATA)return ba;if(e==ga.SERIES)return _a;throw new Error(`没有此类型key:${e}`)}function o(e,t){t&&F.warning(`sheet:${e} 已忽略${t}行空数据`)}return{workBook:n,sheetDialogConfig:r,openSheetDialog:(e,t)=>{r.sheetNames=t,r.visible=!0,r.fileName=e},uploadType:l,handleSheetSelect:t=>{if(!n.value)return;let a={};if(t==oa.index){let e=n.value.SheetNames,t=i(l.value);for(let l=0;l<e.length;l++){let r=aa(n.value,l,t);a[e[l]]=r.list,o(e[l],r.emptyCount)}}else{let e=aa(n.value,t,i(l.value));a[n.value.SheetNames[t]]=e.list,o(n.value.SheetNames[t],e.emptyCount)}try{(t=>{const{sheetObject:a,fileName:l,uploadType:n}=t;if(n.value==ga.DATA){let t={};for(const n in a)if(Object.prototype.hasOwnProperty.call(a,n)){const r=a[n];let i=Aa(n,l);if(!e.hasSeriesData(i))throw new Error(`没有该车系的数据：${i.text} 请先上传${i.text}的数据`);t[n]=Ca(r,i)}ta(t,l)}else{if(n.value!=ga.SERIES)throw new Error("类型错误");for(const t in a)if(Object.prototype.hasOwnProperty.call(a,t)){const n=a[t];let r=Aa(t,l);e.saveSeries(n,r),F.success(`已添加${t}${n.length}条数据`)}}})({sheetObject:a,fileName:r.fileName,uploadType:l})}catch(s){console.error(s),F.error(s.message)}finally{n.value=void 0}}}},Ta=ve(l({__name:"TipAlert",setup(e){const{seriesList:a}=t(xa()),l=w(!1),i=u((()=>{let e=0==a.value[ia[0].label].length;return{title:`${ia[0].text} 数据不存在`,show:e}})),o=u((()=>{let e=0==a.value[ia[1].label].length;return{title:`${ia[1].text} 数据不存在`,show:e}}));return(e,t)=>(n(),g(y,null,[k(i).show?(n(),r(k(ne),{key:0,title:k(i).title,type:"error",closable:k(l)},null,8,["title","closable"])):I("",!0),k(o).show?(n(),r(k(ne),{key:1,title:k(o).title,type:"error",closable:k(l)},null,8,["title","closable"])):I("",!0)],64))}}),[["__scopeId","data-v-c13bbe3e"]]),La=l({__name:"TipDescription",setup(e){const{seriesList:a}=t(xa()),l=u((()=>({label:ia[0].text,desc:`${a.value[ia[0].label].length}条`}))),s=u((()=>({label:ia[1].text,desc:`${a.value[ia[1].label].length}条`})));return(e,t)=>{const a=re,u=ie;return n(),r(u,{border:"",title:"车系资料"},{default:i((()=>[o(a,{"label-align":"right",align:"center",label:k(l).label},{default:i((()=>[b(_(k(l).desc),1)])),_:1},8,["label"]),o(a,{"label-align":"right",align:"center",label:k(s).label},{default:i((()=>[b(_(k(s).desc),1)])),_:1},8,["label"])])),_:1})}}}),Ea={class:"dialog-footer"},Ja=l({__name:"SheetDialog",props:{sheetIndex:{type:Number,default:oa.index},visible:{type:Boolean,default:!1},fileName:{type:String},sheetNames:{type:Array,default:[]}},emits:["update:sheetIndex","update:visible","select"],setup(e,{emit:t}){const a=e,l=u({get:()=>[oa,...a.sheetNames.map(((e,t)=>({index:t,label:e})))],set(e){console.log(e)}}),s=u({get:()=>a.sheetIndex,set(e){t("update:sheetIndex",e)}}),d=u({get:()=>a.visible,set(e){t("update:visible",e)}}),p=e=>{t("update:sheetIndex",e)},m=()=>{d.value=!1,t("select",a.sheetIndex)};return(t,a)=>{const u=K,h=X,v=W,x=oe;return n(),r(x,{modelValue:k(d),"onUpdate:modelValue":a[2]||(a[2]=e=>A(d)?d.value=e:null),title:"选择Sheet"},{footer:i((()=>[c("span",Ea,[o(v,{onClick:a[1]||(a[1]=e=>d.value=!1)},{default:i((()=>[b("取消")])),_:1}),o(v,{type:"primary",onClick:m},{default:i((()=>[b(" 确定 ")])),_:1})])])),default:i((()=>[c("p",null,_(e.fileName),1),o(Sa,{text:"Sheet"}),o(h,{modelValue:k(s),"onUpdate:modelValue":a[0]||(a[0]=e=>A(s)?s.value=e:null),onChange:p},{default:i((()=>[(n(!0),g(y,null,f(k(l),(e=>(n(),r(u,{label:e.index,border:""},{default:i((()=>[b(_(e.label),1)])),_:2},1032,["label"])))),256))])),_:1},8,["modelValue"])])),_:1},8,["modelValue"])}}}),Na=c("h2",{style:{"text-align":"center"}},"2023年1月份留资数据格式化",-1),Pa=[{path:"/",name:"index",component:mt,meta:{menuHidden:!0},children:[{path:"/",name:"dashboard",component:ht,meta:{title:"首页"}},{path:"/volume",name:"volume",component:nt,meta:{title:"体积计算"}},{path:"/tongji",name:"tongji",component:$e,meta:{title:"品牌统计"}},{path:"/ftms",name:"ftms",component:l({__name:"index",setup(e){const{uploadType:t,sheetDialogConfig:a,openSheetDialog:l,workBook:r,handleSheetSelect:s}=Ia(),u=e=>{var t;(t=e,new Promise(((e,a)=>{let l=new FileReader;l.onload=t=>{var l;try{e(_e(null==(l=t.target)?void 0:l.result))}catch(n){a(n)}},l.readAsArrayBuffer(t)}))).then((t=>{let a=t;r.value=a,l(e.name,r.value.SheetNames)})).catch((e=>{r.value=void 0,F.error(e.message),console.error(e)}))};return(e,l)=>{const r=U,d=M;return n(),g(y,null,[Na,o(Ta),o(d,{gutter:20},{default:i((()=>[o(r,{span:12},{default:i((()=>[o(ja),o(La)])),_:1}),o(r,{span:12},{default:i((()=>[o(Va,{modelValue:k(t),"onUpdate:modelValue":l[0]||(l[0]=e=>A(t)?t.value=e:null)},null,8,["modelValue"]),o(ra,{onChange:u})])),_:1})])),_:1}),o(Ja,{sheetIndex:k(a).sheetIndex,"onUpdate:sheetIndex":l[1]||(l[1]=e=>k(a).sheetIndex=e),visible:k(a).visible,"onUpdate:visible":l[2]||(l[2]=e=>k(a).visible=e),"sheet-names":k(a).sheetNames,onSelect:k(s),"file-name":k(a).fileName},null,8,["sheetIndex","visible","sheet-names","onSelect","file-name"])],64)}}}),meta:{title:"留资数据格式化"}},{path:"dingnengorder",name:"dingnengOrder",component:xt,meta:{title:"鼎能面单"}},{path:"/:pathMatch(.*)*",name:"NotFound",component:gt,meta:{menuHidden:!0}}]},{path:"/dingnengorder/print",name:"dingnengOrderPrint",component:Gt,meta:{menuHidden:!0}}],Oa=ce({history:me(),routes:Pa}),Ra=a();T(xe).use(Oa).use(Ra).mount("#app");
