import{z as e,E as t,a,b as l,c as n,d as r,e as o,f as i,g as s,h as u,i as d,j as p,k as c,l as m,m as h,n as g,o as f,p as _,q as b,r as y,s as v,t as x,u as w,v as V,w as k,x as S,y as j,A as C,B as I,C as D,D as A,F as L,G as T}from"../js1/_element-plus-b9fc4771.js";import{j as J,o as E,K as U,L as N,U as O,ag as P,f as R,i as M,e as z,a as F,M as $,V as q,c as K,a6 as X,R as Y,S as B,T as G,ao as H,ap as Q,r as W,p as Z,u as ee,H as te,h as ae,Z as le,E as ne,Q as re,w as oe,aq as ie}from"../js1/_@vue-19059a4a.js";import{L as se,M as ue,N as de,O as pe,P as ce,Q as me,R as he}from"../js1/__vendor-deeb0df3.js";import{A as ge,q as fe,B as _e}from"../js1/_@element-plus-944ddd61.js";import{d as be,s as ye,c as ve}from"../js1/_pinia-9db7cbde.js";import{u as xe,r as we,w as Ve}from"../js1/_xlsx-05fabba3.js";!function(){const e=document.createElement("link").relList;if(!(e&&e.supports&&e.supports("modulepreload"))){for(const e of document.querySelectorAll('link[rel="modulepreload"]'))t(e);new MutationObserver((e=>{for(const a of e)if("childList"===a.type)for(const e of a.addedNodes)"LINK"===e.tagName&&"modulepreload"===e.rel&&t(e)})).observe(document,{childList:!0,subtree:!0})}function t(e){if(e.ep)return;e.ep=!0;const t=function(e){const t={};return e.integrity&&(t.integrity=e.integrity),e.referrerPolicy&&(t.referrerPolicy=e.referrerPolicy),"use-credentials"===e.crossOrigin?t.credentials="include":"anonymous"===e.crossOrigin?t.credentials="omit":t.credentials="same-origin",t}(e);fetch(e.href,t)}}();const ke=(e,t)=>{const a=e.__vccOpts||e;for(const[l,n]of t)a[l]=n;return a};const Se=ke(J({name:"App",setup:()=>({zIndex:3e3,locale:e})}),[["render",function(e,a,l,n,r,o){const i=P("router-view"),s=t;return E(),U(s,{locale:e.locale,"z-index":e.zIndex},{default:N((()=>[O(i)])),_:1},8,["locale","z-index"])}]]);const je=(e,t)=>{function a(){let a={};return e.value&&e.value.length>0&&(e.value.sort(((e,t)=>e.pinpai_leibie.localeCompare(t.pinpai_leibie))),e.value.forEach((e=>{var t;a[e.pinpai_leibie]?function(e,t){e.total+=1,e.jine+=t.jine,e.chengJiaoTotal+=t.isChengJiao?1:0,e.chengJiaoJine+=t.isChengJiao&&t.jine||0}(a[e.pinpai_leibie],e):a[e.pinpai_leibie]={pinpai_leibie:(t=e).pinpai_leibie,total:1,jine:t.jine,totalRate:0,jineRate:0,chengJiaoTotal:t.isChengJiao?1:0,chengJiaoJine:t.isChengJiao&&t.jine||0}})),function(e,t,a){Object.keys(e).forEach((l=>{e[l].totalRate=e[l].total/t,e[l].jineRate=e[l].jine/a}))}(a,e.value.length,t.value)),a}return R((()=>a()))},Ce=J({name:"PinPaiAnalyse",setup(){const e=M("dataList"),t=M("totalAmount"),a=je(e,t),l=R((()=>Object.values(a.value)));return z((()=>{new se("#pinpaiTable")})),{tableData:l}}}),Ie=F("span",null,"品牌构成分析",-1);const De=ke(Ce,[["render",function(e,t,r,o,i,s){const u=a,d=l,p=n;return E(),U(p,{class:"box-card",id:"pinpaiCard"},{header:N((()=>[Ie])),default:N((()=>[O(d,{data:e.tableData,id:"pinpaiTable","data-clipboard-target":"#pinpaiCard",style:{width:"100%"},size:"small","show-summary":""},{default:N((()=>[O(u,{type:"index",label:"序号"}),O(u,{prop:"pinpai_leibie",label:"类型"}),O(u,{prop:"total",label:"数量（份）"}),O(u,{prop:"jine",label:"金额"}),O(u,{prop:"totalRate",label:"数量占比"}),O(u,{prop:"jineRate",label:"金额占比"}),O(u,{prop:"chengJiaoTotal",label:"成交数量"}),O(u,{prop:"chengJiaoJine",label:"成交金额"})])),_:1},8,["data"])])),_:1})}]]),Ae=J({name:"DingSunYuanAnalyse",setup(){const e=M("dataList"),t=R((()=>{let t={};return e.value&&e.value.length>0?(e.value.sort(((e,t)=>e.xiaoshouyuan.localeCompare(t.xiaoshouyuan))),e.value.forEach((e=>{t[e.xiaoshouyuan]?(t[e.xiaoshouyuan].total+=1,t[e.xiaoshouyuan].chengJiaoTotal+=e.isChengJiao?1:0):t[e.xiaoshouyuan]={xiaoshouyuan:e.xiaoshouyuan,total:1,chengJiaoTotal:e.isChengJiao?1:0}})),Object.values(t)):[]}));return z((()=>{new se("#xsytable")})),{tableData:t}}}),Le=F("span",null,"销售员分析",-1);const Te=ke(Ae,[["render",function(e,t,r,o,i,s){const u=a,d=l,p=n;return E(),U(p,{class:"box-card",id:"xsycard"},{header:N((()=>[Le])),default:N((()=>[O(d,{data:e.tableData,id:"xsytable","data-clipboard-target":"#xsycard",style:{width:"100%"},size:"small","show-summary":""},{default:N((()=>[O(u,{type:"index",label:"序号"}),O(u,{prop:"xiaoshouyuan",label:"销售员"}),O(u,{prop:"total",label:"总量"}),O(u,{prop:"chengJiaoTotal",label:"成交数量"})])),_:1},8,["data"])])),_:1})}]]);const Je=(e,t)=>{let a=()=>{let a={};return e.value&&e.value.length>0&&(e.value.sort(((e,t)=>e.dingsunyuan.localeCompare(t.dingsunyuan))),e.value.forEach((e=>{var t;a[e.dingsunyuan]?function(e,t){e.total+=1,e.jine+=t.jine,e.chengJiaoTotal+=t.isChengJiao?1:0,e.chengJiaoJine+=t.isChengJiao&&t.jine||0}(a[e.dingsunyuan],e):a[e.dingsunyuan]={total:1,jine:(t=e).jine,totalRate:0,jineRate:0,chengJiaoTotal:t.isChengJiao?1:0,chengJiaoJine:t.isChengJiao&&t.jine||0,dingsunyuan:t.dingsunyuan}})),function(e,t,a){Object.keys(e).forEach((l=>{e[l].totalRate=e[l].total/t,e[l].jineRate=e[l].jine/a}))}(a,e.value.length,t.value)),a};return R((()=>a()))},Ee=J({name:"DingSunYuanAnalyse",setup(){const e=M("dataList"),t=M("totalAmount"),a=Je(e,t),l=R((()=>Object.values(a.value)));return z((()=>{new se("#dsytable")})),{tableData:l}}}),Ue=F("span",null,"定损员分析",-1);const Ne=ke(Ee,[["render",function(e,t,r,o,i,s){const u=a,d=l,p=n;return E(),U(p,{class:"box-card",id:"dsycard"},{header:N((()=>[Ue])),default:N((()=>[O(d,{data:e.tableData,id:"dsytable","data-clipboard-target":"#dsycard",style:{width:"100%"},size:"small","show-summary":""},{default:N((()=>[O(u,{type:"index",label:"序号"}),O(u,{prop:"dingsunyuan",label:"类型"}),O(u,{prop:"total",label:"数量（份）"}),O(u,{prop:"jine",label:"金额"}),O(u,{prop:"totalRate",label:"数量占比"}),O(u,{prop:"jineRate",label:"金额占比"}),O(u,{prop:"chengJiaoTotal",label:"成交数量"}),O(u,{prop:"chengJiaoJine",label:"成交金额"})])),_:1},8,["data"])])),_:1})}]]),Oe=(e,t,a)=>R((()=>function(){let l=["询价单数","询价金额","供应单数","供应金额","未供应单数","未供应金额"],n=[];if(e.value&&e.value.length>0){n.push({key:l[0],num:e.value.length,rate:1}),n.push({key:l[1],num:t.value,rate:1}),n.push({key:l[2],num:a.value.list.length,rate:a.value.list.length/e.value.length}),n.push({key:l[3],num:a.value.totalAmount,rate:a.value.totalAmount/t.value});let r=e.value.length-a.value.list.length;n.push({key:l[4],num:r,rate:r/e.value.length});let o=t.value-a.value.totalAmount;n.push({key:l[5],num:o,rate:o/t.value})}return n}())),Pe=J({name:"TotalAnalyse",setup(){const e=M("dataList"),t=M("totalAmount"),a=M("chengJiaoData"),l=Oe(e,t,a);return z((()=>{new se("#totalTable")})),{totalAnalyse:l}}}),Re=F("span",null,"报价总量分析",-1);const Me=ke(Pe,[["render",function(e,t,r,o,i,s){const u=a,d=l,p=n;return E(),U(p,{class:"box-card",id:"totalCard"},{header:N((()=>[Re])),default:N((()=>[O(d,{data:e.totalAnalyse,id:"totalTable","data-clipboard-target":"#totalCard",style:{width:"100%"},size:"small"},{default:N((()=>[O(u,{type:"index",label:"序号"}),O(u,{prop:"key",label:"类型"}),O(u,{prop:"num",label:"数量"}),O(u,{prop:"rate",label:"占比"})])),_:1},8,["data"])])),_:1})}]]),ze=J({name:"NoPinPaiList",setup(){const e=M("noPinPaiList"),t=R((()=>e.value.length>0));return{noPinPaiList:e,showable:t}}}),Fe=(e=>(H("data-v-6cec74d4"),e=e(),Q(),e))((()=>F("span",null,"无品牌类型",-1)));const $e=ke(ze,[["render",function(e,t,a,l,o,i){const s=r,u=n;return $((E(),U(u,{class:"box-card"},{header:N((()=>[Fe])),default:N((()=>[(E(!0),K(G,null,X(e.noPinPaiList,((e,t)=>(E(),U(s,{key:t},{default:N((()=>[Y(B(e.pinpai),1)])),_:2},1024)))),128))])),_:1},512)),[[q,e.showable]])}],["__scopeId","data-v-6cec74d4"]]),qe=[{name:"奥德赛",leibie:"日本",parent:"本田"},{name:"宝马",leibie:"德国",parent:""},{name:"北京现代",leibie:"其他",parent:""},{name:"奔驰",leibie:"德国",parent:""},{name:"奥迪",leibie:"德国",parent:""},{name:"比亚迪",leibie:"中国",parent:""},{name:"别克",leibie:"美国",parent:""},{name:"宾利",leibie:"英国",parent:""},{name:"长安",leibie:"中国",parent:""},{name:"大众",leibie:"德国",parent:""},{name:"谛艾仕",leibie:"法国",parent:""},{name:"帝豪",leibie:"中国",parent:""},{name:"东风日产",leibie:"其他",parent:""},{name:"东风天龙",leibie:"中国",parent:"吉利"},{name:"东风雪铁龙",leibie:"其他",parent:""},{name:"东风悦达起亚",leibie:"其他",parent:""},{name:"风神",leibie:"中国",parent:""},{name:"丰田",leibie:"日本",parent:""},{name:"广丰",leibie:"日本",parent:"丰田"},{name:"福特",leibie:"美国",parent:""},{name:"福田",leibie:"中国",parent:""},{name:"广汽本田",leibie:"其他",parent:""},{name:"哈弗",leibie:"中国",parent:""},{name:"江淮",leibie:"中国",parent:""},{name:"捷豹",leibie:"英国",parent:""},{name:"晶马",leibie:"中国",parent:""},{name:"凯迪拉克",leibie:"美国",parent:"江铃"},{name:"路虎",leibie:"英国",parent:""},{name:"玛莎拉蒂",leibie:"意大利",parent:""},{name:"马自达",leibie:"日本",parent:""},{name:"尼桑",leibie:"日本",parent:""},{name:"欧曼",leibie:"其他",parent:""},{name:"荣威",leibie:"中国",parent:""},{name:"三菱",leibie:"日本",parent:""},{name:"尚酷",leibie:"德国",parent:"大众"},{name:"斯柯达",leibie:"德国",parent:""},{name:"索兰托",leibie:"韩国",parent:"起亚"},{name:"特斯拉",leibie:"美国",parent:""},{name:"沃尔沃",leibie:"瑞典",parent:""},{name:"五菱",leibie:"中国",parent:""},{name:"现代",leibie:"韩国",parent:""},{name:"雪佛兰",leibie:"美国",parent:""},{name:"雅阁",leibie:"日本",parent:"本田"},{name:"缤智",leibie:"日本",parent:"本田"},{name:"英菲尼迪",leibie:"日本",parent:""},{name:"中华",leibie:"中国",parent:""},{name:"中骏",leibie:"中国",parent:""},{name:"中联",leibie:"中国",parent:""},{name:"东风",leibie:"中国",parent:""},{name:"克莱斯勒",leibie:"美国",parent:""},{name:"北京",leibie:"中国",parent:""},{name:"长城",leibie:"中国",parent:""},{name:"奥铃",leibie:"中国",parent:"福田"},{name:"海马",leibie:"中国",parent:""},{name:"红旗",leibie:"中国",parent:""},{name:"几何",leibie:"中国",parent:"吉利"},{name:"庆铃",leibie:"中国",parent:""},{name:"思威",leibie:"日本",parent:"本田"},{name:"腾势",leibie:"其他",parent:""},{name:"翼虎",leibie:"中国",parent:"长安"},{name:"欧拉",leibie:"中国",parent:"长城"},{name:"远程",leibie:"中国",parent:"吉利"},{name:"圣玛托",leibie:"美国",parent:""},{name:"捷途",leibie:"中国",parent:"奇瑞"},{name:"长城风骏7",leibie:"中国",parent:"长城"}],Ke=e=>{let t="无品牌类别",a=()=>{let a=[];return null!=e.value&&e.value.length>0&&(a=e.value.split("\n")),a.length>0&&(a=a.filter((e=>null!=e&&e.length>0))),0==a.length?[]:a.map((e=>{let a=e.split("\t"),l={};l.date=a[0]&&a[0].trim()||"无日期",l.dingsunyuan=a[1]&&a[1].trim()||"无定损员",l.xiaoshouyuan=a[2]&&a[2].trim()||"无销售员",l.chepai=a[3]&&a[3].trim()||"车牌",l.pinpai=a[4]&&a[4].trim()||"品牌",l.isChengJiao=!(!a[5]||"是"!=a[5].trim()),l.jine=a[6]&&parseInt(a[6].trim())||0,l.pinpai_leibie=t;try{"品牌"!=l.pinpai&&(l.pinpai_leibie=(n=l.pinpai,qe.filter((e=>e.name==n||e.parent==n)))[0].leibie)}catch(r){console.error(l,r)}var n;return l}))};const l=R((()=>a())),n=R((()=>{let e=0;return l.value&&l.value.length>0&&l.value.forEach((t=>{isNaN(t.jine)||(e+=t.jine)})),e})),r=R((()=>l.value&&l.value.length>0?l.value.filter((e=>e.pinpai_leibie==t)):[])),o=R((()=>{let e=0,t=[];return l.value&&l.value.length>0&&(t=l.value.filter((t=>!!t.isChengJiao&&(e+=t.jine,!0)))),{list:t,totalAmount:e}}));return{dataList:l,totalAmount:n,chengJiaoData:o,noPinPaiDataList:r}},Xe=J({name:"TongJi",components:{TotalAnalyse:Me,PinPaiAnalyse:De,DingSunYuanAnalyse:Ne,XiaoShouYuanAnalyse:Te,NoPinPaiList:$e},setup(){const e={date:"日期",dingsunyuan:"定损员",xiaoshouyuan:"销售员",chepai:"车牌",pinpai:"品牌",isChengJiao:"是否成交",jine:"金额",pinpai_leibie:"品牌类别"},t=W(""),{dataList:a,totalAmount:l,chengJiaoData:n,noPinPaiDataList:r}=Ke(t);return Z("dataList",a),Z("totalAmount",l),Z("chengJiaoData",n),Z("noPinPaiList",r),{headTableItem:e,content:t,dataList:a,totalAmount:l,chengJiaoData:n}}}),Ye={style:{width:"100%"}};const Be=ke(Xe,[["render",function(e,t,a,l,n,r){const u=o,d=i,p=$e,c=Me,m=Ne,h=s,g=Te,f=De;return E(),K(G,null,[O(d,null,{default:N((()=>[F("table",Ye,[F("tr",null,[(E(!0),K(G,null,X(e.headTableItem,((e,t)=>(E(),K("th",{key:t},B(e),1)))),128))])]),O(u,{modelValue:e.content,"onUpdate:modelValue":t[0]||(t[0]=t=>e.content=t),rows:22,type:"textarea",placeholder:"请复制数据至此"},null,8,["modelValue"])])),_:1}),O(d,null,{default:N((()=>[O(p)])),_:1}),O(d,{gutter:10},{default:N((()=>[O(h,{span:12},{default:N((()=>[O(c),O(m)])),_:1}),O(h,{span:12},{default:N((()=>[O(g),O(f)])),_:1})])),_:1})],64)}]]),Ge=e=>(H("data-v-e82166c8"),e=e(),Q(),e),He={class:"card-header"},Qe=Ge((()=>F("span",{style:{color:"var(--el-color-info)"}},"点击可自动复制",-1))),We=Ge((()=>F("span",null,"计算后结果",-1))),Ze=Ge((()=>F("span",null,"结果",-1))),et=ke(J({__name:"result",props:{showComputedList:Array,totalCount:[Number,String],showList:Array,region:String},setup(e){const{toClipboard:t}=ue(),a=W("https://docs.qq.com/sheet/DS0FkVVhwd29KdHNk"),l=async e=>{try{if(null==e)return;let a=Array.isArray(e)&&e.join("\n")||e.toString();await t(a),u({message:"复制成功",type:"success"})}catch(a){console.error(a),u.error(a.message||"真奇怪，不知道哪里错了。")}};return(t,r)=>{const o=d,u=s,p=i,c=n;return E(),K("div",null,[O(c,null,{header:N((()=>[F("div",He,[Qe,O(o,{type:"primary",href:ee(a),target:"_blank"},{default:N((()=>[Y("打开腾讯文档")])),_:1},8,["href"])])])),default:N((()=>[O(p,{gutter:10},{default:N((()=>[O(u,{span:10},{default:N((()=>[te(t.$slots,"default",{},void 0,!0)])),_:3}),O(u,{span:14,onClick:r[0]||(r[0]=t=>l(e.totalCount))},{default:N((()=>[Y(" 总计："+B(e.totalCount),1)])),_:1})])),_:3})])),_:3}),O(p,null,{default:N((()=>[O(u,{span:16},{default:N((()=>[O(c,{onClick:r[1]||(r[1]=t=>l(e.showComputedList))},{header:N((()=>[We])),default:N((()=>[(E(!0),K(G,null,X(e.showComputedList,((e,t)=>(E(),K("div",{key:t},B(e),1)))),128))])),_:1})])),_:1}),O(u,{span:8},{default:N((()=>[O(c,{onClick:r[2]||(r[2]=t=>l(e.showList))},{header:N((()=>[Ze])),default:N((()=>[(E(!0),K(G,null,X(e.showList,((e,t)=>(E(),K("div",{key:t},B(e),1)))),128))])),_:1})])),_:1})])),_:1})])}}}),[["__scopeId","data-v-e82166c8"]]),tt={class:"upload-wapper"},at={class:"el-image"},lt=["src"],nt={class:"tips"},rt=F("small",{style:{color:"var(--el-text-color-disabled)"}},"图片可缩放，也可移动",-1),ot=F("div",{class:"el-upload__text"},"拖拽或上传文件",-1),it=J({__name:"upload",setup(e){const t=W(),a=W(""),l=W(1),n=W(1);W(null);const{handleMousedown:r,handleMousemove:o,handleMouseup:i,translate:s,init:u}=(()=>{const e={x:0,y:0},t=ae({x:0,y:0});let a=!1;return{handleMousedown:t=>{a=!0,e.x=t.clientX,e.y=t.clientY,t.preventDefault()},handleMousemove:l=>(a&&(t.x=l.clientX-e.x,t.y=l.clientY-e.y),!1),handleMouseup:e=>{a=!1},translate:t,init:()=>{t.x=0,t.y=0}}})(),d=e=>{e&&e.hasOwnProperty("url")&&(a.value=e.url||"")},m=()=>{n.value=1,u()},h=e=>{t.value.clearFiles();const a=e[0];a.uid=+new Date,t.value.handleStart(a)},g=e=>(e.deltaY<0?n.value<2?n.value+=.2:n.value=2:e.deltaY>0&&(n.value>.4?n.value-=.2:n.value=.4),!1);return(e,u)=>{const f=p,_=c;return E(),K("div",tt,[F("div",at,[F("img",{src:ee(a),onWheel:g,onMousemove:u[0]||(u[0]=(...e)=>ee(o)&&ee(o)(...e)),onMousedown:u[1]||(u[1]=(...e)=>ee(r)&&ee(r)(...e)),onMouseup:u[2]||(u[2]=(...e)=>ee(i)&&ee(i)(...e)),style:le({transform:"scale("+ee(n)+") translate("+ee(s).x+"px, "+ee(s).y+"px)","object-fit":"contain"}),class:"el-image__inner"},null,44,lt)]),F("p",nt,[rt,F("span",{onClick:m},[Y("图片还原"),O(f,null,{default:N((()=>[O(ee(ge))])),_:1})])]),O(_,{action:"#",drag:"",ref_key:"upload",ref:t,"auto-upload":!1,limit:ee(l),"list-type":"picture","on-change":d,"on-exceed":h},{default:N((()=>[O(f,{class:"el-icon--upload"},{default:N((()=>[O(ee(fe))])),_:1}),ot])),_:1},8,["limit"])])}}}),st=F("legend",null,"分隔符：",-1),ut=J({__name:"index",setup(e){const t=W(""),a=W(["请在此输入输入","一行一组","以空格相格","例如：","123 32 23 3","56 65 45 3","234 42 34 6"].join("\n")),l={SPACE:{label:"空格",value:" "},X:{label:"X;",value:"X"}},n=W(""),r=W(l.SPACE.value);let u=R((()=>{let e=t.value.trim();if(!e)return[];let a=e.split("\n");return a&&0!=a.length?(a[0].includes(l.X.value)?r.value=l.X.value:r.value=l.SPACE.value,a.map((e=>{let t=function(e,t){if(t==l.SPACE.value)return e.trim().split(t);if(t==l.X.value){let a=e.trim().split(t),l=a[2].split(";");return[a[0],a[1],l[0],l[1]]}}(e,r.value);return{len:t[0],width:t[1],height:t[2],count:t[3]}}))):[]})),d=R((()=>u.value.map((e=>e.len+"X"+e.width+"X"+e.height+";"+e.count)))),p=R((()=>u.value.map((e=>e.len+"X"+e.width+"X"+e.height+"X"+e.count+"="+e.len*e.width*e.height*e.count)))),c=R((()=>{let e=0;return u.value.forEach((t=>{e+=t.len*t.width*t.height*t.count})),e}));return(e,u)=>{const g=o,f=s,_=m,b=h,y=i;return E(),U(y,{gutter:20},{default:N((()=>[O(f,{span:10},{default:N((()=>[O(et,{"total-count":ee(c),"show-computed-list":ee(p),"show-list":ee(d),region:ee(n)},{default:N((()=>[O(g,{modelValue:ee(n),"onUpdate:modelValue":u[0]||(u[0]=e=>ne(n)?n.value=e:null),placeholder:"请输入地区"},{prepend:N((()=>[Y("地区")])),_:1},8,["modelValue"])])),_:1},8,["total-count","show-computed-list","show-list","region"])])),_:1}),O(f,{span:4},{default:N((()=>[F("fieldset",null,[st,O(b,{modelValue:ee(r),"onUpdate:modelValue":u[1]||(u[1]=e=>ne(r)?r.value=e:null)},{default:N((()=>[(E(),K(G,null,X(l,(e=>O(_,{label:e.value,size:"small",border:""},{default:N((()=>[Y(B(e.label),1)])),_:2},1032,["label"]))),64))])),_:1},8,["modelValue"])]),O(g,{modelValue:ee(t),"onUpdate:modelValue":u[2]||(u[2]=e=>ne(t)?t.value=e:null),rows:20,type:"textarea",placeholder:ee(a),style:{"font-size":"large"}},null,8,["modelValue","placeholder"])])),_:1}),O(f,{span:10},{default:N((()=>[O(it)])),_:1})])),_:1})}}}),dt="3.1.1",pt={class:"version"},ct=ke(J({__name:"index",setup(e){const t=W(dt);return(e,a)=>(E(),K("div",pt,B(ee(t)),1))}}),[["__scopeId","data-v-4d911824"]]),mt=ke(J({__name:"AsideRouter",setup(e){const t=de().getRoutes().filter((e=>!e.meta.menuHidden));return(e,a)=>{const l=P("router-link");return E(),K("div",null,[(E(!0),K(G,null,X(ee(t),(e=>(E(),U(l,{to:e.path,key:e.path,class:"link"},{default:N((()=>[Y(B(e.meta.title),1)])),_:2},1032,["to"])))),128))])}}}),[["__scopeId","data-v-7023f654"]]),ht={},gt={style:{float:"right",cursor:"pointer"},href:"https://gitee.com/hzsn-csh/sn-tools",target:"_blank"},ft=[F("img",{alt:"Gitee",src:"/sn-tools/img/logo-gitee-g.svg",title:"Gitee — 基于 Git 的代码托管和研发协作平台",style:{height:"36px","margin-top":"12px"}},null,-1)];const _t=ke(ht,[["render",function(e,t){return E(),K("a",gt,ft)}]]);const bt=ke({},[["render",function(e,t){const a=_t,l=g,n=mt,r=ct,o=f,i=P("router-view"),s=_,u=b;return E(),U(u,null,{default:N((()=>[O(l,null,{default:N((()=>[Y("小工具"),O(a)])),_:1}),O(u,{class:"container"},{default:N((()=>[O(o,{width:"200px"},{default:N((()=>[O(n),O(r)])),_:1}),O(s,null,{default:N((()=>[O(i)])),_:1})])),_:1})])),_:1})}],["__scopeId","data-v-4658b423"]]);const yt=ke({},[["render",function(e,t){const a=P("router-link"),l=n,r=s,o=i;return E(),U(o,{gutter:20},{default:N((()=>[O(r,{span:6},{default:N((()=>[O(l,null,{header:N((()=>[Y("体积计算")])),default:N((()=>[O(a,{to:"/volume"},{default:N((()=>[Y("体积计算")])),_:1})])),_:1})])),_:1}),O(r,{span:6},{default:N((()=>[O(l,null,{header:N((()=>[Y("品牌统计")])),default:N((()=>[O(a,{to:"/tongji"},{default:N((()=>[Y("品牌统计")])),_:1})])),_:1})])),_:1}),O(r,{span:6},{default:N((()=>[O(l,null,{header:N((()=>[Y("鼎能面单")])),default:N((()=>[O(a,{to:"/dingnengorder"},{default:N((()=>[Y("鼎能面单")])),_:1})])),_:1})])),_:1})])),_:1})}]]);const vt=ke({},[["render",function(e,t){const a=y,l=P("router-link"),n=v;return E(),U(n,{icon:"error",title:"404","sub-title":"not found"},{extra:N((()=>[O(l,{to:"/"},{default:N((()=>[O(a,{type:"primary"},{default:N((()=>[Y("回首页")])),_:1})])),_:1})])),_:1})}]]),xt={sender:[{required:!0,message:"请输入发货人",trigger:"blur"}],sender_phone:[{required:!0,message:"请输入发货人电话",trigger:"blur"}],recipient_company:[{required:!0,message:"请输入收货单位",trigger:"blur"}],recipient:[{required:!0,message:"请输入收货人",trigger:"blur"}],recipient_phone:[{required:!0,message:"请输入收货人电话",trigger:"blur"}],address:[{required:!0,message:"请输入收货地址",trigger:"blur"}],send_time:[{required:!0,message:"请输入发运时间",trigger:"change"}],recipient_time:[{required:!0,message:"请输入收货时间",trigger:"change"}],total_volume:[{type:"number",required:!0,message:"请输入总体积，数字类型",trigger:"blur"}],total_weight:[{type:"number",required:!0,message:"请输入总重量，数字类型",trigger:"blur"}],delivery_user:[{required:!0,message:"请输入提货人",trigger:"blur"}],remark:[]},wt=[{key:"zhixiang",value:0,text:"纸箱"},{key:"muxiang",value:0,text:"木箱"},{key:"tiejian",value:0,text:"铁件"},{key:"qita",value:0,text:"其他"}],Vt=be("dingnengOrder",{state:()=>({dn_order_id:"",sender:"",sender_phone:"",recipient_company:"",recipient:"",recipient_phone:"",address:"",goodsList:[],send_time:0,recipient_time:0,total_volume:0,total_weight:0,delivery_user:"",remark:""}),getters:{total_count:e=>{let t=0;return e.goodsList.forEach((e=>{t+=e.value})),t}},actions:{createDNOrderId:()=>"DN"+(new Date).getTime()+Math.floor(1e3*Math.random()),getGoodsList:()=>Object.assign([],wt).map((e=>(e.value=0,e))),getFromStorage:()=>({sender:localStorage.getItem("sender")||"",sender_phone:localStorage.getItem("sender_phone")||"",delivery_user:localStorage.getItem("delivery_user")||""}),saveToStorage(){localStorage.setItem("sender",this.sender),localStorage.setItem("sender_phone",this.sender_phone),localStorage.setItem("delivery_user",this.delivery_user)},init(){this.$reset(),this.goodsList=this.getGoodsList(),this.dn_order_id=this.createDNOrderId();let e=this.getFromStorage();this.sender=e.sender,this.sender_phone=e.sender_phone,this.delivery_user=e.delivery_user,this.send_time=+new Date,this.recipient_time=+new Date}}}),kt={style:{width:"600px",margin:"auto"}},St=F("h3",{style:{"text-align":"center",color:"var(--el-text-color-primary)"}},"创建面单",-1),jt=J({__name:"create",setup(e){const t=W(),a=Vt();a.init();const l=a.$state,n=de(),r=async()=>{t&&await t.value.validate((e=>{e&&(a.saveToStorage(),n.push({name:"dingnengOrderPrint"}))}))},u=()=>{t&&a.init()};return(e,a)=>{const n=o,d=w,p=s,c=i,m=V,h=k,g=y,f=x;return E(),K("div",kt,[St,O(f,{ref_key:"elFormRef",ref:t,model:ee(l),rules:ee(xt),"label-width":"100px"},{default:N((()=>[O(c,null,{default:N((()=>[O(p,{span:12},{default:N((()=>[O(d,{label:"发货人",prop:"sender"},{default:N((()=>[O(n,{modelValue:ee(l).sender,"onUpdate:modelValue":a[0]||(a[0]=e=>ee(l).sender=e),placeholder:"请输入发货人",clearable:"",style:{width:"100%"}},null,8,["modelValue"])])),_:1})])),_:1}),O(p,{span:12},{default:N((()=>[O(d,{label:"发货人电话",prop:"sender_phone"},{default:N((()=>[O(n,{modelValue:ee(l).sender_phone,"onUpdate:modelValue":a[1]||(a[1]=e=>ee(l).sender_phone=e),placeholder:"请输入发货人电话",clearable:"",style:{width:"100%"}},null,8,["modelValue"])])),_:1})])),_:1})])),_:1}),O(d,{label:"收货单位",prop:"recipient_company"},{default:N((()=>[O(n,{modelValue:ee(l).recipient_company,"onUpdate:modelValue":a[2]||(a[2]=e=>ee(l).recipient_company=e),placeholder:"请输入收货单位",clearable:"",style:{width:"100%"}},null,8,["modelValue"])])),_:1}),O(c,null,{default:N((()=>[O(p,{span:12},{default:N((()=>[O(d,{label:"收货人",prop:"recipient"},{default:N((()=>[O(n,{modelValue:ee(l).recipient,"onUpdate:modelValue":a[3]||(a[3]=e=>ee(l).recipient=e),placeholder:"请输入收货人",clearable:"",style:{width:"100%"}},null,8,["modelValue"])])),_:1})])),_:1}),O(p,{span:12},{default:N((()=>[O(d,{label:"收货人电话",prop:"recipient_phone"},{default:N((()=>[O(n,{modelValue:ee(l).recipient_phone,"onUpdate:modelValue":a[4]||(a[4]=e=>ee(l).recipient_phone=e),placeholder:"请输入收货人电话",clearable:"",style:{width:"100%"}},null,8,["modelValue"])])),_:1})])),_:1})])),_:1}),O(d,{label:"收货地址",prop:"address"},{default:N((()=>[O(n,{modelValue:ee(l).address,"onUpdate:modelValue":a[5]||(a[5]=e=>ee(l).address=e),placeholder:"请输入收货地址",clearable:"",style:{width:"100%"}},null,8,["modelValue"])])),_:1}),O(c,null,{default:N((()=>[(E(!0),K(G,null,X(ee(l).goodsList,((e,t)=>(E(),U(p,{span:12,key:e.key},{default:N((()=>[O(d,{label:e.text},{default:N((()=>[O(m,{modelValue:e.value,"onUpdate:modelValue":t=>e.value=t,placeholder:"请输入"+e.text,step:1,max:1e3},null,8,["modelValue","onUpdate:modelValue","placeholder"])])),_:2},1032,["label"])])),_:2},1024)))),128))])),_:1}),O(c,null,{default:N((()=>[O(p,{span:12},{default:N((()=>[O(d,{label:"发运时间",prop:"send_time"},{default:N((()=>[O(h,{type:"datetime",modelValue:ee(l).send_time,"onUpdate:modelValue":a[6]||(a[6]=e=>ee(l).send_time=e),placeholder:"请输入发运时间",clearable:"","value-format":"x"},null,8,["modelValue"])])),_:1})])),_:1}),O(p,{span:12},{default:N((()=>[O(d,{label:"收货时间",prop:"recipient_time"},{default:N((()=>[O(h,{type:"datetime",modelValue:ee(l).recipient_time,"onUpdate:modelValue":a[7]||(a[7]=e=>ee(l).recipient_time=e),placeholder:"请输入收货时间",clearable:"","value-format":"x"},null,8,["modelValue"])])),_:1})])),_:1})])),_:1}),O(c,null,{default:N((()=>[O(p,{span:12},{default:N((()=>[O(d,{label:"总体积",prop:"total_volume"},{default:N((()=>[O(n,{modelValue:ee(l).total_volume,"onUpdate:modelValue":a[8]||(a[8]=e=>ee(l).total_volume=e),modelModifiers:{number:!0},placeholder:"请输入总体积",clearable:"",style:{width:"100%"}},{append:N((()=>[Y("m³")])),_:1},8,["modelValue"])])),_:1})])),_:1}),O(p,{span:12},{default:N((()=>[O(d,{label:"总重量",prop:"total_weight"},{default:N((()=>[O(n,{modelValue:ee(l).total_weight,"onUpdate:modelValue":a[9]||(a[9]=e=>ee(l).total_weight=e),modelModifiers:{number:!0},placeholder:"请输入总重量",clearable:""},{append:N((()=>[Y("KG")])),_:1},8,["modelValue"])])),_:1})])),_:1})])),_:1}),O(d,{label:"提货人",prop:"delivery_user"},{default:N((()=>[O(n,{modelValue:ee(l).delivery_user,"onUpdate:modelValue":a[10]||(a[10]=e=>ee(l).delivery_user=e),placeholder:"请输入提货人",clearable:"",style:{width:"100%"}},null,8,["modelValue"])])),_:1}),O(d,{label:"备注",prop:"remark"},{default:N((()=>[O(n,{modelValue:ee(l).remark,"onUpdate:modelValue":a[11]||(a[11]=e=>ee(l).remark=e),type:"textarea",placeholder:"请输入备注",autosize:{minRows:4,maxRows:4},style:{width:"100%"}},null,8,["modelValue"])])),_:1}),O(d,{size:"large"},{default:N((()=>[O(g,{type:"primary",onClick:r},{default:N((()=>[Y("打印")])),_:1}),O(g,{onClick:u},{default:N((()=>[Y("重置")])),_:1})])),_:1})])),_:1},8,["model","rules"])])}}}),Ct=be("dingnengSettings",(()=>{const e="printFontSize",t=()=>{const t=localStorage.getItem(e);return console.log("getFromStorage",t),null==t||null==t?1:parseFloat(t)},a=t(),l=W(a);return{fontSize:l,getFromStorage:t,saveToStorage:()=>{localStorage.setItem(e,""+l.value)}}})),It=J({__name:"barcode",props:{code:{type:String,required:!0}},setup(e){const{code:t}=e,a=W(null);z((()=>{a.value&&l(a.value,t)}));const l=(e,t)=>{pe(e,t,{displayValue:!1,height:60})};return(e,t)=>(E(),K("svg",{ref_key:"barcodeRef",ref:a},null,512))}}),Dt=e=>(H("data-v-a92fa01f"),e=e(),Q(),e),At=Dt((()=>F("div",{class:"order-header"},[F("img",{height:"40",width:"40",src:"/sn-tools/img/dingneng.png"}),F("span",null,"杭州鼎能供应链发运单")],-1))),Lt={style:{margin:"10px 0 0 0"}},Tt={style:{"text-align":"center"}},Jt={colspan:"3"},Et={colspan:"2"},Ut={colspan:"5"},Nt={colspan:"3"},Ot={colspan:"2"},Pt={colspan:"5"},Rt=Dt((()=>F("tr",null,[F("td",{colspan:"5",style:{"text-align":"center",padding:"10px 0px","font-size":"1.12em"}}," 货物详情 ")],-1))),Mt=Dt((()=>F("td",{style:{"text-align":"center"}},"合计",-1))),zt={style:{"text-align":"center"}},Ft={colspan:"3"},$t={colspan:"2"},qt={colspan:"5"},Kt={colspan:"3"},Xt=Dt((()=>F("td",{colspan:"2"},"签收人：",-1))),Yt={colspan:"5"},Bt={style:{border:"none"}},Gt={colspan:"5"},Ht={class:"other-wapper"},Qt={class:"print-btn-wapper"},Wt={class:"print-btn-wapper"},Zt={class:"print-btn-wapper"},ea=ke(J({__name:"print",setup(e){const t=de(),a=Vt(),l=Ct(),n=a.$state,r=W(!1),{fontSize:o}=ye(l),i=e=>{l.saveToStorage()},s=R((()=>{let e=new Date(n.send_time);return e.getFullYear()+"年"+(e.getMonth()+1)+"月"+e.getDate()+"日"})),u=R((()=>{let e=new Date(n.recipient_time);return e.getFullYear()+"年"+(e.getMonth()+1)+"月"+e.getDate()+"日"})),d=()=>{r.value=!0,t.back()},p=()=>{window.print()};return(e,t)=>{const l=V,c=y;return E(),K(G,null,[F("div",{class:"order-wapper print",style:le({fontSize:ee(o)+"em"})},[At,F("p",Lt,"运单号："+B(ee(n).dn_order_id),1),F("div",Tt,[O(It,{code:ee(n).dn_order_id},null,8,["code"])]),F("table",null,[F("tbody",null,[F("tr",null,[F("td",Jt,"发货人："+B(ee(n).sender),1),F("td",Et,"电话："+B(ee(n).sender_phone),1)]),F("tr",null,[F("td",Ut,"收货单位："+B(ee(n).recipient_company),1)]),F("tr",null,[F("td",Nt,"收货人："+B(ee(n).recipient),1),F("td",Ot,"电话："+B(ee(n).recipient_phone),1)]),F("tr",null,[F("td",Pt,"收货地址："+B(ee(n).address),1)]),Rt,F("tr",null,[(E(!0),K(G,null,X(ee(n).goodsList,(e=>(E(),K("td",{class:"border-right",key:e.key},B(e.text),1)))),128)),Mt]),F("tr",null,[(E(!0),K(G,null,X(ee(n).goodsList,(e=>(E(),K("td",{class:"border-right",key:e.key},B(e.value),1)))),128)),F("td",zt,B(ee(a).total_count),1)]),F("tr",null,[F("td",Ft,"体积："+B(ee(n).total_volume)+" m³",1),F("td",$t,"重量："+B(ee(n).total_weight)+" KG",1)]),F("tr",null,[F("td",qt,"发运时间："+B(ee(s)),1)]),F("tr",null,[F("td",Kt,"提货人："+B(ee(n).delivery_user),1),Xt]),F("tr",null,[F("td",Yt,"日期："+B(ee(u)),1)]),F("tr",Bt,[F("td",Gt,"备注："+B(ee(n).remark),1)])])])],4),F("div",Ht,[F("div",Qt,[O(l,{modelValue:ee(o),"onUpdate:modelValue":t[0]||(t[0]=e=>ne(o)?o.value=e:null),precision:2,step:.1,min:1,max:2,onChange:i,style:{width:"200px","margin-left":"74px"}},null,8,["modelValue","step"])]),F("div",Wt,[O(c,{type:"primary",class:"print-btn",onClick:p},{default:N((()=>[Y("打印")])),_:1})]),F("div",Zt,[O(c,{onClick:d,loading:ee(r)},{default:N((()=>[Y("返回")])),_:1},8,["loading"])])])],64)}}}),[["__scopeId","data-v-a92fa01f"]]),ta=[{id:57,text:"陆放",label:"kluger"},{id:38,text:"荣放",label:"rav4"}],aa={index:-1,label:"全部"},la="city",na="username",ra="phone",oa="series_id",ia="dealer_id",sa="company",ua="order_at";var da=(e=>(e[e.DATA=0]="DATA",e[e.SERIES=1]="SERIES",e))(da||{});const pa={data:{id:0,text:"数据"},seriesData:{id:1,text:"车系资料"}},ca=[{key:"city",zhKey:"城市",index:1},{key:"username",zhKey:"姓名",index:5},{key:"phone",zhKey:"电话",index:6}],ma=[{key:"dealerId",zhKey:"经销商编码",index:0},{key:"name",zhKey:"经销商名称",index:1},{key:"city",zhKey:"城市",index:2}],ha={hour:[9,10,11,12,13,14,15,16,17,18,19,20,21,22],weight:[9,6,3,2,1,3,4,3,3,8,8,4,2,1]},ga=ha.weight.reduce(((e,t)=>e+t)),fa={class:"title"},_a=ke(J({__name:"RadioTitle",props:{text:{type:String,default:"项"}},setup:e=>(t,a)=>(E(),K("span",fa,B(e.text),1))}),[["__scopeId","data-v-9b2e10e3"]]),ba={class:"dialog-footer"},ya=J({__name:"SheetDialog",props:{sheetIndex:{type:Number,default:aa.index},visible:{type:Boolean,default:!1},fileName:{type:String},sheetNames:{type:Array,default:[]}},emits:["update:sheetIndex","update:visible","select"],setup(e,{emit:t}){const a=e,l=R({get:()=>[aa,...a.sheetNames.map(((e,t)=>({index:t,label:e})))],set(e){console.log(e)}}),n=R({get:()=>a.sheetIndex,set(e){t("update:sheetIndex",e)}}),r=R({get:()=>a.visible,set(e){t("update:visible",e)}}),o=e=>{t("update:sheetIndex",e)},i=()=>{r.value=!1,t("select",a.sheetIndex)};return(t,a)=>{const s=m,u=h,d=y,p=S;return E(),U(p,{modelValue:ee(r),"onUpdate:modelValue":a[2]||(a[2]=e=>ne(r)?r.value=e:null),title:"选择Sheet"},{footer:N((()=>[F("span",ba,[O(d,{onClick:a[1]||(a[1]=e=>r.value=!1)},{default:N((()=>[Y("取消")])),_:1}),O(d,{type:"primary",onClick:i},{default:N((()=>[Y(" 确定 ")])),_:1})])])),default:N((()=>[F("p",null,B(e.fileName),1),O(_a,{text:"Sheet"}),O(u,{modelValue:ee(n),"onUpdate:modelValue":a[0]||(a[0]=e=>ne(n)?n.value=e:null),onChange:o},{default:N((()=>[(E(!0),K(G,null,X(ee(l),(e=>(E(),U(s,{label:e.index,border:""},{default:N((()=>[Y(B(e.label),1)])),_:2},1032,["label"])))),256))])),_:1},8,["modelValue"])])),_:1},8,["modelValue"])}}}),va="application/vnd.openxmlformats-officedocument.spreadsheetml.sheet",xa=F("div",{class:"el-upload__text"},[Y(" Drop file here or "),F("em",null,"click to upload")],-1),wa=J({__name:"SnUpload",emits:["change"],setup(e,{emit:t}){const a=W(),{valiteFile:l,handleExceed:n,acceptType:r}=(e=>({valiteFile:(e,t)=>{let a=e.raw;if(a){if(a.type==va)return!0;u({type:"warning",message:"附件格式错误，请删除后重新上传！"})}else u({type:"warning",message:"请上传附件！"});return!1},handleExceed:t=>{e.value.clearFiles();const a=t[0];a.uid=Date.now(),e.value.handleStart(a)},acceptType:va}))(a),o=(e,a)=>{l(e,a)&&e.raw&&t("change",e.raw)};return(e,t)=>{const l=p;return E(),U(ee(c),{drag:"",ref_key:"uploadRef",ref:a,action:"","on-change":o,"on-exceed":ee(n),limit:1,accept:ee(r),"auto-upload":!1},{default:N((()=>[O(l,{class:"el-icon--upload"},{default:N((()=>[O(ee(_e))])),_:1}),xa])),_:1},8,["on-exceed","accept"])}}});function Va(e,t){return e=Math.ceil(e),t=Math.floor(t),Math.floor(Math.random()*(t-e))+e}function ka(e){return e<10&&"0"+e||e}function Sa(e){return e.label+e.id}function ja(e){let t=localStorage.getItem(Sa(e));return t&&JSON.parse(t)||[]}const Ca=/^(0|86|17951)?(13[0-9]|14[01456789]|15[012356789]|16[2567]|17[235678]|18[0-9]|19[012356789])[0-9]{8}$/;const Ia=be("ftmsStore",(()=>{let e=new Date;const t=W([new Date(e.getFullYear(),e.getMonth(),e.getDate()-1,18),new Date(e.getFullYear(),e.getMonth(),e.getDate(),17,30,0)]),a=ae(pa),l=ae({[ta[0].label]:ja(ta[0]),[ta[1].label]:ja(ta[1])});return{dateTime:t,uploadTypeRadioKeyList:a,seriesList:l,saveSeries:function(e,t){localStorage.setItem(Sa(t),JSON.stringify(e)),l[t.label]=e},hasSeriesData:function(e){return l[e.label].length>0}}})),Da={style:{"margin-bottom":"20px"}},Aa=ke(J({__name:"UploadTypeRadio",props:["modelValue"],emits:["update:modelValue"],setup(e,{emit:t}){const a=e,{uploadTypeRadioKeyList:l}=Ia(),n=R({get:()=>a.modelValue,set:e=>t("update:modelValue",e)});return(e,t)=>{const a=j,r=h;return E(),K("div",Da,[O(_a,{text:"数据类型"}),O(r,{modelValue:ee(n),"onUpdate:modelValue":t[0]||(t[0]=e=>ne(n)?n.value=e:null)},{default:N((()=>[(E(!0),K(G,null,X(ee(l),(e=>(E(),U(a,{label:e.id,border:""},{default:N((()=>[Y(B(e.text),1)])),_:2},1032,["label"])))),256))])),_:1},8,["modelValue"])])}}}),[["__scopeId","data-v-d5ddec6c"]]),La=J({__name:"TipDescription",setup(e){const{seriesList:t}=ye(Ia()),a=R((()=>({label:ta[0].text,desc:`${t.value[ta[0].label].length}条`}))),l=R((()=>({label:ta[1].text,desc:`${t.value[ta[1].label].length}条`})));return(e,t)=>{const n=C,r=I;return E(),U(r,{border:"",title:"车系资料"},{default:N((()=>[O(n,{"label-align":"right",align:"center",label:ee(a).label},{default:N((()=>[Y(B(ee(a).desc),1)])),_:1},8,["label"]),O(n,{"label-align":"right",align:"center",label:ee(l).label},{default:N((()=>[Y(B(ee(l).desc),1)])),_:1},8,["label"])])),_:1})}}}),Ta=J({__name:"SnForm",setup(e){const{dateTime:t}=ye(Ia());return(e,a)=>{const l=k,n=w,r=x;return E(),U(r,{inline:!0,class:"demo-form-inline"},{default:N((()=>[O(n,{label:"时间范围"},{default:N((()=>[O(l,{modelValue:ee(t),"onUpdate:modelValue":a[0]||(a[0]=e=>ne(t)?t.value=e:null),type:"datetimerange","range-separator":"至","start-placeholder":"Start date","end-placeholder":"End date"},null,8,["modelValue"])])),_:1})])),_:1})}}}),Ja=ke(J({__name:"TipAlert",setup(e){const{seriesList:t}=ye(Ia()),a=W(!1),l=R((()=>{let e=0==t.value[ta[0].label].length;return{title:`${ta[0].text} 数据不存在`,show:e}})),n=R((()=>{let e=0==t.value[ta[1].label].length;return{title:`${ta[1].text} 数据不存在`,show:e}}));return(e,t)=>(E(),K(G,null,[ee(l).show?(E(),U(ee(D),{key:0,title:ee(l).title,type:"error",closable:ee(a)},null,8,["title","closable"])):re("",!0),ee(n).show?(E(),U(ee(D),{key:1,title:ee(n).title,type:"error",closable:ee(a)},null,8,["title","closable"])):re("",!0)],64))}}),[["__scopeId","data-v-c13bbe3e"]]);const Ea=(e,t)=>{let a={};for(const l in e)if(Object.prototype.hasOwnProperty.call(e,l)){const t=e[l];a[l]=xe.json_to_sheet(t)}!function(e,t){let a=URL.createObjectURL(e);var l,n=document.createElement("a");n.href=a,n.download=t||"",window.MouseEvent?l=new MouseEvent("click"):(l=document.createEvent("MouseEvents")).initMouseEvent("click",!0,!1,window,0,0,0,0,0,!1,!1,!1,!1,0,null),n.dispatchEvent(l),n.remove()}(function(e){var t={SheetNames:Object.keys(e),Sheets:{}};for(const l in e)if(Object.prototype.hasOwnProperty.call(e,l)){const a=e[l];t.Sheets[l]=a}var a=Ve(t,{bookType:"xlsx",bookSST:!1,type:"binary"});return new Blob([function(e){for(var t=new ArrayBuffer(e.length),a=new Uint8Array(t),l=0;l!=e.length;++l)a[l]=255&e.charCodeAt(l);return t}(a)],{type:"application/octet-stream"})}(a),function(e,t){let a=t.lastIndexOf("."),l=1==e.length&&e[0]+"-"||"";return t.substring(0,a)+"-"+l+ +new Date+t.substring(a)}(Object.keys(a),t))};const Ua=(e,t,a,l,n="\t")=>{let r=e.Sheets[e.SheetNames[t]],o=xe.sheet_to_txt(r).split("\n");null==l&&(l=a.find((e=>o[0].includes(e.zhKey)||o[0].includes(e.key)))?1:0);let i=[],s=0;for(let u=l;u<o.length;u++){const e=o[u].trim();if(!e){s++;continue}let t=e.split(n),l={};for(const n of a)l[n.key]=t[n.index].trim(),l[n.key].length||s++;i.push(l)}return{list:i,emptyCount:s}};function Na(){const{dateTime:e}=Ia();let t=function(e,t){let a=Va(0,t);for(let l=0;l<e.length;l++)if(a-=e[l],a<=0)return l;return 0}(ha.weight,ga),a=ha.hour[t],l=new Date(Va(e[0].getTime(),e[1].getTime()));for(;l.getHours()!=a;)l=new Date(Va(e[0].getTime(),e[1].getTime()));let n=l.getFullYear(),r=l.getMonth()+1,o=l.getDate(),i=ka(l.getMinutes()),s=ka(l.getSeconds());return n+"-"+ka(r)+"-"+ka(o)+" "+ka(a)+":"+i+":"+s}function Oa(e,t){let a=ta.filter((t=>e.includes(t.text)));if(a.length>0)return a[0];if(a=ta.filter((e=>t.includes(e.text))),a.length>0)return a[0];throw new Error("没有从文件名或sheet name 中找到车系名称")}const Pa=(e,t)=>{const{seriesList:a}=ye(Ia());let l=a.value[t.label],n=e.map(((e,a)=>{let l={...e,seriesId:t.id};var n;return n=l.phone,Ca.test(n.toString())||console.warn(`${a+1}:${l.phone}有误`),l})),r=new Set;n.forEach((e=>r.add(e.city)));let o={};return r.forEach((e=>{if(o[e]=l.filter((t=>t.city==e)),0==o[e].length)throw new Error(`没有该字段的车系数据：${e}`)})),function(e,t){e.forEach((e=>{let a=Va(0,t[e.city].length),l=t[e.city][a];e.dealerId=l.dealerId,e.dealerName=l.name}))}(n,o),function(e){e.forEach((e=>{e.orderAt=Na()}))}(n),n.map((e=>{let t={};return t[la]=e.city,t[na]=e.username,t[ra]=e.phone,t[ia]=e.dealerId,t[sa]=e.dealerName,t[oa]=e.seriesId,t[ua]=e.orderAt,t}))},Ra=()=>{const e=Ia(),{uploadTypeRadioKeyList:t}=ye(e),a=W(t.value.data.id),l=W(),n=ae({visible:!1,sheetNames:[],sheetIndex:aa.index,fileName:""});oe((()=>n.fileName),(()=>n.sheetIndex=aa.index));function r(e){if(e==da.DATA)return ca;if(e==da.SERIES)return ma;throw new Error(`没有此类型key:${e}`)}function o(e,t){t&&u.warning(`sheet:${e} 已忽略${t}行空数据`)}return{workBook:l,sheetDialogConfig:n,openSheetDialog:(e,t)=>{n.sheetNames=t,n.visible=!0,n.fileName=e},uploadType:a,handleSheetSelect:t=>{if(!l.value)return;let i={};if(t==aa.index){let e=l.value.SheetNames,t=r(a.value);for(let a=0;a<e.length;a++){let n=Ua(l.value,a,t);i[e[a]]=n.list,o(e[a],n.emptyCount)}}else{let e=Ua(l.value,t,r(a.value));i[l.value.SheetNames[t]]=e.list,o(l.value.SheetNames[t],e.emptyCount)}try{(t=>{const{sheetObject:a,fileName:l,uploadType:n}=t;if(n.value==da.DATA){let t={};for(const n in a)if(Object.prototype.hasOwnProperty.call(a,n)){const r=a[n];let o=Oa(n,l);if(!e.hasSeriesData(o))throw new Error(`没有该车系的数据：${o.text} 请先上传${o.text}的数据`);t[n]=Pa(r,o)}Ea(t,l)}else{if(n.value!=da.SERIES)throw new Error("类型错误");for(const t in a)if(Object.prototype.hasOwnProperty.call(a,t)){const n=a[t];let r=Oa(t,l);e.saveSeries(n,r),u.success(`已添加${t}${n.length}条数据`)}}})({sheetObject:i,fileName:n.fileName,uploadType:a})}catch(s){console.error(s),u.error(s.message)}finally{l.value=void 0}}}},Ma=F("h2",{style:{"text-align":"center"}},"2023年1月份留资数据格式化",-1),za=J({__name:"index",setup(e){const{uploadType:t,sheetDialogConfig:a,openSheetDialog:l,workBook:n,handleSheetSelect:r}=Ra(),o=e=>{var t;(t=e,new Promise(((e,a)=>{let l=new FileReader;l.onload=t=>{var l;try{e(we(null==(l=t.target)?void 0:l.result))}catch(n){a(n)}},l.readAsArrayBuffer(t)}))).then((t=>{let a=t;n.value=a,l(e.name,n.value.SheetNames)})).catch((e=>{n.value=void 0,u.error(e.message),console.error(e)}))};return(e,l)=>{const n=Ja,u=Ta,d=La,p=s,c=Aa,m=wa,h=i,g=ya;return E(),K(G,null,[Ma,O(n),O(h,{gutter:20},{default:N((()=>[O(p,{span:12},{default:N((()=>[O(u),O(d)])),_:1}),O(p,{span:12},{default:N((()=>[O(c,{modelValue:ee(t),"onUpdate:modelValue":l[0]||(l[0]=e=>ne(t)?t.value=e:null)},null,8,["modelValue"]),O(m,{onChange:o})])),_:1})])),_:1}),O(g,{sheetIndex:ee(a).sheetIndex,"onUpdate:sheetIndex":l[1]||(l[1]=e=>ee(a).sheetIndex=e),visible:ee(a).visible,"onUpdate:visible":l[2]||(l[2]=e=>ee(a).visible=e),"sheet-names":ee(a).sheetNames,onSelect:ee(r),"file-name":ee(a).fileName},null,8,["sheetIndex","visible","sheet-names","onSelect","file-name"])],64)}}}),Fa=be("trackStore",(()=>({dn_order_id:W(""),dataList:ae([])}))),$a=()=>{const e=Fa();return{addItem:()=>{e.dataList.push({})},deleteAllItem:()=>{e.dataList.splice(0)},deleteItem:t=>{e.dataList.splice(t,1)},jsonCode:R((()=>JSON.stringify({list:e.dataList,dn_order_id:e.dn_order_id},null,2)))}},qa=J({__name:"HighLightCode",setup(e){const t=ce.component,{jsonCode:a}=$a();return z((()=>{new se("#highlightjs")})),(e,l)=>(E(),U(ee(t),{id:"highlightjs",autodetect:"",code:ee(a),"data-clipboard-target":"#highlightjs"},null,8,["code"]))}}),Ka={0:{code:0,text:"揽收"},1:{code:1,text:"运输中"},2:{code:2,text:"派送中"},3:{code:3,text:"签收"}},Xa={status:"状态",update_time:"时间",info:"信息",station:"地点"},Ya=J({__name:"TrackTable",setup(e){const{dataList:t}=Fa(),{deleteItem:n}=$a(),r=Object.values(Ka);return(e,i)=>{const s=A,u=L,d=a,p=k,c=o,m=y,h=l;return E(),U(h,{data:ee(t),stripe:""},{default:N((()=>[O(d,{prop:ee(Xa).status,label:ee(Xa).status,width:"120"},{default:N((e=>[O(u,{modelValue:e.row.status,"onUpdate:modelValue":t=>e.row.status=t,placeholder:"状态",onChange:t=>{return a=t,void((l=e.row).info||(l.info=Ka[a].text));var a,l}},{default:N((()=>[(E(!0),K(G,null,X(ee(r),(e=>(E(),U(s,{key:e.code,label:e.text,value:e.code},null,8,["label","value"])))),128))])),_:2},1032,["modelValue","onUpdate:modelValue","onChange"])])),_:1},8,["prop","label"]),O(d,{prop:ee(Xa).update_time,label:ee(Xa).update_time,width:"250"},{default:N((e=>[O(p,{modelValue:e.row.update_time,"onUpdate:modelValue":t=>e.row.update_time=t,type:"datetime",placeholder:"更新时间","value-format":"x"},null,8,["modelValue","onUpdate:modelValue"])])),_:1},8,["prop","label"]),O(d,{prop:ee(Xa).station,label:ee(Xa).station,width:"150"},{default:N((e=>[O(c,{modelValue:e.row.station,"onUpdate:modelValue":t=>e.row.station=t,placeholder:"地点",clearable:""},null,8,["modelValue","onUpdate:modelValue"])])),_:1},8,["prop","label"]),O(d,{prop:ee(Xa).info,label:ee(Xa).info},{default:N((e=>[O(c,{modelValue:e.row.info,"onUpdate:modelValue":t=>e.row.info=t,placeholder:"更新信息",clearable:""},null,8,["modelValue","onUpdate:modelValue"])])),_:1},8,["prop","label"]),O(d,{fixed:"right",label:"操作",width:"80"},{default:N((e=>[O(m,{link:"",type:"danger",size:"small",onClick:t=>ee(n)(e.$index)},{default:N((()=>[Y("删除")])),_:2},1032,["onClick"])])),_:1})])),_:1},8,["data"])}}}),Ba=F("h2",null,"轨迹生成器",-1),Ga=[{path:"/",name:"index",component:bt,meta:{menuHidden:!0},children:[{path:"/",name:"dashboard",component:yt,meta:{title:"首页"}},{path:"/volume",name:"volume",component:ut,meta:{title:"体积计算"}},{path:"/tongji",name:"tongji",component:Be,meta:{title:"品牌统计"}},{path:"/ftms",name:"ftms",component:za,meta:{title:"留资数据格式化"}},{path:"/track",name:"track",component:J({__name:"index",setup(e){const{dn_order_id:t}=ye(Fa()),{addItem:a,deleteAllItem:l}=$a();return(e,n)=>{const r=o,u=w,d=s,p=y,c=T,m=i,h=Ya,g=qa,f=x;return E(),K(G,null,[Ba,O(f,{"label-width":"50px"},{default:N((()=>[O(m,{gutter:10},{default:N((()=>[O(d,{span:8},{default:N((()=>[O(u,{label:"订单号","label-width":"80px"},{default:N((()=>[O(r,{modelValue:ee(t),"onUpdate:modelValue":n[0]||(n[0]=e=>ne(t)?t.value=e:null)},null,8,["modelValue"])])),_:1})])),_:1}),O(d,{span:16},{default:N((()=>[O(p,{type:"primary",onClick:ee(a),text:""},{default:N((()=>[Y("新增")])),_:1},8,["onClick"]),O(c,{title:"确认删除所有？",onConfirm:ee(l)},{reference:N((()=>[O(p,{type:"danger",text:""},{default:N((()=>[Y("删除")])),_:1})])),_:1},8,["onConfirm"])])),_:1})])),_:1}),O(m,{gutter:10},{default:N((()=>[O(d,{span:14},{default:N((()=>[O(h)])),_:1}),O(d,{span:10},{default:N((()=>[O(g)])),_:1})])),_:1})])),_:1})],64)}}}),meta:{title:"轨迹生成器"}},{path:"dingnengorder",name:"dingnengOrder",component:jt,meta:{title:"鼎能面单"}},{path:"/:pathMatch(.*)*",name:"NotFound",component:vt,meta:{menuHidden:!0}}]},{path:"/dingnengorder/print",name:"dingnengOrderPrint",component:ea,meta:{menuHidden:!0}}],Ha=me({history:he(),routes:Ga}),Qa=ve();ie(Se).use(Ha).use(Qa).mount("#app");
