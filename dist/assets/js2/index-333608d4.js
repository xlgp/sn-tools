import{z as e,E as t,a,b as l,c as n,d as r,e as i,f as o,g as s,h as u,i as d,j as p,k as c,l as m,m as h,n as g,o as f,p as _,q as b,r as y,s as v,t as x,u as w,v as V,w as k,x as S,y as j,A as I,B as D,C,D as A}from"../js1/_element-plus-6c0c4e3f.js";import{j as T,o as L,K as E,L as J,U as N,ae as U,f as P,i as O,e as R,a as M,M as z,V as F,c as $,a6 as q,R as K,S as X,T as Y,al as G,am as B,r as H,p as Q,u as W,H as Z,h as ee,Z as te,E as ae,Q as le,w as ne,an as re}from"../js1/_@vue-3e83f63b.js";import{L as ie,M as oe,N as se,O as ue,P as de,Q as pe}from"../js1/__vendor-e5736282.js";import{A as ce,q as me,B as he}from"../js1/_@element-plus-b486a54b.js";import{d as ge,s as fe,c as _e}from"../js1/_pinia-71e64734.js";import{u as be,r as ye,w as ve}from"../js1/_xlsx-05fabba3.js";!function(){const e=document.createElement("link").relList;if(!(e&&e.supports&&e.supports("modulepreload"))){for(const e of document.querySelectorAll('link[rel="modulepreload"]'))t(e);new MutationObserver((e=>{for(const a of e)if("childList"===a.type)for(const e of a.addedNodes)"LINK"===e.tagName&&"modulepreload"===e.rel&&t(e)})).observe(document,{childList:!0,subtree:!0})}function t(e){if(e.ep)return;e.ep=!0;const t=function(e){const t={};return e.integrity&&(t.integrity=e.integrity),e.referrerPolicy&&(t.referrerPolicy=e.referrerPolicy),"use-credentials"===e.crossOrigin?t.credentials="include":"anonymous"===e.crossOrigin?t.credentials="omit":t.credentials="same-origin",t}(e);fetch(e.href,t)}}();const xe=(e,t)=>{const a=e.__vccOpts||e;for(const[l,n]of t)a[l]=n;return a};const we=xe(T({name:"App",setup:()=>({zIndex:3e3,locale:e})}),[["render",function(e,a,l,n,r,i){const o=U("router-view"),s=t;return L(),E(s,{locale:e.locale,"z-index":e.zIndex},{default:J((()=>[N(o)])),_:1},8,["locale","z-index"])}]]);const Ve=(e,t)=>{function a(){let a={};return e.value&&e.value.length>0&&(e.value.sort(((e,t)=>e.pinpai_leibie.localeCompare(t.pinpai_leibie))),e.value.forEach((e=>{var t;a[e.pinpai_leibie]?function(e,t){e.total+=1,e.jine+=t.jine,e.chengJiaoTotal+=t.isChengJiao?1:0,e.chengJiaoJine+=t.isChengJiao&&t.jine||0}(a[e.pinpai_leibie],e):a[e.pinpai_leibie]={pinpai_leibie:(t=e).pinpai_leibie,total:1,jine:t.jine,totalRate:0,jineRate:0,chengJiaoTotal:t.isChengJiao?1:0,chengJiaoJine:t.isChengJiao&&t.jine||0}})),function(e,t,a){Object.keys(e).forEach((l=>{e[l].totalRate=e[l].total/t,e[l].jineRate=e[l].jine/a}))}(a,e.value.length,t.value)),a}return P((()=>a()))},ke=T({name:"PinPaiAnalyse",setup(){const e=O("dataList"),t=O("totalAmount"),a=Ve(e,t),l=P((()=>Object.values(a.value)));return R((()=>{new ie("#pinpaiTable")})),{tableData:l}}}),Se=M("span",null,"品牌构成分析",-1);const je=xe(ke,[["render",function(e,t,r,i,o,s){const u=a,d=l,p=n;return L(),E(p,{class:"box-card",id:"pinpaiCard"},{header:J((()=>[Se])),default:J((()=>[N(d,{data:e.tableData,id:"pinpaiTable","data-clipboard-target":"#pinpaiCard",style:{width:"100%"},size:"small","show-summary":""},{default:J((()=>[N(u,{type:"index",label:"序号"}),N(u,{prop:"pinpai_leibie",label:"类型"}),N(u,{prop:"total",label:"数量（份）"}),N(u,{prop:"jine",label:"金额"}),N(u,{prop:"totalRate",label:"数量占比"}),N(u,{prop:"jineRate",label:"金额占比"}),N(u,{prop:"chengJiaoTotal",label:"成交数量"}),N(u,{prop:"chengJiaoJine",label:"成交金额"})])),_:1},8,["data"])])),_:1})}]]),Ie=T({name:"DingSunYuanAnalyse",setup(){const e=O("dataList"),t=P((()=>{let t={};return e.value&&e.value.length>0?(e.value.sort(((e,t)=>e.xiaoshouyuan.localeCompare(t.xiaoshouyuan))),e.value.forEach((e=>{t[e.xiaoshouyuan]?(t[e.xiaoshouyuan].total+=1,t[e.xiaoshouyuan].chengJiaoTotal+=e.isChengJiao?1:0):t[e.xiaoshouyuan]={xiaoshouyuan:e.xiaoshouyuan,total:1,chengJiaoTotal:e.isChengJiao?1:0}})),Object.values(t)):[]}));return R((()=>{new ie("#xsytable")})),{tableData:t}}}),De=M("span",null,"销售员分析",-1);const Ce=xe(Ie,[["render",function(e,t,r,i,o,s){const u=a,d=l,p=n;return L(),E(p,{class:"box-card",id:"xsycard"},{header:J((()=>[De])),default:J((()=>[N(d,{data:e.tableData,id:"xsytable","data-clipboard-target":"#xsycard",style:{width:"100%"},size:"small","show-summary":""},{default:J((()=>[N(u,{type:"index",label:"序号"}),N(u,{prop:"xiaoshouyuan",label:"销售员"}),N(u,{prop:"total",label:"总量"}),N(u,{prop:"chengJiaoTotal",label:"成交数量"})])),_:1},8,["data"])])),_:1})}]]);const Ae=(e,t)=>{let a=()=>{let a={};return e.value&&e.value.length>0&&(e.value.sort(((e,t)=>e.dingsunyuan.localeCompare(t.dingsunyuan))),e.value.forEach((e=>{var t;a[e.dingsunyuan]?function(e,t){e.total+=1,e.jine+=t.jine,e.chengJiaoTotal+=t.isChengJiao?1:0,e.chengJiaoJine+=t.isChengJiao&&t.jine||0}(a[e.dingsunyuan],e):a[e.dingsunyuan]={total:1,jine:(t=e).jine,totalRate:0,jineRate:0,chengJiaoTotal:t.isChengJiao?1:0,chengJiaoJine:t.isChengJiao&&t.jine||0,dingsunyuan:t.dingsunyuan}})),function(e,t,a){Object.keys(e).forEach((l=>{e[l].totalRate=e[l].total/t,e[l].jineRate=e[l].jine/a}))}(a,e.value.length,t.value)),a};return P((()=>a()))},Te=T({name:"DingSunYuanAnalyse",setup(){const e=O("dataList"),t=O("totalAmount"),a=Ae(e,t),l=P((()=>Object.values(a.value)));return R((()=>{new ie("#dsytable")})),{tableData:l}}}),Le=M("span",null,"定损员分析",-1);const Ee=xe(Te,[["render",function(e,t,r,i,o,s){const u=a,d=l,p=n;return L(),E(p,{class:"box-card",id:"dsycard"},{header:J((()=>[Le])),default:J((()=>[N(d,{data:e.tableData,id:"dsytable","data-clipboard-target":"#dsycard",style:{width:"100%"},size:"small","show-summary":""},{default:J((()=>[N(u,{type:"index",label:"序号"}),N(u,{prop:"dingsunyuan",label:"类型"}),N(u,{prop:"total",label:"数量（份）"}),N(u,{prop:"jine",label:"金额"}),N(u,{prop:"totalRate",label:"数量占比"}),N(u,{prop:"jineRate",label:"金额占比"}),N(u,{prop:"chengJiaoTotal",label:"成交数量"}),N(u,{prop:"chengJiaoJine",label:"成交金额"})])),_:1},8,["data"])])),_:1})}]]),Je=(e,t,a)=>P((()=>function(){let l=["询价单数","询价金额","供应单数","供应金额","未供应单数","未供应金额"],n=[];if(e.value&&e.value.length>0){n.push({key:l[0],num:e.value.length,rate:1}),n.push({key:l[1],num:t.value,rate:1}),n.push({key:l[2],num:a.value.list.length,rate:a.value.list.length/e.value.length}),n.push({key:l[3],num:a.value.totalAmount,rate:a.value.totalAmount/t.value});let r=e.value.length-a.value.list.length;n.push({key:l[4],num:r,rate:r/e.value.length});let i=t.value-a.value.totalAmount;n.push({key:l[5],num:i,rate:i/t.value})}return n}())),Ne=T({name:"TotalAnalyse",setup(){const e=O("dataList"),t=O("totalAmount"),a=O("chengJiaoData"),l=Je(e,t,a);return R((()=>{new ie("#totalTable")})),{totalAnalyse:l}}}),Ue=M("span",null,"报价总量分析",-1);const Pe=xe(Ne,[["render",function(e,t,r,i,o,s){const u=a,d=l,p=n;return L(),E(p,{class:"box-card",id:"totalCard"},{header:J((()=>[Ue])),default:J((()=>[N(d,{data:e.totalAnalyse,id:"totalTable","data-clipboard-target":"#totalCard",style:{width:"100%"},size:"small"},{default:J((()=>[N(u,{type:"index",label:"序号"}),N(u,{prop:"key",label:"类型"}),N(u,{prop:"num",label:"数量"}),N(u,{prop:"rate",label:"占比"})])),_:1},8,["data"])])),_:1})}]]),Oe=T({name:"NoPinPaiList",setup(){const e=O("noPinPaiList"),t=P((()=>e.value.length>0));return{noPinPaiList:e,showable:t}}}),Re=(e=>(G("data-v-6cec74d4"),e=e(),B(),e))((()=>M("span",null,"无品牌类型",-1)));const Me=xe(Oe,[["render",function(e,t,a,l,i,o){const s=r,u=n;return z((L(),E(u,{class:"box-card"},{header:J((()=>[Re])),default:J((()=>[(L(!0),$(Y,null,q(e.noPinPaiList,((e,t)=>(L(),E(s,{key:t},{default:J((()=>[K(X(e.pinpai),1)])),_:2},1024)))),128))])),_:1},512)),[[F,e.showable]])}],["__scopeId","data-v-6cec74d4"]]),ze=[{name:"奥德赛",leibie:"日本",parent:"本田"},{name:"宝马",leibie:"德国",parent:""},{name:"北京现代",leibie:"其他",parent:""},{name:"奔驰",leibie:"德国",parent:""},{name:"奥迪",leibie:"德国",parent:""},{name:"比亚迪",leibie:"中国",parent:""},{name:"别克",leibie:"美国",parent:""},{name:"宾利",leibie:"英国",parent:""},{name:"长安",leibie:"中国",parent:""},{name:"大众",leibie:"德国",parent:""},{name:"谛艾仕",leibie:"法国",parent:""},{name:"帝豪",leibie:"中国",parent:""},{name:"东风日产",leibie:"其他",parent:""},{name:"东风天龙",leibie:"中国",parent:"吉利"},{name:"东风雪铁龙",leibie:"其他",parent:""},{name:"东风悦达起亚",leibie:"其他",parent:""},{name:"风神",leibie:"中国",parent:""},{name:"丰田",leibie:"日本",parent:""},{name:"广丰",leibie:"日本",parent:"丰田"},{name:"福特",leibie:"美国",parent:""},{name:"福田",leibie:"中国",parent:""},{name:"广汽本田",leibie:"其他",parent:""},{name:"哈弗",leibie:"中国",parent:""},{name:"江淮",leibie:"中国",parent:""},{name:"捷豹",leibie:"英国",parent:""},{name:"晶马",leibie:"中国",parent:""},{name:"凯迪拉克",leibie:"美国",parent:"江铃"},{name:"路虎",leibie:"英国",parent:""},{name:"玛莎拉蒂",leibie:"意大利",parent:""},{name:"马自达",leibie:"日本",parent:""},{name:"尼桑",leibie:"日本",parent:""},{name:"欧曼",leibie:"其他",parent:""},{name:"荣威",leibie:"中国",parent:""},{name:"三菱",leibie:"日本",parent:""},{name:"尚酷",leibie:"德国",parent:"大众"},{name:"斯柯达",leibie:"德国",parent:""},{name:"索兰托",leibie:"韩国",parent:"起亚"},{name:"特斯拉",leibie:"美国",parent:""},{name:"沃尔沃",leibie:"瑞典",parent:""},{name:"五菱",leibie:"中国",parent:""},{name:"现代",leibie:"韩国",parent:""},{name:"雪佛兰",leibie:"美国",parent:""},{name:"雅阁",leibie:"日本",parent:"本田"},{name:"缤智",leibie:"日本",parent:"本田"},{name:"英菲尼迪",leibie:"日本",parent:""},{name:"中华",leibie:"中国",parent:""},{name:"中骏",leibie:"中国",parent:""},{name:"中联",leibie:"中国",parent:""},{name:"东风",leibie:"中国",parent:""},{name:"克莱斯勒",leibie:"美国",parent:""},{name:"北京",leibie:"中国",parent:""},{name:"长城",leibie:"中国",parent:""},{name:"奥铃",leibie:"中国",parent:"福田"},{name:"海马",leibie:"中国",parent:""},{name:"红旗",leibie:"中国",parent:""},{name:"几何",leibie:"中国",parent:"吉利"},{name:"庆铃",leibie:"中国",parent:""},{name:"思威",leibie:"日本",parent:"本田"},{name:"腾势",leibie:"其他",parent:""},{name:"翼虎",leibie:"中国",parent:"长安"},{name:"欧拉",leibie:"中国",parent:"长城"},{name:"远程",leibie:"中国",parent:"吉利"},{name:"圣玛托",leibie:"美国",parent:""},{name:"捷途",leibie:"中国",parent:"奇瑞"},{name:"长城风骏7",leibie:"中国",parent:"长城"}],Fe=e=>{let t="无品牌类别",a=()=>{let a=[];return null!=e.value&&e.value.length>0&&(a=e.value.split("\n")),a.length>0&&(a=a.filter((e=>null!=e&&e.length>0))),0==a.length?[]:a.map((e=>{let a=e.split("\t"),l={};l.date=a[0]&&a[0].trim()||"无日期",l.dingsunyuan=a[1]&&a[1].trim()||"无定损员",l.xiaoshouyuan=a[2]&&a[2].trim()||"无销售员",l.chepai=a[3]&&a[3].trim()||"车牌",l.pinpai=a[4]&&a[4].trim()||"品牌",l.isChengJiao=!(!a[5]||"是"!=a[5].trim()),l.jine=a[6]&&parseInt(a[6].trim())||0,l.pinpai_leibie=t;try{"品牌"!=l.pinpai&&(l.pinpai_leibie=(n=l.pinpai,ze.filter((e=>e.name==n||e.parent==n)))[0].leibie)}catch(r){console.error(l,r)}var n;return l}))};const l=P((()=>a())),n=P((()=>{let e=0;return l.value&&l.value.length>0&&l.value.forEach((t=>{isNaN(t.jine)||(e+=t.jine)})),e})),r=P((()=>l.value&&l.value.length>0?l.value.filter((e=>e.pinpai_leibie==t)):[])),i=P((()=>{let e=0,t=[];return l.value&&l.value.length>0&&(t=l.value.filter((t=>!!t.isChengJiao&&(e+=t.jine,!0)))),{list:t,totalAmount:e}}));return{dataList:l,totalAmount:n,chengJiaoData:i,noPinPaiDataList:r}},$e=T({name:"TongJi",components:{TotalAnalyse:Pe,PinPaiAnalyse:je,DingSunYuanAnalyse:Ee,XiaoShouYuanAnalyse:Ce,NoPinPaiList:Me},setup(){const e={date:"日期",dingsunyuan:"定损员",xiaoshouyuan:"销售员",chepai:"车牌",pinpai:"品牌",isChengJiao:"是否成交",jine:"金额",pinpai_leibie:"品牌类别"},t=H(""),{dataList:a,totalAmount:l,chengJiaoData:n,noPinPaiDataList:r}=Fe(t);return Q("dataList",a),Q("totalAmount",l),Q("chengJiaoData",n),Q("noPinPaiList",r),{headTableItem:e,content:t,dataList:a,totalAmount:l,chengJiaoData:n}}}),qe={style:{width:"100%"}};const Ke=xe($e,[["render",function(e,t,a,l,n,r){const u=i,d=o,p=Me,c=Pe,m=Ee,h=s,g=Ce,f=je;return L(),$(Y,null,[N(d,null,{default:J((()=>[M("table",qe,[M("tr",null,[(L(!0),$(Y,null,q(e.headTableItem,((e,t)=>(L(),$("th",{key:t},X(e),1)))),128))])]),N(u,{modelValue:e.content,"onUpdate:modelValue":t[0]||(t[0]=t=>e.content=t),rows:22,type:"textarea",placeholder:"请复制数据至此"},null,8,["modelValue"])])),_:1}),N(d,null,{default:J((()=>[N(p)])),_:1}),N(d,{gutter:10},{default:J((()=>[N(h,{span:12},{default:J((()=>[N(c),N(m)])),_:1}),N(h,{span:12},{default:J((()=>[N(g),N(f)])),_:1})])),_:1})],64)}]]),Xe=e=>(G("data-v-e82166c8"),e=e(),B(),e),Ye={class:"card-header"},Ge=Xe((()=>M("span",{style:{color:"var(--el-color-info)"}},"点击可自动复制",-1))),Be=Xe((()=>M("span",null,"计算后结果",-1))),He=Xe((()=>M("span",null,"结果",-1))),Qe=xe(T({__name:"result",props:{showComputedList:Array,totalCount:[Number,String],showList:Array,region:String},setup(e){const{toClipboard:t}=oe(),a=H("https://docs.qq.com/sheet/DS0FkVVhwd29KdHNk"),l=async e=>{try{if(null==e)return;let a=Array.isArray(e)&&e.join("\n")||e.toString();await t(a),u({message:"复制成功",type:"success"})}catch(a){console.error(a),u.error(a.message||"真奇怪，不知道哪里错了。")}};return(t,r)=>{const i=d,u=s,p=o,c=n;return L(),$("div",null,[N(c,null,{header:J((()=>[M("div",Ye,[Ge,N(i,{type:"primary",href:W(a),target:"_blank"},{default:J((()=>[K("打开腾讯文档")])),_:1},8,["href"])])])),default:J((()=>[N(p,{gutter:10},{default:J((()=>[N(u,{span:10},{default:J((()=>[Z(t.$slots,"default",{},void 0,!0)])),_:3}),N(u,{span:14,onClick:r[0]||(r[0]=t=>l(e.totalCount))},{default:J((()=>[K(" 总计："+X(e.totalCount),1)])),_:1})])),_:3})])),_:3}),N(p,null,{default:J((()=>[N(u,{span:16},{default:J((()=>[N(c,{onClick:r[1]||(r[1]=t=>l(e.showComputedList))},{header:J((()=>[Be])),default:J((()=>[(L(!0),$(Y,null,q(e.showComputedList,((e,t)=>(L(),$("div",{key:t},X(e),1)))),128))])),_:1})])),_:1}),N(u,{span:8},{default:J((()=>[N(c,{onClick:r[2]||(r[2]=t=>l(e.showList))},{header:J((()=>[He])),default:J((()=>[(L(!0),$(Y,null,q(e.showList,((e,t)=>(L(),$("div",{key:t},X(e),1)))),128))])),_:1})])),_:1})])),_:1})])}}}),[["__scopeId","data-v-e82166c8"]]),We={class:"upload-wapper"},Ze={class:"el-image"},et=["src"],tt={class:"tips"},at=M("small",{style:{color:"var(--el-text-color-disabled)"}},"图片可缩放，也可移动",-1),lt=M("div",{class:"el-upload__text"},"拖拽或上传文件",-1),nt=T({__name:"upload",setup(e){const t=H(),a=H(""),l=H(1),n=H(1);H(null);const{handleMousedown:r,handleMousemove:i,handleMouseup:o,translate:s,init:u}=(()=>{const e={x:0,y:0},t=ee({x:0,y:0});let a=!1;return{handleMousedown:t=>{a=!0,e.x=t.clientX,e.y=t.clientY,t.preventDefault()},handleMousemove:l=>(a&&(t.x=l.clientX-e.x,t.y=l.clientY-e.y),!1),handleMouseup:e=>{a=!1},translate:t,init:()=>{t.x=0,t.y=0}}})(),d=e=>{e&&e.hasOwnProperty("url")&&(a.value=e.url||"")},m=()=>{n.value=1,u()},h=e=>{t.value.clearFiles();const a=e[0];a.uid=+new Date,t.value.handleStart(a)},g=e=>(e.deltaY<0?n.value<2?n.value+=.2:n.value=2:e.deltaY>0&&(n.value>.4?n.value-=.2:n.value=.4),!1);return(e,u)=>{const f=p,_=c;return L(),$("div",We,[M("div",Ze,[M("img",{src:W(a),onWheel:g,onMousemove:u[0]||(u[0]=(...e)=>W(i)&&W(i)(...e)),onMousedown:u[1]||(u[1]=(...e)=>W(r)&&W(r)(...e)),onMouseup:u[2]||(u[2]=(...e)=>W(o)&&W(o)(...e)),style:te({transform:"scale("+W(n)+") translate("+W(s).x+"px, "+W(s).y+"px)","object-fit":"contain"}),class:"el-image__inner"},null,44,et)]),M("p",tt,[at,M("span",{onClick:m},[K("图片还原"),N(f,null,{default:J((()=>[N(W(ce))])),_:1})])]),N(_,{action:"#",drag:"",ref_key:"upload",ref:t,"auto-upload":!1,limit:W(l),"list-type":"picture","on-change":d,"on-exceed":h},{default:J((()=>[N(f,{class:"el-icon--upload"},{default:J((()=>[N(W(me))])),_:1}),lt])),_:1},8,["limit"])])}}}),rt=M("legend",null,"分隔符：",-1),it=T({__name:"index",setup(e){const t=H(""),a=H(["请在此输入输入","一行一组","以空格相格","例如：","123 32 23 3","56 65 45 3","234 42 34 6"].join("\n")),l={SPACE:{label:"空格",value:" "},X:{label:"X;",value:"X"}},n=H(""),r=H(l.SPACE.value);let u=P((()=>{let e=t.value.trim();if(!e)return[];let a=e.split("\n");return a&&0!=a.length?(a[0].includes(l.X.value)?r.value=l.X.value:r.value=l.SPACE.value,a.map((e=>{let t=function(e,t){if(t==l.SPACE.value)return e.trim().split(t);if(t==l.X.value){let a=e.trim().split(t),l=a[2].split(";");return[a[0],a[1],l[0],l[1]]}}(e,r.value);return{len:t[0],width:t[1],height:t[2],count:t[3]}}))):[]})),d=P((()=>u.value.map((e=>e.len+"X"+e.width+"X"+e.height+";"+e.count)))),p=P((()=>u.value.map((e=>e.len+"X"+e.width+"X"+e.height+"X"+e.count+"="+e.len*e.width*e.height*e.count)))),c=P((()=>{let e=0;return u.value.forEach((t=>{e+=t.len*t.width*t.height*t.count})),e}));return(e,u)=>{const g=i,f=s,_=m,b=h,y=o;return L(),E(y,{gutter:20},{default:J((()=>[N(f,{span:10},{default:J((()=>[N(Qe,{"total-count":W(c),"show-computed-list":W(p),"show-list":W(d),region:W(n)},{default:J((()=>[N(g,{modelValue:W(n),"onUpdate:modelValue":u[0]||(u[0]=e=>ae(n)?n.value=e:null),placeholder:"请输入地区"},{prepend:J((()=>[K("地区")])),_:1},8,["modelValue"])])),_:1},8,["total-count","show-computed-list","show-list","region"])])),_:1}),N(f,{span:4},{default:J((()=>[M("fieldset",null,[rt,N(b,{modelValue:W(r),"onUpdate:modelValue":u[1]||(u[1]=e=>ae(r)?r.value=e:null)},{default:J((()=>[(L(),$(Y,null,q(l,(e=>N(_,{label:e.value,size:"small",border:""},{default:J((()=>[K(X(e.label),1)])),_:2},1032,["label"]))),64))])),_:1},8,["modelValue"])]),N(g,{modelValue:W(t),"onUpdate:modelValue":u[2]||(u[2]=e=>ae(t)?t.value=e:null),rows:20,type:"textarea",placeholder:W(a),style:{"font-size":"large"}},null,8,["modelValue","placeholder"])])),_:1}),N(f,{span:10},{default:J((()=>[N(nt)])),_:1})])),_:1})}}}),ot="3.0.1",st={class:"version"},ut=xe(T({__name:"index",setup(e){const t=H(ot);return(e,a)=>(L(),$("div",st,X(W(t)),1))}}),[["__scopeId","data-v-4d911824"]]),dt=xe(T({__name:"AsideRouter",setup(e){const t=se().getRoutes().filter((e=>!e.meta.menuHidden));return(e,a)=>{const l=U("router-link");return L(),$("div",null,[(L(!0),$(Y,null,q(W(t),(e=>(L(),E(l,{to:e.path,key:e.path,class:"link"},{default:J((()=>[K(X(e.meta.title),1)])),_:2},1032,["to"])))),128))])}}}),[["__scopeId","data-v-7023f654"]]),pt={},ct={style:{float:"right",cursor:"pointer"},href:"https://gitee.com/hzsn-csh/sn-tools",target:"_blank"},mt=[M("img",{alt:"Gitee",src:"/sn-tools/img/logo-gitee-g.svg",title:"Gitee — 基于 Git 的代码托管和研发协作平台",style:{height:"36px","margin-top":"12px"}},null,-1)];const ht=xe(pt,[["render",function(e,t){return L(),$("a",ct,mt)}]]);const gt=xe({},[["render",function(e,t){const a=ht,l=g,n=dt,r=ut,i=f,o=U("router-view"),s=_,u=b;return L(),E(u,null,{default:J((()=>[N(l,null,{default:J((()=>[K("小工具"),N(a)])),_:1}),N(u,{class:"container"},{default:J((()=>[N(i,{width:"200px"},{default:J((()=>[N(n),N(r)])),_:1}),N(s,null,{default:J((()=>[N(o)])),_:1})])),_:1})])),_:1})}],["__scopeId","data-v-4658b423"]]);const ft=xe({},[["render",function(e,t){const a=U("router-link"),l=n,r=s,i=o;return L(),E(i,{gutter:20},{default:J((()=>[N(r,{span:6},{default:J((()=>[N(l,null,{header:J((()=>[K("体积计算")])),default:J((()=>[N(a,{to:"/volume"},{default:J((()=>[K("体积计算")])),_:1})])),_:1})])),_:1}),N(r,{span:6},{default:J((()=>[N(l,null,{header:J((()=>[K("品牌统计")])),default:J((()=>[N(a,{to:"/tongji"},{default:J((()=>[K("品牌统计")])),_:1})])),_:1})])),_:1}),N(r,{span:6},{default:J((()=>[N(l,null,{header:J((()=>[K("鼎能面单")])),default:J((()=>[N(a,{to:"/dingnengorder"},{default:J((()=>[K("鼎能面单")])),_:1})])),_:1})])),_:1})])),_:1})}]]);const _t=xe({},[["render",function(e,t){const a=y,l=U("router-link"),n=v;return L(),E(n,{icon:"error",title:"404","sub-title":"not found"},{extra:J((()=>[N(l,{to:"/"},{default:J((()=>[N(a,{type:"primary"},{default:J((()=>[K("回首页")])),_:1})])),_:1})])),_:1})}]]),bt={sender:[{required:!0,message:"请输入发货人",trigger:"blur"}],sender_phone:[{required:!0,message:"请输入发货人电话",trigger:"blur"}],recipient_company:[{required:!0,message:"请输入收货单位",trigger:"blur"}],recipient:[{required:!0,message:"请输入收货人",trigger:"blur"}],recipient_phone:[{required:!0,message:"请输入收货人电话",trigger:"blur"}],address:[{required:!0,message:"请输入收货地址",trigger:"blur"}],send_time:[{required:!0,message:"请输入发运时间",trigger:"change"}],recipient_time:[{required:!0,message:"请输入收货时间",trigger:"change"}],total_volume:[{type:"number",required:!0,message:"请输入总体积，数字类型",trigger:"blur"}],total_weight:[{type:"number",required:!0,message:"请输入总重量，数字类型",trigger:"blur"}],delivery_user:[{required:!0,message:"请输入提货人",trigger:"blur"}],remark:[]},yt=[{key:"zhixiang",value:0,text:"纸箱"},{key:"muxiang",value:0,text:"木箱"},{key:"tiejian",value:0,text:"铁件"},{key:"qita",value:0,text:"其他"}],vt=ge("dingnengOrder",{state:()=>({dn_order_id:"",sender:"",sender_phone:"",recipient_company:"",recipient:"",recipient_phone:"",address:"",goodsList:[],send_time:0,recipient_time:0,total_volume:0,total_weight:0,delivery_user:"",remark:""}),getters:{total_count:e=>{let t=0;return e.goodsList.forEach((e=>{t+=e.value})),t}},actions:{createDNOrderId:()=>"DN"+(new Date).getTime()+Math.floor(1e3*Math.random()),getGoodsList:()=>Object.assign([],yt).map((e=>(e.value=0,e))),getFromStorage:()=>({sender:localStorage.getItem("sender")||"",sender_phone:localStorage.getItem("sender_phone")||"",delivery_user:localStorage.getItem("delivery_user")||""}),saveToStorage(){localStorage.setItem("sender",this.sender),localStorage.setItem("sender_phone",this.sender_phone),localStorage.setItem("delivery_user",this.delivery_user)},init(){this.$reset(),this.goodsList=this.getGoodsList(),this.dn_order_id=this.createDNOrderId();let e=this.getFromStorage();this.sender=e.sender,this.sender_phone=e.sender_phone,this.delivery_user=e.delivery_user,this.send_time=+new Date,this.recipient_time=+new Date}}}),xt={style:{width:"600px",margin:"auto"}},wt=M("h3",{style:{"text-align":"center",color:"var(--el-text-color-primary)"}},"创建面单",-1),Vt=T({__name:"create",setup(e){const t=H(),a=vt();a.init();const l=a.$state,n=se(),r=async()=>{t&&await t.value.validate((e=>{e&&(a.saveToStorage(),n.push({name:"dingnengOrderPrint"}))}))},u=()=>{t&&a.init()};return(e,a)=>{const n=i,d=w,p=s,c=o,m=V,h=k,g=y,f=x;return L(),$("div",xt,[wt,N(f,{ref_key:"elFormRef",ref:t,model:W(l),rules:W(bt),"label-width":"100px"},{default:J((()=>[N(c,null,{default:J((()=>[N(p,{span:12},{default:J((()=>[N(d,{label:"发货人",prop:"sender"},{default:J((()=>[N(n,{modelValue:W(l).sender,"onUpdate:modelValue":a[0]||(a[0]=e=>W(l).sender=e),placeholder:"请输入发货人",clearable:"",style:{width:"100%"}},null,8,["modelValue"])])),_:1})])),_:1}),N(p,{span:12},{default:J((()=>[N(d,{label:"发货人电话",prop:"sender_phone"},{default:J((()=>[N(n,{modelValue:W(l).sender_phone,"onUpdate:modelValue":a[1]||(a[1]=e=>W(l).sender_phone=e),placeholder:"请输入发货人电话",clearable:"",style:{width:"100%"}},null,8,["modelValue"])])),_:1})])),_:1})])),_:1}),N(d,{label:"收货单位",prop:"recipient_company"},{default:J((()=>[N(n,{modelValue:W(l).recipient_company,"onUpdate:modelValue":a[2]||(a[2]=e=>W(l).recipient_company=e),placeholder:"请输入收货单位",clearable:"",style:{width:"100%"}},null,8,["modelValue"])])),_:1}),N(c,null,{default:J((()=>[N(p,{span:12},{default:J((()=>[N(d,{label:"收货人",prop:"recipient"},{default:J((()=>[N(n,{modelValue:W(l).recipient,"onUpdate:modelValue":a[3]||(a[3]=e=>W(l).recipient=e),placeholder:"请输入收货人",clearable:"",style:{width:"100%"}},null,8,["modelValue"])])),_:1})])),_:1}),N(p,{span:12},{default:J((()=>[N(d,{label:"收货人电话",prop:"recipient_phone"},{default:J((()=>[N(n,{modelValue:W(l).recipient_phone,"onUpdate:modelValue":a[4]||(a[4]=e=>W(l).recipient_phone=e),placeholder:"请输入收货人电话",clearable:"",style:{width:"100%"}},null,8,["modelValue"])])),_:1})])),_:1})])),_:1}),N(d,{label:"收货地址",prop:"address"},{default:J((()=>[N(n,{modelValue:W(l).address,"onUpdate:modelValue":a[5]||(a[5]=e=>W(l).address=e),placeholder:"请输入收货地址",clearable:"",style:{width:"100%"}},null,8,["modelValue"])])),_:1}),N(c,null,{default:J((()=>[(L(!0),$(Y,null,q(W(l).goodsList,((e,t)=>(L(),E(p,{span:12,key:e.key},{default:J((()=>[N(d,{label:e.text},{default:J((()=>[N(m,{modelValue:e.value,"onUpdate:modelValue":t=>e.value=t,placeholder:"请输入"+e.text,step:1,max:1e3},null,8,["modelValue","onUpdate:modelValue","placeholder"])])),_:2},1032,["label"])])),_:2},1024)))),128))])),_:1}),N(c,null,{default:J((()=>[N(p,{span:12},{default:J((()=>[N(d,{label:"发运时间",prop:"send_time"},{default:J((()=>[N(h,{type:"datetime",modelValue:W(l).send_time,"onUpdate:modelValue":a[6]||(a[6]=e=>W(l).send_time=e),placeholder:"请输入发运时间",clearable:"","value-format":"x"},null,8,["modelValue"])])),_:1})])),_:1}),N(p,{span:12},{default:J((()=>[N(d,{label:"收货时间",prop:"recipient_time"},{default:J((()=>[N(h,{type:"datetime",modelValue:W(l).recipient_time,"onUpdate:modelValue":a[7]||(a[7]=e=>W(l).recipient_time=e),placeholder:"请输入收货时间",clearable:"","value-format":"x"},null,8,["modelValue"])])),_:1})])),_:1})])),_:1}),N(c,null,{default:J((()=>[N(p,{span:12},{default:J((()=>[N(d,{label:"总体积",prop:"total_volume"},{default:J((()=>[N(n,{modelValue:W(l).total_volume,"onUpdate:modelValue":a[8]||(a[8]=e=>W(l).total_volume=e),modelModifiers:{number:!0},placeholder:"请输入总体积",clearable:"",style:{width:"100%"}},{append:J((()=>[K("m³")])),_:1},8,["modelValue"])])),_:1})])),_:1}),N(p,{span:12},{default:J((()=>[N(d,{label:"总重量",prop:"total_weight"},{default:J((()=>[N(n,{modelValue:W(l).total_weight,"onUpdate:modelValue":a[9]||(a[9]=e=>W(l).total_weight=e),modelModifiers:{number:!0},placeholder:"请输入总重量",clearable:""},{append:J((()=>[K("KG")])),_:1},8,["modelValue"])])),_:1})])),_:1})])),_:1}),N(d,{label:"提货人",prop:"delivery_user"},{default:J((()=>[N(n,{modelValue:W(l).delivery_user,"onUpdate:modelValue":a[10]||(a[10]=e=>W(l).delivery_user=e),placeholder:"请输入提货人",clearable:"",style:{width:"100%"}},null,8,["modelValue"])])),_:1}),N(d,{label:"备注",prop:"remark"},{default:J((()=>[N(n,{modelValue:W(l).remark,"onUpdate:modelValue":a[11]||(a[11]=e=>W(l).remark=e),type:"textarea",placeholder:"请输入备注",autosize:{minRows:4,maxRows:4},style:{width:"100%"}},null,8,["modelValue"])])),_:1}),N(d,{size:"large"},{default:J((()=>[N(g,{type:"primary",onClick:r},{default:J((()=>[K("打印")])),_:1}),N(g,{onClick:u},{default:J((()=>[K("重置")])),_:1})])),_:1})])),_:1},8,["model","rules"])])}}}),kt=ge("dingnengSettings",(()=>{const e="printFontSize",t=()=>{const t=localStorage.getItem(e);return console.log("getFromStorage",t),null==t||null==t?1:parseFloat(t)},a=t(),l=H(a);return{fontSize:l,getFromStorage:t,saveToStorage:()=>{localStorage.setItem(e,""+l.value)}}})),St=T({__name:"barcode",props:{code:{type:String,required:!0}},setup(e){const{code:t}=e,a=H(null);R((()=>{a.value&&l(a.value,t)}));const l=(e,t)=>{ue(e,t,{displayValue:!1,height:60})};return(e,t)=>(L(),$("svg",{ref_key:"barcodeRef",ref:a},null,512))}}),jt=e=>(G("data-v-a92fa01f"),e=e(),B(),e),It=jt((()=>M("div",{class:"order-header"},[M("img",{height:"40",width:"40",src:"/sn-tools/img/dingneng.png"}),M("span",null,"杭州鼎能供应链发运单")],-1))),Dt={style:{margin:"10px 0 0 0"}},Ct={style:{"text-align":"center"}},At={colspan:"3"},Tt={colspan:"2"},Lt={colspan:"5"},Et={colspan:"3"},Jt={colspan:"2"},Nt={colspan:"5"},Ut=jt((()=>M("tr",null,[M("td",{colspan:"5",style:{"text-align":"center",padding:"10px 0px","font-size":"1.12em"}}," 货物详情 ")],-1))),Pt=jt((()=>M("td",{style:{"text-align":"center"}},"合计",-1))),Ot={style:{"text-align":"center"}},Rt={colspan:"3"},Mt={colspan:"2"},zt={colspan:"5"},Ft={colspan:"3"},$t=jt((()=>M("td",{colspan:"2"},"签收人：",-1))),qt={colspan:"5"},Kt={style:{border:"none"}},Xt={colspan:"5"},Yt={class:"other-wapper"},Gt={class:"print-btn-wapper"},Bt={class:"print-btn-wapper"},Ht={class:"print-btn-wapper"},Qt=xe(T({__name:"print",setup(e){const t=se(),a=vt(),l=kt(),n=a.$state,r=H(!1),{fontSize:i}=fe(l),o=e=>{l.saveToStorage()},s=P((()=>{let e=new Date(n.send_time);return e.getFullYear()+"年"+(e.getMonth()+1)+"月"+e.getDate()+"日"})),u=P((()=>{let e=new Date(n.recipient_time);return e.getFullYear()+"年"+(e.getMonth()+1)+"月"+e.getDate()+"日"})),d=()=>{r.value=!0,t.back()},p=()=>{window.print()};return(e,t)=>{const l=V,c=y;return L(),$(Y,null,[M("div",{class:"order-wapper print",style:te({fontSize:W(i)+"em"})},[It,M("p",Dt,"运单号："+X(W(n).dn_order_id),1),M("div",Ct,[N(St,{code:W(n).dn_order_id},null,8,["code"])]),M("table",null,[M("tbody",null,[M("tr",null,[M("td",At,"发货人："+X(W(n).sender),1),M("td",Tt,"电话："+X(W(n).sender_phone),1)]),M("tr",null,[M("td",Lt,"收货单位："+X(W(n).recipient_company),1)]),M("tr",null,[M("td",Et,"收货人："+X(W(n).recipient),1),M("td",Jt,"电话："+X(W(n).recipient_phone),1)]),M("tr",null,[M("td",Nt,"收货地址："+X(W(n).address),1)]),Ut,M("tr",null,[(L(!0),$(Y,null,q(W(n).goodsList,(e=>(L(),$("td",{class:"border-right",key:e.key},X(e.text),1)))),128)),Pt]),M("tr",null,[(L(!0),$(Y,null,q(W(n).goodsList,(e=>(L(),$("td",{class:"border-right",key:e.key},X(e.value),1)))),128)),M("td",Ot,X(W(a).total_count),1)]),M("tr",null,[M("td",Rt,"体积："+X(W(n).total_volume)+" m³",1),M("td",Mt,"重量："+X(W(n).total_weight)+" KG",1)]),M("tr",null,[M("td",zt,"发运时间："+X(W(s)),1)]),M("tr",null,[M("td",Ft,"提货人："+X(W(n).delivery_user),1),$t]),M("tr",null,[M("td",qt,"日期："+X(W(u)),1)]),M("tr",Kt,[M("td",Xt,"备注："+X(W(n).remark),1)])])])],4),M("div",Yt,[M("div",Gt,[N(l,{modelValue:W(i),"onUpdate:modelValue":t[0]||(t[0]=e=>ae(i)?i.value=e:null),precision:2,step:.1,min:1,max:2,onChange:o,style:{width:"200px","margin-left":"74px"}},null,8,["modelValue","step"])]),M("div",Bt,[N(c,{type:"primary",class:"print-btn",onClick:p},{default:J((()=>[K("打印")])),_:1})]),M("div",Ht,[N(c,{onClick:d,loading:W(r)},{default:J((()=>[K("返回")])),_:1},8,["loading"])])])],64)}}}),[["__scopeId","data-v-a92fa01f"]]),Wt=[{id:57,text:"陆放",label:"kluger"},{id:38,text:"荣放",label:"rav4"}],Zt={index:-1,label:"全部"},ea="city",ta="username",aa="phone",la="series_id",na="dealer_id",ra="company",ia="order_at";var oa=(e=>(e[e.DATA=0]="DATA",e[e.SERIES=1]="SERIES",e))(oa||{});const sa={data:{id:0,text:"数据"},seriesData:{id:1,text:"车系资料"}},ua=[{key:"city",zhKey:"城市",index:1},{key:"username",zhKey:"姓名",index:5},{key:"phone",zhKey:"电话",index:6}],da=[{key:"dealerId",zhKey:"经销商编码",index:0},{key:"name",zhKey:"经销商名称",index:1},{key:"city",zhKey:"城市",index:2}],pa={hour:[9,10,11,12,13,14,15,16,17,18,19,20,21,22],weight:[9,6,3,2,1,3,4,3,3,8,8,4,2,1]},ca=pa.weight.reduce(((e,t)=>e+t)),ma={class:"title"},ha=xe(T({__name:"RadioTitle",props:{text:{type:String,default:"项"}},setup:e=>(t,a)=>(L(),$("span",ma,X(e.text),1))}),[["__scopeId","data-v-9b2e10e3"]]),ga={class:"dialog-footer"},fa=T({__name:"SheetDialog",props:{sheetIndex:{type:Number,default:Zt.index},visible:{type:Boolean,default:!1},fileName:{type:String},sheetNames:{type:Array,default:[]}},emits:["update:sheetIndex","update:visible","select"],setup(e,{emit:t}){const a=e,l=P({get:()=>[Zt,...a.sheetNames.map(((e,t)=>({index:t,label:e})))],set(e){console.log(e)}}),n=P({get:()=>a.sheetIndex,set(e){t("update:sheetIndex",e)}}),r=P({get:()=>a.visible,set(e){t("update:visible",e)}}),i=e=>{t("update:sheetIndex",e)},o=()=>{r.value=!1,t("select",a.sheetIndex)};return(t,a)=>{const s=m,u=h,d=y,p=S;return L(),E(p,{modelValue:W(r),"onUpdate:modelValue":a[2]||(a[2]=e=>ae(r)?r.value=e:null),title:"选择Sheet"},{footer:J((()=>[M("span",ga,[N(d,{onClick:a[1]||(a[1]=e=>r.value=!1)},{default:J((()=>[K("取消")])),_:1}),N(d,{type:"primary",onClick:o},{default:J((()=>[K(" 确定 ")])),_:1})])])),default:J((()=>[M("p",null,X(e.fileName),1),N(ha,{text:"Sheet"}),N(u,{modelValue:W(n),"onUpdate:modelValue":a[0]||(a[0]=e=>ae(n)?n.value=e:null),onChange:i},{default:J((()=>[(L(!0),$(Y,null,q(W(l),(e=>(L(),E(s,{label:e.index,border:""},{default:J((()=>[K(X(e.label),1)])),_:2},1032,["label"])))),256))])),_:1},8,["modelValue"])])),_:1},8,["modelValue"])}}}),_a="application/vnd.openxmlformats-officedocument.spreadsheetml.sheet",ba=M("div",{class:"el-upload__text"},[K(" Drop file here or "),M("em",null,"click to upload")],-1),ya=T({__name:"SnUpload",emits:["change"],setup(e,{emit:t}){const a=H(),{valiteFile:l,handleExceed:n,acceptType:r}=(e=>({valiteFile:(e,t)=>{let a=e.raw;if(a){if(a.type==_a)return!0;u({type:"warning",message:"附件格式错误，请删除后重新上传！"})}else u({type:"warning",message:"请上传附件！"});return!1},handleExceed:t=>{e.value.clearFiles();const a=t[0];a.uid=Date.now(),e.value.handleStart(a)},acceptType:_a}))(a),i=(e,a)=>{l(e,a)&&e.raw&&t("change",e.raw)};return(e,t)=>{const l=p;return L(),E(W(c),{drag:"",ref_key:"uploadRef",ref:a,action:"","on-change":i,"on-exceed":W(n),limit:1,accept:W(r),"auto-upload":!1},{default:J((()=>[N(l,{class:"el-icon--upload"},{default:J((()=>[N(W(he))])),_:1}),ba])),_:1},8,["on-exceed","accept"])}}});function va(e,t){return e=Math.ceil(e),t=Math.floor(t),Math.floor(Math.random()*(t-e))+e}function xa(e){return e<10&&"0"+e||e}function wa(e){return e.label+e.id}function Va(e){let t=localStorage.getItem(wa(e));return t&&JSON.parse(t)||[]}const ka=/^(0|86|17951)?(13[0-9]|14[01456789]|15[012356789]|16[2567]|17[235678]|18[0-9]|19[012356789])[0-9]{8}$/;const Sa=ge("ftmsStore",(()=>{let e=new Date;const t=H([new Date(e.getFullYear(),e.getMonth(),e.getDate()-1,18),new Date(e.getFullYear(),e.getMonth(),e.getDate(),17,30,0)]),a=ee(sa),l=ee({[Wt[0].label]:Va(Wt[0]),[Wt[1].label]:Va(Wt[1])});return{dateTime:t,uploadTypeRadioKeyList:a,seriesList:l,saveSeries:function(e,t){localStorage.setItem(wa(t),JSON.stringify(e)),l[t.label]=e},hasSeriesData:function(e){return l[e.label].length>0}}})),ja={style:{"margin-bottom":"20px"}},Ia=xe(T({__name:"UploadTypeRadio",props:["modelValue"],emits:["update:modelValue"],setup(e,{emit:t}){const a=e,{uploadTypeRadioKeyList:l}=Sa(),n=P({get:()=>a.modelValue,set:e=>t("update:modelValue",e)});return(e,t)=>{const a=j,r=h;return L(),$("div",ja,[N(ha,{text:"数据类型"}),N(r,{modelValue:W(n),"onUpdate:modelValue":t[0]||(t[0]=e=>ae(n)?n.value=e:null)},{default:J((()=>[(L(!0),$(Y,null,q(W(l),(e=>(L(),E(a,{label:e.id,border:""},{default:J((()=>[K(X(e.text),1)])),_:2},1032,["label"])))),256))])),_:1},8,["modelValue"])])}}}),[["__scopeId","data-v-d5ddec6c"]]),Da=T({__name:"TipDescription",setup(e){const{seriesList:t}=fe(Sa()),a=P((()=>({label:Wt[0].text,desc:`${t.value[Wt[0].label].length}条`}))),l=P((()=>({label:Wt[1].text,desc:`${t.value[Wt[1].label].length}条`})));return(e,t)=>{const n=I,r=D;return L(),E(r,{border:"",title:"车系资料"},{default:J((()=>[N(n,{"label-align":"right",align:"center",label:W(a).label},{default:J((()=>[K(X(W(a).desc),1)])),_:1},8,["label"]),N(n,{"label-align":"right",align:"center",label:W(l).label},{default:J((()=>[K(X(W(l).desc),1)])),_:1},8,["label"])])),_:1})}}}),Ca=T({__name:"SnForm",setup(e){const{dateTime:t}=fe(Sa());return(e,a)=>{const l=k,n=w,r=x;return L(),E(r,{inline:!0,class:"demo-form-inline"},{default:J((()=>[N(n,{label:"时间范围"},{default:J((()=>[N(l,{modelValue:W(t),"onUpdate:modelValue":a[0]||(a[0]=e=>ae(t)?t.value=e:null),type:"datetimerange","range-separator":"至","start-placeholder":"Start date","end-placeholder":"End date"},null,8,["modelValue"])])),_:1})])),_:1})}}}),Aa=xe(T({__name:"TipAlert",setup(e){const{seriesList:t}=fe(Sa()),a=H(!1),l=P((()=>{let e=0==t.value[Wt[0].label].length;return{title:`${Wt[0].text} 数据不存在`,show:e}})),n=P((()=>{let e=0==t.value[Wt[1].label].length;return{title:`${Wt[1].text} 数据不存在`,show:e}}));return(e,t)=>(L(),$(Y,null,[W(l).show?(L(),E(W(C),{key:0,title:W(l).title,type:"error",closable:W(a)},null,8,["title","closable"])):le("",!0),W(n).show?(L(),E(W(C),{key:1,title:W(n).title,type:"error",closable:W(a)},null,8,["title","closable"])):le("",!0)],64))}}),[["__scopeId","data-v-c13bbe3e"]]);const Ta=(e,t)=>{let a={};for(const l in e)if(Object.prototype.hasOwnProperty.call(e,l)){const t=e[l];a[l]=be.json_to_sheet(t)}!function(e,t){let a=URL.createObjectURL(e);var l,n=document.createElement("a");n.href=a,n.download=t||"",window.MouseEvent?l=new MouseEvent("click"):(l=document.createEvent("MouseEvents")).initMouseEvent("click",!0,!1,window,0,0,0,0,0,!1,!1,!1,!1,0,null),n.dispatchEvent(l),n.remove()}(function(e){var t={SheetNames:Object.keys(e),Sheets:{}};for(const l in e)if(Object.prototype.hasOwnProperty.call(e,l)){const a=e[l];t.Sheets[l]=a}var a=ve(t,{bookType:"xlsx",bookSST:!1,type:"binary"});return new Blob([function(e){for(var t=new ArrayBuffer(e.length),a=new Uint8Array(t),l=0;l!=e.length;++l)a[l]=255&e.charCodeAt(l);return t}(a)],{type:"application/octet-stream"})}(a),function(e,t){let a=t.lastIndexOf("."),l=1==e.length&&e[0]+"-"||"";return t.substring(0,a)+"-"+l+ +new Date+t.substring(a)}(Object.keys(a),t))};const La=(e,t,a,l,n="\t")=>{let r=e.Sheets[e.SheetNames[t]],i=be.sheet_to_txt(r).split("\n");null==l&&(l=a.find((e=>i[0].includes(e.zhKey)||i[0].includes(e.key)))?1:0);let o=[],s=0;for(let u=l;u<i.length;u++){const e=i[u].trim();if(!e){s++;continue}let t=e.split(n),l={};for(const n of a)l[n.key]=t[n.index].trim(),l[n.key].length||s++;o.push(l)}return{list:o,emptyCount:s}};function Ea(){const{dateTime:e}=Sa();let t=function(e,t){let a=va(0,t);for(let l=0;l<e.length;l++)if(a-=e[l],a<=0)return l;return 0}(pa.weight,ca),a=pa.hour[t],l=new Date(va(e[0].getTime(),e[1].getTime()));for(;l.getHours()!=a;)l=new Date(va(e[0].getTime(),e[1].getTime()));let n=l.getFullYear(),r=l.getMonth()+1,i=l.getDate(),o=xa(l.getMinutes()),s=xa(l.getSeconds());return n+"-"+xa(r)+"-"+xa(i)+" "+xa(a)+":"+o+":"+s}function Ja(e,t){let a=Wt.filter((t=>e.includes(t.text)));if(a.length>0)return a[0];if(a=Wt.filter((e=>t.includes(e.text))),a.length>0)return a[0];throw new Error("没有从文件名或sheet name 中找到车系名称")}const Na=(e,t)=>{const{seriesList:a}=fe(Sa());let l=a.value[t.label],n=e.map(((e,a)=>{let l={...e,seriesId:t.id};var n;return n=l.phone,ka.test(n.toString())||console.warn(`${a+1}:${l.phone}有误`),l})),r=new Set;n.forEach((e=>r.add(e.city)));let i={};return r.forEach((e=>{if(i[e]=l.filter((t=>t.city==e)),0==i[e].length)throw new Error(`没有该字段的车系数据：${e}`)})),function(e,t){e.forEach((e=>{let a=va(0,t[e.city].length),l=t[e.city][a];e.dealerId=l.dealerId,e.dealerName=l.name}))}(n,i),function(e){e.forEach((e=>{e.orderAt=Ea()}))}(n),n.map((e=>{let t={};return t[ea]=e.city,t[ta]=e.username,t[aa]=e.phone,t[na]=e.dealerId,t[ra]=e.dealerName,t[la]=e.seriesId,t[ia]=e.orderAt,t}))},Ua=()=>{const e=Sa(),{uploadTypeRadioKeyList:t}=fe(e),a=H(t.value.data.id),l=H(),n=ee({visible:!1,sheetNames:[],sheetIndex:Zt.index,fileName:""});ne((()=>n.fileName),(()=>n.sheetIndex=Zt.index));function r(e){if(e==oa.DATA)return ua;if(e==oa.SERIES)return da;throw new Error(`没有此类型key:${e}`)}function i(e,t){t&&u.warning(`sheet:${e} 已忽略${t}行空数据`)}return{workBook:l,sheetDialogConfig:n,openSheetDialog:(e,t)=>{n.sheetNames=t,n.visible=!0,n.fileName=e},uploadType:a,handleSheetSelect:t=>{if(!l.value)return;let o={};if(t==Zt.index){let e=l.value.SheetNames,t=r(a.value);for(let a=0;a<e.length;a++){let n=La(l.value,a,t);o[e[a]]=n.list,i(e[a],n.emptyCount)}}else{let e=La(l.value,t,r(a.value));o[l.value.SheetNames[t]]=e.list,i(l.value.SheetNames[t],e.emptyCount)}try{(t=>{const{sheetObject:a,fileName:l,uploadType:n}=t;if(n.value==oa.DATA){let t={};for(const n in a)if(Object.prototype.hasOwnProperty.call(a,n)){const r=a[n];let i=Ja(n,l);if(!e.hasSeriesData(i))throw new Error(`没有该车系的数据：${i.text} 请先上传${i.text}的数据`);t[n]=Na(r,i)}Ta(t,l)}else{if(n.value!=oa.SERIES)throw new Error("类型错误");for(const t in a)if(Object.prototype.hasOwnProperty.call(a,t)){const n=a[t];let r=Ja(t,l);e.saveSeries(n,r),u.success(`已添加${t}${n.length}条数据`)}}})({sheetObject:o,fileName:n.fileName,uploadType:a})}catch(s){console.error(s),u.error(s.message)}finally{l.value=void 0}}}},Pa=M("h2",{style:{"text-align":"center"}},"2023年1月份留资数据格式化",-1),Oa=T({__name:"index",setup(e){const{uploadType:t,sheetDialogConfig:a,openSheetDialog:l,workBook:n,handleSheetSelect:r}=Ua(),i=e=>{var t;(t=e,new Promise(((e,a)=>{let l=new FileReader;l.onload=t=>{var l;try{e(ye(null==(l=t.target)?void 0:l.result))}catch(n){a(n)}},l.readAsArrayBuffer(t)}))).then((t=>{let a=t;n.value=a,l(e.name,n.value.SheetNames)})).catch((e=>{n.value=void 0,u.error(e.message),console.error(e)}))};return(e,l)=>{const n=Aa,u=Ca,d=Da,p=s,c=Ia,m=ya,h=o,g=fa;return L(),$(Y,null,[Pa,N(n),N(h,{gutter:20},{default:J((()=>[N(p,{span:12},{default:J((()=>[N(u),N(d)])),_:1}),N(p,{span:12},{default:J((()=>[N(c,{modelValue:W(t),"onUpdate:modelValue":l[0]||(l[0]=e=>ae(t)?t.value=e:null)},null,8,["modelValue"]),N(m,{onChange:i})])),_:1})])),_:1}),N(g,{sheetIndex:W(a).sheetIndex,"onUpdate:sheetIndex":l[1]||(l[1]=e=>W(a).sheetIndex=e),visible:W(a).visible,"onUpdate:visible":l[2]||(l[2]=e=>W(a).visible=e),"sheet-names":W(a).sheetNames,onSelect:W(r),"file-name":W(a).fileName},null,8,["sheetIndex","visible","sheet-names","onSelect","file-name"])],64)}}}),Ra={PACKAGE:{code:0,text:"揽收"},TRACKING:{code:1,text:"运输中"},DELIVERY:{code:2,text:"派送中"},SIGNED:{code:3,text:"签收"}},Ma={class:"card-header"},za=T({__name:"TrackItem",props:{index:{type:Number,default:0},modelValue:{type:Object,default:{}}},emits:["delete"],setup(e){const{index:t,modelValue:a}=e,l=Object.values(Ra),r=P((()=>a)),u=e=>{var t;r.value.info||(r.value.info=(null==(t=l.find((t=>t.code==e)))?void 0:t.text)||"")};return(t,a)=>{const d=y,p=j,c=h,m=w,g=k,f=s,_=i,b=o,v=n;return L(),E(v,{class:"box-card"},{header:J((()=>[M("div",Ma,[M("span",null,"轨迹（"+X(e.index)+"）",1),N(d,{class:"button",type:"danger",text:"",onClick:a[0]||(a[0]=e=>t.$emit("delete"))},{default:J((()=>[K("删除")])),_:1})])])),default:J((()=>[N(m,{label:"状态"},{default:J((()=>[N(c,{modelValue:W(r).status,"onUpdate:modelValue":a[1]||(a[1]=e=>W(r).status=e),onChange:u},{default:J((()=>[(L(!0),$(Y,null,q(W(l),(e=>(L(),E(p,{label:e.code},{default:J((()=>[K(X(e.text)+"("+X(e.code)+")",1)])),_:2},1032,["label"])))),256))])),_:1},8,["modelValue"])])),_:1}),N(b,null,{default:J((()=>[N(f,{span:14},{default:J((()=>[N(m,{label:"时间"},{default:J((()=>[N(g,{modelValue:W(r).update_time,"onUpdate:modelValue":a[2]||(a[2]=e=>W(r).update_time=e),type:"datetime",placeholder:"更新时间","value-format":"x"},null,8,["modelValue"])])),_:1})])),_:1}),N(f,{span:10},{default:J((()=>[N(m,{label:"地点"},{default:J((()=>[N(_,{modelValue:W(r).station,"onUpdate:modelValue":a[3]||(a[3]=e=>W(r).station=e),placeholder:"地点"},null,8,["modelValue"])])),_:1})])),_:1})])),_:1}),N(m,{label:"信息"},{default:J((()=>[N(_,{modelValue:W(r).info,"onUpdate:modelValue":a[4]||(a[4]=e=>W(r).info=e),placeholder:"更新信息"},null,8,["modelValue"])])),_:1})])),_:1})}}}),Fa=[{path:"/",name:"index",component:gt,meta:{menuHidden:!0},children:[{path:"/",name:"dashboard",component:ft,meta:{title:"首页"}},{path:"/volume",name:"volume",component:it,meta:{title:"体积计算"}},{path:"/tongji",name:"tongji",component:Ke,meta:{title:"品牌统计"}},{path:"/ftms",name:"ftms",component:Oa,meta:{title:"留资数据格式化"}},{path:"/track",name:"track",component:xe(T({__name:"index",setup(e){const{dataList:t,dn_order_id:a,addItem:l,deleteAllItem:n,deleteItem:r,sortData:u}=(()=>{const e=H(""),t=ee([]);return{dataList:t,dn_order_id:e,addItem:()=>{t.push({update_time:void 0,info:"",status:-1,station:""})},deleteAllItem:()=>{t.splice(0)},deleteItem:e=>{t.splice(e,1)},sortData:()=>{t.sort(((e,t)=>e.status!=t.status?e.status-t.status:e.update_time||t.update_time?e.update_time&&t.update_time?e.update_time-t.update_time:e.update_time?-1:1:0))}}})();return(e,u)=>{const d=y,p=A,c=i,m=w,h=s,g=o,f=za,_=x;return L(),$(Y,null,[M("h2",null,[K(" 轨迹生成器"),N(d,{type:"primary",onClick:W(l),text:""},{default:J((()=>[K("新增")])),_:1},8,["onClick"]),N(p,{title:"确认删除所有？",onConfirm:W(n)},{reference:J((()=>[N(d,{type:"danger",text:""},{default:J((()=>[K("删除")])),_:1})])),_:1},8,["onConfirm"])]),N(_,{"label-width":"50px"},{default:J((()=>[N(g,{gutter:10},{default:J((()=>[N(h,{span:8},{default:J((()=>[N(m,{label:"订单号","label-width":"80px"},{default:J((()=>[N(c,{modelValue:W(a),"onUpdate:modelValue":u[0]||(u[0]=e=>ae(a)?a.value=e:null)},null,8,["modelValue"])])),_:1})])),_:1})])),_:1}),N(g,{gutter:10},{default:J((()=>[(L(!0),$(Y,null,q(W(t),((e,a)=>(L(),E(h,{class:"col",span:8},{default:J((()=>[(L(),E(f,{modelValue:W(t)[a],"onUpdate:modelValue":e=>W(t)[a]=e,index:a,onDelete:e=>W(r)(a),key:a},null,8,["modelValue","onUpdate:modelValue","index","onDelete"]))])),_:2},1024)))),256))])),_:1})])),_:1})],64)}}}),[["__scopeId","data-v-dddac8a0"]]),meta:{title:"轨迹生成器"}},{path:"dingnengorder",name:"dingnengOrder",component:Vt,meta:{title:"鼎能面单"}},{path:"/:pathMatch(.*)*",name:"NotFound",component:_t,meta:{menuHidden:!0}}]},{path:"/dingnengorder/print",name:"dingnengOrderPrint",component:Qt,meta:{menuHidden:!0}}],$a=de({history:pe(),routes:Fa}),qa=_e();re(we).use($a).use(qa).mount("#app");
