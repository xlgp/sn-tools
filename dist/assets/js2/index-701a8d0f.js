var e=Object.defineProperty,t=Object.defineProperties,a=Object.getOwnPropertyDescriptors,l=Object.getOwnPropertySymbols,n=Object.prototype.hasOwnProperty,r=Object.prototype.propertyIsEnumerable,i=(t,a,l)=>a in t?e(t,a,{enumerable:!0,configurable:!0,writable:!0,value:l}):t[a]=l;import{d as o,s,c as u}from"../js1/_pinia-86bd4ec3.js";import{j as d,K as p,L as c,ad as m,o as h,U as g,f,i as b,e as v,a as y,M as _,O as x,c as w,a6 as S,V as k,al as V,am as j,S as D,T as I,r as A,p as C,H as T,h as L,u as O,Z as E,E as J,w as P,R as N,an as M}from"../js1/_@vue-f7294240.js";import{z as R,E as U,a as z,b as F,c as q,d as K,e as X,f as Y,g as $,h as B,i as H,j as G,k as Q,l as W,m as Z,n as ee,o as te,p as ae,q as le,r as ne,s as re,t as ie,u as oe,v as se,w as ue,x as de,y as pe,A as ce,B as me,C as he}from"../js1/_element-plus-5107aa86.js";import{L as ge,M as fe,N as be,O as ve,P as ye,Q as _e,R as xe}from"../js1/__vendor-830ad3aa.js";import{y as we,q as Se,A as ke}from"../js1/_@element-plus-4bd16d9e.js";import{r as Ve,u as je,w as De}from"../js1/_xlsx-8913e6cb.js";!function(){const e=document.createElement("link").relList;if(!(e&&e.supports&&e.supports("modulepreload"))){for(const e of document.querySelectorAll('link[rel="modulepreload"]'))t(e);new MutationObserver((e=>{for(const a of e)if("childList"===a.type)for(const e of a.addedNodes)"LINK"===e.tagName&&"modulepreload"===e.rel&&t(e)})).observe(document,{childList:!0,subtree:!0})}function t(e){if(e.ep)return;e.ep=!0;const t=function(e){const t={};return e.integrity&&(t.integrity=e.integrity),e.referrerpolicy&&(t.referrerPolicy=e.referrerpolicy),"use-credentials"===e.crossorigin?t.credentials="include":"anonymous"===e.crossorigin?t.credentials="omit":t.credentials="same-origin",t}(e);fetch(e.href,t)}}();var Ie=(e,t)=>{const a=e.__vccOpts||e;for(const[l,n]of t)a[l]=n;return a};var Ae=Ie(d({name:"App",setup:()=>({zIndex:3e3,locale:R})}),[["render",function(e,t,a,l,n,r){const i=m("router-view"),o=U;return h(),p(o,{locale:e.locale,"z-index":e.zIndex},{default:c((()=>[g(i)])),_:1},8,["locale","z-index"])}]]);const Ce=[{name:"奥德赛",leibie:"日本",parent:"本田"},{name:"宝马",leibie:"德国",parent:""},{name:"北京现代",leibie:"其他",parent:""},{name:"奔驰",leibie:"德国",parent:""},{name:"奥迪",leibie:"德国",parent:""},{name:"比亚迪",leibie:"中国",parent:""},{name:"别克",leibie:"美国",parent:""},{name:"宾利",leibie:"英国",parent:""},{name:"长安",leibie:"中国",parent:""},{name:"大众",leibie:"德国",parent:""},{name:"谛艾仕",leibie:"法国",parent:""},{name:"帝豪",leibie:"中国",parent:""},{name:"东风日产",leibie:"其他",parent:""},{name:"东风天龙",leibie:"中国",parent:"吉利"},{name:"东风雪铁龙",leibie:"其他",parent:""},{name:"东风悦达起亚",leibie:"其他",parent:""},{name:"风神",leibie:"中国",parent:""},{name:"丰田",leibie:"日本",parent:""},{name:"广丰",leibie:"日本",parent:"丰田"},{name:"福特",leibie:"美国",parent:""},{name:"福田",leibie:"中国",parent:""},{name:"广汽本田",leibie:"其他",parent:""},{name:"哈弗",leibie:"中国",parent:""},{name:"江淮",leibie:"中国",parent:""},{name:"捷豹",leibie:"英国",parent:""},{name:"晶马",leibie:"中国",parent:""},{name:"凯迪拉克",leibie:"美国",parent:"江铃"},{name:"路虎",leibie:"英国",parent:""},{name:"玛莎拉蒂",leibie:"意大利",parent:""},{name:"马自达",leibie:"日本",parent:""},{name:"尼桑",leibie:"日本",parent:""},{name:"欧曼",leibie:"其他",parent:""},{name:"荣威",leibie:"中国",parent:""},{name:"三菱",leibie:"日本",parent:""},{name:"尚酷",leibie:"德国",parent:"大众"},{name:"斯柯达",leibie:"德国",parent:""},{name:"索兰托",leibie:"韩国",parent:"起亚"},{name:"特斯拉",leibie:"美国",parent:""},{name:"沃尔沃",leibie:"瑞典",parent:""},{name:"五菱",leibie:"中国",parent:""},{name:"现代",leibie:"韩国",parent:""},{name:"雪佛兰",leibie:"美国",parent:""},{name:"雅阁",leibie:"日本",parent:"本田"},{name:"缤智",leibie:"日本",parent:"本田"},{name:"英菲尼迪",leibie:"日本",parent:""},{name:"中华",leibie:"中国",parent:""},{name:"中骏",leibie:"中国",parent:""},{name:"中联",leibie:"中国",parent:""},{name:"东风",leibie:"中国",parent:""},{name:"克莱斯勒",leibie:"美国",parent:""},{name:"北京",leibie:"中国",parent:""},{name:"长城",leibie:"中国",parent:""},{name:"奥铃",leibie:"中国",parent:"福田"},{name:"海马",leibie:"中国",parent:""},{name:"红旗",leibie:"中国",parent:""},{name:"几何",leibie:"中国",parent:"吉利"},{name:"庆铃",leibie:"中国",parent:""},{name:"思威",leibie:"日本",parent:"本田"},{name:"腾势",leibie:"其他",parent:""},{name:"翼虎",leibie:"中国",parent:"长安"},{name:"欧拉",leibie:"中国",parent:"长城"},{name:"远程",leibie:"中国",parent:"吉利"},{name:"圣玛托",leibie:"美国",parent:""},{name:"捷途",leibie:"中国",parent:"奇瑞"},{name:"长城风骏7",leibie:"中国",parent:"长城"}];var Te=e=>{let t="无品牌类别",a=()=>{let a=[];return null!=e.value&&e.value.length>0&&(a=e.value.split("\n")),a.length>0&&(a=a.filter((e=>null!=e&&e.length>0))),0==a.length?[]:a.map((e=>{let a=e.split("\t"),l={};l.date=a[0]&&a[0].trim()||"无日期",l.dingsunyuan=a[1]&&a[1].trim()||"无定损员",l.xiaoshouyuan=a[2]&&a[2].trim()||"无销售员",l.chepai=a[3]&&a[3].trim()||"车牌",l.pinpai=a[4]&&a[4].trim()||"品牌",l.isChengJiao=!(!a[5]||"是"!=a[5].trim()),l.jine=a[6]&&parseInt(a[6].trim())||0,l.pinpai_leibie=t;try{"品牌"!=l.pinpai&&(l.pinpai_leibie=(n=l.pinpai,Ce.filter((e=>e.name==n||e.parent==n)))[0].leibie)}catch(r){console.error(l,r)}var n;return l}))};const l=f((()=>a())),n=f((()=>{let e=0;return l.value&&l.value.length>0&&l.value.forEach((t=>{isNaN(t.jine)||(e+=t.jine)})),e})),r=f((()=>l.value&&l.value.length>0?l.value.filter((e=>e.pinpai_leibie==t)):[])),i=f((()=>{let e=0,t=[];return l.value&&l.value.length>0&&(t=l.value.filter((t=>!!t.isChengJiao&&(e+=t.jine,!0)))),{list:t,totalAmount:e}}));return{dataList:l,totalAmount:n,chengJiaoData:i,noPinPaiDataList:r}},Le=(e,t,a)=>f((()=>function(){let l=["询价单数","询价金额","供应单数","供应金额","未供应单数","未供应金额"],n=[];if(e.value&&e.value.length>0){n.push({key:l[0],num:e.value.length,rate:1}),n.push({key:l[1],num:t.value,rate:1}),n.push({key:l[2],num:a.value.list.length,rate:a.value.list.length/e.value.length}),n.push({key:l[3],num:a.value.totalAmount,rate:a.value.totalAmount/t.value});let r=e.value.length-a.value.list.length;n.push({key:l[4],num:r,rate:r/e.value.length});let i=t.value-a.value.totalAmount;n.push({key:l[5],num:i,rate:i/t.value})}return n}()));const Oe=d({name:"TotalAnalyse",setup(){const e=b("dataList"),t=b("totalAmount"),a=b("chengJiaoData"),l=Le(e,t,a);return v((()=>{new ge("#totalTable")})),{totalAnalyse:l}}}),Ee=y("span",null,"报价总量分析",-1);var Je=Ie(Oe,[["render",function(e,t,a,l,n,r){const i=z,o=F,s=q;return h(),p(s,{class:"box-card",id:"totalCard"},{header:c((()=>[Ee])),default:c((()=>[g(o,{data:e.totalAnalyse,id:"totalTable","data-clipboard-target":"#totalCard",style:{width:"100%"},size:"small"},{default:c((()=>[g(i,{type:"index",label:"序号"}),g(i,{prop:"key",label:"类型"}),g(i,{prop:"num",label:"数量"}),g(i,{prop:"rate",label:"占比"})])),_:1},8,["data"])])),_:1})}]]);var Pe=(e,t)=>{function a(){let a={};return e.value&&e.value.length>0&&(e.value.sort(((e,t)=>e.pinpai_leibie.localeCompare(t.pinpai_leibie))),e.value.forEach((e=>{var t;a[e.pinpai_leibie]?function(e,t){e.total+=1,e.jine+=t.jine,e.chengJiaoTotal+=t.isChengJiao?1:0,e.chengJiaoJine+=t.isChengJiao&&t.jine||0}(a[e.pinpai_leibie],e):a[e.pinpai_leibie]={pinpai_leibie:(t=e).pinpai_leibie,total:1,jine:t.jine,totalRate:0,jineRate:0,chengJiaoTotal:t.isChengJiao?1:0,chengJiaoJine:t.isChengJiao&&t.jine||0}})),function(e,t,a){Object.keys(e).forEach((l=>{e[l].totalRate=e[l].total/t,e[l].jineRate=e[l].jine/a}))}(a,e.value.length,t.value)),a}return f((()=>a()))};const Ne=d({name:"PinPaiAnalyse",setup(){const e=b("dataList"),t=b("totalAmount"),a=Pe(e,t),l=f((()=>Object.values(a.value)));return v((()=>{new ge("#pinpaiTable")})),{tableData:l}}}),Me=y("span",null,"品牌构成分析",-1);var Re=Ie(Ne,[["render",function(e,t,a,l,n,r){const i=z,o=F,s=q;return h(),p(s,{class:"box-card",id:"pinpaiCard"},{header:c((()=>[Me])),default:c((()=>[g(o,{data:e.tableData,id:"pinpaiTable","data-clipboard-target":"#pinpaiCard",style:{width:"100%"},size:"small","show-summary":""},{default:c((()=>[g(i,{type:"index",label:"序号"}),g(i,{prop:"pinpai_leibie",label:"类型"}),g(i,{prop:"total",label:"数量（份）"}),g(i,{prop:"jine",label:"金额"}),g(i,{prop:"totalRate",label:"数量占比"}),g(i,{prop:"jineRate",label:"金额占比"}),g(i,{prop:"chengJiaoTotal",label:"成交数量"}),g(i,{prop:"chengJiaoJine",label:"成交金额"})])),_:1},8,["data"])])),_:1})}]]);var Ue=(e,t)=>{let a=()=>{let a={};return e.value&&e.value.length>0&&(e.value.sort(((e,t)=>e.dingsunyuan.localeCompare(t.dingsunyuan))),e.value.forEach((e=>{var t;a[e.dingsunyuan]?function(e,t){e.total+=1,e.jine+=t.jine,e.chengJiaoTotal+=t.isChengJiao?1:0,e.chengJiaoJine+=t.isChengJiao&&t.jine||0}(a[e.dingsunyuan],e):a[e.dingsunyuan]={total:1,jine:(t=e).jine,totalRate:0,jineRate:0,chengJiaoTotal:t.isChengJiao?1:0,chengJiaoJine:t.isChengJiao&&t.jine||0,dingsunyuan:t.dingsunyuan}})),function(e,t,a){Object.keys(e).forEach((l=>{e[l].totalRate=e[l].total/t,e[l].jineRate=e[l].jine/a}))}(a,e.value.length,t.value)),a};return f((()=>a()))};const ze=d({name:"DingSunYuanAnalyse",setup(){const e=b("dataList"),t=b("totalAmount"),a=Ue(e,t),l=f((()=>Object.values(a.value)));return v((()=>{new ge("#dsytable")})),{tableData:l}}}),Fe=y("span",null,"定损员分析",-1);var qe=Ie(ze,[["render",function(e,t,a,l,n,r){const i=z,o=F,s=q;return h(),p(s,{class:"box-card",id:"dsycard"},{header:c((()=>[Fe])),default:c((()=>[g(o,{data:e.tableData,id:"dsytable","data-clipboard-target":"#dsycard",style:{width:"100%"},size:"small","show-summary":""},{default:c((()=>[g(i,{type:"index",label:"序号"}),g(i,{prop:"dingsunyuan",label:"类型"}),g(i,{prop:"total",label:"数量（份）"}),g(i,{prop:"jine",label:"金额"}),g(i,{prop:"totalRate",label:"数量占比"}),g(i,{prop:"jineRate",label:"金额占比"}),g(i,{prop:"chengJiaoTotal",label:"成交数量"}),g(i,{prop:"chengJiaoJine",label:"成交金额"})])),_:1},8,["data"])])),_:1})}]]);const Ke=d({name:"DingSunYuanAnalyse",setup(){const e=b("dataList"),t=f((()=>{let t={};return e.value&&e.value.length>0?(e.value.sort(((e,t)=>e.xiaoshouyuan.localeCompare(t.xiaoshouyuan))),e.value.forEach((e=>{t[e.xiaoshouyuan]?(t[e.xiaoshouyuan].total+=1,t[e.xiaoshouyuan].chengJiaoTotal+=e.isChengJiao?1:0):t[e.xiaoshouyuan]={xiaoshouyuan:e.xiaoshouyuan,total:1,chengJiaoTotal:e.isChengJiao?1:0}})),Object.values(t)):[]}));return v((()=>{new ge("#xsytable")})),{tableData:t}}}),Xe=y("span",null,"销售员分析",-1);var Ye=Ie(Ke,[["render",function(e,t,a,l,n,r){const i=z,o=F,s=q;return h(),p(s,{class:"box-card",id:"xsycard"},{header:c((()=>[Xe])),default:c((()=>[g(o,{data:e.tableData,id:"xsytable","data-clipboard-target":"#xsycard",style:{width:"100%"},size:"small","show-summary":""},{default:c((()=>[g(i,{type:"index",label:"序号"}),g(i,{prop:"xiaoshouyuan",label:"销售员"}),g(i,{prop:"total",label:"总量"}),g(i,{prop:"chengJiaoTotal",label:"成交数量"})])),_:1},8,["data"])])),_:1})}]]);const $e=d({name:"NoPinPaiList",setup(){const e=b("noPinPaiList"),t=f((()=>e.value.length>0));return{noPinPaiList:e,showable:t}}}),Be=(e=>(V("data-v-d8373c38"),e=e(),j(),e))((()=>y("span",null,"无品牌类型",-1)));const He=d({name:"TongJi",components:{TotalAnalyse:Je,PinPaiAnalyse:Re,DingSunYuanAnalyse:qe,XiaoShouYuanAnalyse:Ye,NoPinPaiList:Ie($e,[["render",function(e,t,a,l,n,r){const i=K,o=q;return _((h(),p(o,{class:"box-card"},{header:c((()=>[Be])),default:c((()=>[(h(!0),w(k,null,S(e.noPinPaiList,((e,t)=>(h(),p(i,{key:t},{default:c((()=>[D(I(e.pinpai),1)])),_:2},1024)))),128))])),_:1},512)),[[x,e.showable]])}],["__scopeId","data-v-d8373c38"]])},setup(){const e={date:"日期",dingsunyuan:"定损员",xiaoshouyuan:"销售员",chepai:"车牌",pinpai:"品牌",isChengJiao:"是否成交",jine:"金额",pinpai_leibie:"品牌类别"},t=A(""),{dataList:a,totalAmount:l,chengJiaoData:n,noPinPaiDataList:r}=Te(t);return C("dataList",a),C("totalAmount",l),C("chengJiaoData",n),C("noPinPaiList",r),{headTableItem:e,content:t,dataList:a,totalAmount:l,chengJiaoData:n}}}),Ge={style:{width:"100%"}};var Qe=Ie(He,[["render",function(e,t,a,l,n,r){const i=X,o=Y,s=m("no-pin-pai-list"),u=m("total-analyse"),d=m("ding-sun-yuan-analyse"),p=$,f=m("xiao-shou-yuan-analyse"),b=m("pin-pai-analyse");return h(),w(k,null,[g(o,null,{default:c((()=>[y("table",Ge,[y("tr",null,[(h(!0),w(k,null,S(e.headTableItem,((e,t)=>(h(),w("th",{key:t},I(e),1)))),128))])]),g(i,{modelValue:e.content,"onUpdate:modelValue":t[0]||(t[0]=t=>e.content=t),rows:22,type:"textarea",placeholder:"请复制数据至此"},null,8,["modelValue"])])),_:1}),g(o,null,{default:c((()=>[g(s)])),_:1}),g(o,{gutter:10},{default:c((()=>[g(p,{span:12},{default:c((()=>[g(u),g(d)])),_:1}),g(p,{span:12},{default:c((()=>[g(f),g(b)])),_:1})])),_:1})],64)}]]);const We=e=>(V("data-v-49c2612a"),e=e(),j(),e),Ze={class:"card-header"},et=We((()=>y("span",{style:{color:"var(--el-color-info)"}},"点击可自动复制",-1))),tt=D("打开腾讯文档"),at=We((()=>y("span",null,"计算后结果",-1))),lt=We((()=>y("span",null,"结果",-1)));var nt=Ie(d({props:{showComputedList:Array,totalCount:[Number,String],showList:Array,region:String},setup(e){const{toClipboard:t}=fe(),a=A("https://docs.qq.com/sheet/DS0FkVVhwd29KdHNk"),l=async e=>{try{if(null==e)return;let a=Array.isArray(e)&&e.join("\n")||e.toString();await t(a),H({message:"复制成功",type:"success"})}catch(a){console.error(a),H.error(a.message||"真奇怪，不知道哪里错了。")}};return(t,n)=>{const r=B,i=$,o=Y,s=q;return h(),w("div",null,[g(s,null,{header:c((()=>[y("div",Ze,[et,g(r,{type:"primary",href:a.value,target:"_blank"},{default:c((()=>[tt])),_:1},8,["href"])])])),default:c((()=>[g(o,{gutter:10},{default:c((()=>[g(i,{span:10},{default:c((()=>[T(t.$slots,"default",{},void 0,!0)])),_:3}),g(i,{span:14,onClick:n[0]||(n[0]=t=>l(e.totalCount))},{default:c((()=>[D(" 总计："+I(e.totalCount),1)])),_:1})])),_:3})])),_:3}),g(o,null,{default:c((()=>[g(i,{span:16},{default:c((()=>[g(s,{onClick:n[1]||(n[1]=t=>l(e.showComputedList))},{header:c((()=>[at])),default:c((()=>[(h(!0),w(k,null,S(e.showComputedList,((e,t)=>(h(),w("div",{key:t},I(e),1)))),128))])),_:1})])),_:1}),g(i,{span:8},{default:c((()=>[g(s,{onClick:n[2]||(n[2]=t=>l(e.showList))},{header:c((()=>[lt])),default:c((()=>[(h(!0),w(k,null,S(e.showList,((e,t)=>(h(),w("div",{key:t},I(e),1)))),128))])),_:1})])),_:1})])),_:1})])}}}),[["__scopeId","data-v-49c2612a"]]);const rt={class:"upload-wapper"},it={class:"el-image"},ot=["src"],st={class:"tips"},ut=y("small",{style:{color:"var(--el-text-color-disabled)"}},"图片可缩放，也可移动",-1),dt=D("图片还原"),pt=y("div",{class:"el-upload__text"},"拖拽或上传文件",-1),ct=d({setup(e){const t=A(),a=A(""),l=A(1),n=A(1);A(null);const{handleMousedown:r,handleMousemove:i,handleMouseup:o,translate:s,init:u}=(()=>{const e={x:0,y:0},t=L({x:0,y:0});let a=!1;return{handleMousedown:t=>{a=!0,e.x=t.clientX,e.y=t.clientY,t.preventDefault()},handleMousemove:l=>(a&&(t.x=l.clientX-e.x,t.y=l.clientY-e.y),!1),handleMouseup:e=>{a=!1},translate:t,init:()=>{t.x=0,t.y=0}}})(),d=e=>{e&&e.hasOwnProperty("url")&&(a.value=e.url||"")},p=()=>{n.value=1,u()},m=e=>{t.value.clearFiles();const a=e[0];a.uid=+new Date,t.value.handleStart(a)},f=e=>(e.deltaY<0?n.value<2?n.value+=.2:n.value=2:e.deltaY>0&&(n.value>.4?n.value-=.2:n.value=.4),!1);return(e,u)=>{const b=G,v=Q;return h(),w("div",rt,[y("div",it,[y("img",{src:a.value,onWheel:f,onMousemove:u[0]||(u[0]=(...e)=>O(i)&&O(i)(...e)),onMousedown:u[1]||(u[1]=(...e)=>O(r)&&O(r)(...e)),onMouseup:u[2]||(u[2]=(...e)=>O(o)&&O(o)(...e)),style:E({transform:"scale("+n.value+") translate("+O(s).x+"px, "+O(s).y+"px)","object-fit":"contain"}),class:"el-image__inner"},null,44,ot)]),y("p",st,[ut,y("span",{onClick:p},[dt,g(b,null,{default:c((()=>[g(O(we))])),_:1})])]),g(v,{action:"#",drag:"",ref_key:"upload",ref:t,"auto-upload":!1,limit:l.value,"list-type":"picture","on-change":d,"on-exceed":m},{default:c((()=>[g(b,{class:"el-icon--upload"},{default:c((()=>[g(O(Se))])),_:1}),pt])),_:1},8,["limit"])])}}});const mt=D("地区"),ht=y("legend",null,"分隔符：",-1),gt=d({setup(e){const t=A(""),a=A(["请在此输入输入","一行一组","以空格相格","例如：","123 32 23 3","56 65 45 3","234 42 34 6"].join("\n")),l={SPACE:{label:"空格",value:" "},X:{label:"X;",value:"X"}},n=A(""),r=A(l.SPACE.value);let i=f((()=>{let e=t.value.trim();if(!e)return[];let a=e.split("\n");return a&&0!=a.length?(a[0].includes(l.X.value)?r.value=l.X.value:r.value=l.SPACE.value,a.map((e=>{let t=function(e,t){if(t==l.SPACE.value)return e.trim().split(t);if(t==l.X.value){let a=e.trim().split(t),l=a[2].split(";");return[a[0],a[1],l[0],l[1]]}}(e,r.value);return{len:t[0],width:t[1],height:t[2],count:t[3]}}))):[]})),o=f((()=>i.value.map((e=>e.len+"X"+e.width+"X"+e.height+";"+e.count)))),s=f((()=>i.value.map((e=>e.len+"X"+e.width+"X"+e.height+"X"+e.count+"="+e.len*e.width*e.height*e.count)))),u=f((()=>{let e=0;return i.value.forEach((t=>{e+=t.len*t.width*t.height*t.count})),e}));return(e,i)=>{const d=X,m=$,f=W,b=Z,v=Y;return h(),p(v,{gutter:20},{default:c((()=>[g(m,{span:10},{default:c((()=>[g(nt,{"total-count":O(u),"show-computed-list":O(s),"show-list":O(o),region:n.value},{default:c((()=>[g(d,{modelValue:n.value,"onUpdate:modelValue":i[0]||(i[0]=e=>n.value=e),placeholder:"请输入地区"},{prepend:c((()=>[mt])),_:1},8,["modelValue"])])),_:1},8,["total-count","show-computed-list","show-list","region"])])),_:1}),g(m,{span:4},{default:c((()=>[y("fieldset",null,[ht,g(b,{modelValue:r.value,"onUpdate:modelValue":i[1]||(i[1]=e=>r.value=e)},{default:c((()=>[(h(),w(k,null,S(l,(e=>g(f,{label:e.value,size:"small",border:""},{default:c((()=>[D(I(e.label),1)])),_:2},1032,["label"]))),64))])),_:1},8,["modelValue"])]),g(d,{modelValue:t.value,"onUpdate:modelValue":i[2]||(i[2]=e=>t.value=e),rows:20,type:"textarea",placeholder:a.value,style:{"font-size":"large"}},null,8,["modelValue","placeholder"])])),_:1}),g(m,{span:10},{default:c((()=>[g(ct)])),_:1})])),_:1})}}});var ft=Ie(d({setup(e){const t=be();ve();const a=t.getRoutes().filter((e=>!e.meta.menuHidden));return(e,t)=>{const l=m("router-link");return h(!0),w(k,null,S(O(a),(e=>(h(),p(l,{to:e.path,key:e.path,class:"link"},{default:c((()=>[D(I(e.meta.title),1)])),_:2},1032,["to"])))),128)}}}),[["__scopeId","data-v-ee9e59ac"]]);const bt={},vt={style:{float:"right",cursor:"pointer"},href:"https://gitee.com/hzsn-csh/sn-tools",target:"_blank"},yt=[y("img",{alt:"Gitee",src:"/sn-tools/img/logo-gitee-g.svg",title:"Gitee — 基于 Git 的代码托管和研发协作平台",style:{height:"36px","margin-top":"12px"}},null,-1)];var _t=Ie(bt,[["render",function(e,t){return h(),w("a",vt,yt)}]]);const xt={},wt=D("小工具");var St=Ie(xt,[["render",function(e,t){const a=_t,l=ee,n=ft,r=te,i=m("router-view"),o=ae,s=le;return h(),p(s,null,{default:c((()=>[g(l,null,{default:c((()=>[wt,g(a)])),_:1}),g(s,{class:"container"},{default:c((()=>[g(r,{width:"200px"},{default:c((()=>[g(n)])),_:1}),g(o,null,{default:c((()=>[g(i)])),_:1})])),_:1})])),_:1})}],["__scopeId","data-v-a2d1efa4"]]);const kt={},Vt=D("体积计算"),jt=D("体积计算"),Dt=D("品牌统计"),It=D("品牌统计"),At=D("鼎能面单"),Ct=D("鼎能面单");var Tt=Ie(kt,[["render",function(e,t){const a=m("router-link"),l=q,n=$,r=Y;return h(),p(r,{gutter:20},{default:c((()=>[g(n,{span:6},{default:c((()=>[g(l,null,{header:c((()=>[Vt])),default:c((()=>[g(a,{to:"/volume"},{default:c((()=>[jt])),_:1})])),_:1})])),_:1}),g(n,{span:6},{default:c((()=>[g(l,null,{header:c((()=>[Dt])),default:c((()=>[g(a,{to:"/tongji"},{default:c((()=>[It])),_:1})])),_:1})])),_:1}),g(n,{span:6},{default:c((()=>[g(l,null,{header:c((()=>[At])),default:c((()=>[g(a,{to:"/dingnengorder"},{default:c((()=>[Ct])),_:1})])),_:1})])),_:1})])),_:1})}]]);const Lt={},Ot=D("回首页");var Et=Ie(Lt,[["render",function(e,t){const a=ne,l=m("router-link"),n=re;return h(),p(n,{icon:"error",title:"404","sub-title":"not found"},{extra:c((()=>[g(l,{to:"/"},{default:c((()=>[g(a,{type:"primary"},{default:c((()=>[Ot])),_:1})])),_:1})])),_:1})}]]),Jt={sender:[{required:!0,message:"请输入发货人",trigger:"blur"}],sender_phone:[{required:!0,message:"请输入发货人电话",trigger:"blur"}],recipient_company:[{required:!0,message:"请输入收货单位",trigger:"blur"}],recipient:[{required:!0,message:"请输入收货人",trigger:"blur"}],recipient_phone:[{required:!0,message:"请输入收货人电话",trigger:"blur"}],address:[{required:!0,message:"请输入收货地址",trigger:"blur"}],send_time:[{required:!0,message:"请输入发运时间",trigger:"change"}],recipient_time:[{required:!0,message:"请输入收货时间",trigger:"change"}],total_volume:[{type:"number",required:!0,message:"请输入总体积，数字类型",trigger:"blur"}],total_weight:[{type:"number",required:!0,message:"请输入总重量，数字类型",trigger:"blur"}],delivery_user:[{required:!0,message:"请输入提货人",trigger:"blur"}],remark:[]};const Pt=[{key:"zhixiang",value:0,text:"纸箱"},{key:"muxiang",value:0,text:"木箱"},{key:"tiejian",value:0,text:"铁件"},{key:"qita",value:0,text:"其他"}],Nt=o("dingnengOrder",{state:()=>({dn_order_id:"",sender:"",sender_phone:"",recipient_company:"",recipient:"",recipient_phone:"",address:"",goodsList:[],send_time:0,recipient_time:0,total_volume:0,total_weight:0,delivery_user:"",remark:""}),getters:{total_count:e=>{let t=0;return e.goodsList.forEach((e=>{t+=e.value})),t}},actions:{createDNOrderId:()=>"DN"+(new Date).getTime()+Math.floor(1e3*Math.random()),getGoodsList:()=>Object.assign([],Pt).map((e=>(e.value=0,e))),getFromStorage:()=>({sender:localStorage.getItem("sender")||"",sender_phone:localStorage.getItem("sender_phone")||"",delivery_user:localStorage.getItem("delivery_user")||""}),saveToStorage(){localStorage.setItem("sender",this.sender),localStorage.setItem("sender_phone",this.sender_phone),localStorage.setItem("delivery_user",this.delivery_user)},init(){this.$reset(),this.goodsList=this.getGoodsList(),this.dn_order_id=this.createDNOrderId();let e=this.getFromStorage();this.sender=e.sender,this.sender_phone=e.sender_phone,this.delivery_user=e.delivery_user,this.send_time=+new Date,this.recipient_time=+new Date}}}),Mt={style:{width:"600px",margin:"auto"}},Rt=y("h3",{style:{"text-align":"center",color:"var(--el-text-color-primary)"}},"创建面单",-1),Ut=D("m³"),zt=D("KG"),Ft=D("打印"),qt=D("重置"),Kt=d({setup(e){const t=A(),a=Nt();a.init();const l=a.$state,n=be(),r=async()=>{t&&await t.value.validate((e=>{e&&(a.saveToStorage(),n.push({name:"dingnengOrderPrint"}))}))},i=()=>{t&&a.init()};return(e,a)=>{const n=X,o=ie,s=$,u=Y,d=oe,m=se,f=ne,b=ue;return h(),w("div",Mt,[Rt,g(b,{ref_key:"elFormRef",ref:t,model:O(l),rules:O(Jt),"label-width":"100px"},{default:c((()=>[g(u,null,{default:c((()=>[g(s,{span:12},{default:c((()=>[g(o,{label:"发货人",prop:"sender"},{default:c((()=>[g(n,{modelValue:O(l).sender,"onUpdate:modelValue":a[0]||(a[0]=e=>O(l).sender=e),placeholder:"请输入发货人",clearable:"",style:{width:"100%"}},null,8,["modelValue"])])),_:1})])),_:1}),g(s,{span:12},{default:c((()=>[g(o,{label:"发货人电话",prop:"sender_phone"},{default:c((()=>[g(n,{modelValue:O(l).sender_phone,"onUpdate:modelValue":a[1]||(a[1]=e=>O(l).sender_phone=e),placeholder:"请输入发货人电话",clearable:"",style:{width:"100%"}},null,8,["modelValue"])])),_:1})])),_:1})])),_:1}),g(o,{label:"收货单位",prop:"recipient_company"},{default:c((()=>[g(n,{modelValue:O(l).recipient_company,"onUpdate:modelValue":a[2]||(a[2]=e=>O(l).recipient_company=e),placeholder:"请输入收货单位",clearable:"",style:{width:"100%"}},null,8,["modelValue"])])),_:1}),g(u,null,{default:c((()=>[g(s,{span:12},{default:c((()=>[g(o,{label:"收货人",prop:"recipient"},{default:c((()=>[g(n,{modelValue:O(l).recipient,"onUpdate:modelValue":a[3]||(a[3]=e=>O(l).recipient=e),placeholder:"请输入收货人",clearable:"",style:{width:"100%"}},null,8,["modelValue"])])),_:1})])),_:1}),g(s,{span:12},{default:c((()=>[g(o,{label:"收货人电话",prop:"recipient_phone"},{default:c((()=>[g(n,{modelValue:O(l).recipient_phone,"onUpdate:modelValue":a[4]||(a[4]=e=>O(l).recipient_phone=e),placeholder:"请输入收货人电话",clearable:"",style:{width:"100%"}},null,8,["modelValue"])])),_:1})])),_:1})])),_:1}),g(o,{label:"收货地址",prop:"address"},{default:c((()=>[g(n,{modelValue:O(l).address,"onUpdate:modelValue":a[5]||(a[5]=e=>O(l).address=e),placeholder:"请输入收货地址",clearable:"",style:{width:"100%"}},null,8,["modelValue"])])),_:1}),g(u,null,{default:c((()=>[(h(!0),w(k,null,S(O(l).goodsList,((e,t)=>(h(),p(s,{span:12,key:e.key},{default:c((()=>[g(o,{label:e.text},{default:c((()=>[g(d,{modelValue:e.value,"onUpdate:modelValue":t=>e.value=t,placeholder:"请输入"+e.text,step:1,max:1e3},null,8,["modelValue","onUpdate:modelValue","placeholder"])])),_:2},1032,["label"])])),_:2},1024)))),128))])),_:1}),g(u,null,{default:c((()=>[g(s,{span:12},{default:c((()=>[g(o,{label:"发运时间",prop:"send_time"},{default:c((()=>[g(m,{type:"datetime",modelValue:O(l).send_time,"onUpdate:modelValue":a[6]||(a[6]=e=>O(l).send_time=e),placeholder:"请输入发运时间",clearable:"","value-format":"x"},null,8,["modelValue"])])),_:1})])),_:1}),g(s,{span:12},{default:c((()=>[g(o,{label:"收货时间",prop:"recipient_time"},{default:c((()=>[g(m,{type:"datetime",modelValue:O(l).recipient_time,"onUpdate:modelValue":a[7]||(a[7]=e=>O(l).recipient_time=e),placeholder:"请输入收货时间",clearable:"","value-format":"x"},null,8,["modelValue"])])),_:1})])),_:1})])),_:1}),g(u,null,{default:c((()=>[g(s,{span:12},{default:c((()=>[g(o,{label:"总体积",prop:"total_volume"},{default:c((()=>[g(n,{modelValue:O(l).total_volume,"onUpdate:modelValue":a[8]||(a[8]=e=>O(l).total_volume=e),modelModifiers:{number:!0},placeholder:"请输入总体积",clearable:"",style:{width:"100%"}},{append:c((()=>[Ut])),_:1},8,["modelValue"])])),_:1})])),_:1}),g(s,{span:12},{default:c((()=>[g(o,{label:"总重量",prop:"total_weight"},{default:c((()=>[g(n,{modelValue:O(l).total_weight,"onUpdate:modelValue":a[9]||(a[9]=e=>O(l).total_weight=e),modelModifiers:{number:!0},placeholder:"请输入总重量",clearable:""},{append:c((()=>[zt])),_:1},8,["modelValue"])])),_:1})])),_:1})])),_:1}),g(o,{label:"提货人",prop:"delivery_user"},{default:c((()=>[g(n,{modelValue:O(l).delivery_user,"onUpdate:modelValue":a[10]||(a[10]=e=>O(l).delivery_user=e),placeholder:"请输入提货人",clearable:"",style:{width:"100%"}},null,8,["modelValue"])])),_:1}),g(o,{label:"备注",prop:"remark"},{default:c((()=>[g(n,{modelValue:O(l).remark,"onUpdate:modelValue":a[11]||(a[11]=e=>O(l).remark=e),type:"textarea",placeholder:"请输入备注",autosize:{minRows:4,maxRows:4},style:{width:"100%"}},null,8,["modelValue"])])),_:1}),g(o,{size:"large"},{default:c((()=>[g(f,{type:"primary",onClick:r},{default:c((()=>[Ft])),_:1}),g(f,{onClick:i},{default:c((()=>[qt])),_:1})])),_:1})])),_:1},8,["model","rules"])])}}});const Xt=o("dingnengSettings",(()=>{const e="printFontSize",t=()=>{const t=localStorage.getItem(e);return console.log("getFromStorage",t),null==t||null==t?1:parseFloat(t)},a=t(),l=A(a);return{fontSize:l,getFromStorage:t,saveToStorage:()=>{localStorage.setItem(e,""+l.value)}}})),Yt=d({props:{code:{type:String,required:!0}},setup(e){const{code:t}=e,a=A(null);v((()=>{a.value&&l(a.value,t)}));const l=(e,t)=>{ye(e,t,{displayValue:!1,height:60})};return(e,t)=>(h(),w("svg",{ref_key:"barcodeRef",ref:a},null,512))}});const $t=e=>(V("data-v-d893585c"),e=e(),j(),e),Bt=$t((()=>y("div",{class:"order-header"},[y("img",{height:"40",width:"40",src:"/sn-tools/img/dingneng.png"}),y("span",null,"杭州鼎能供应链发运单")],-1))),Ht={style:{margin:"10px 0 0 0"}},Gt={style:{"text-align":"center"}},Qt={colspan:"3"},Wt={colspan:"2"},Zt={colspan:"5"},ea={colspan:"3"},ta={colspan:"2"},aa={colspan:"5"},la=$t((()=>y("tr",null,[y("td",{colspan:"5",style:{"text-align":"center",padding:"10px 0px","font-size":"1.12em"}}," 货物详情 ")],-1))),na=$t((()=>y("td",{style:{"text-align":"center"}},"合计",-1))),ra={style:{"text-align":"center"}},ia={colspan:"3"},oa={colspan:"2"},sa={colspan:"5"},ua={colspan:"3"},da=$t((()=>y("td",{colspan:"2"},"签收人：",-1))),pa={colspan:"5"},ca={style:{border:"none"}},ma={colspan:"5"},ha={class:"other-wapper"},ga={class:"print-btn-wapper"},fa={class:"print-btn-wapper"},ba=D("打印"),va={class:"print-btn-wapper"},ya=D("返回");var _a=Ie(d({setup(e){const t=be(),a=Nt(),l=Xt(),n=a.$state,r=A(!1),{fontSize:i}=s(l),o=e=>{l.saveToStorage()},u=f((()=>{let e=new Date(n.send_time);return e.getFullYear()+"年"+(e.getMonth()+1)+"月"+e.getDate()+"日"})),d=f((()=>{let e=new Date(n.recipient_time);return e.getFullYear()+"年"+(e.getMonth()+1)+"月"+e.getDate()+"日"})),p=()=>{r.value=!0,t.back()},m=()=>{window.print()};return(e,t)=>{const l=oe,s=ne;return h(),w(k,null,[y("div",{class:"order-wapper print",style:E({fontSize:O(i)+"em"})},[Bt,y("p",Ht,"运单号："+I(O(n).dn_order_id),1),y("div",Gt,[g(Yt,{code:O(n).dn_order_id},null,8,["code"])]),y("table",null,[y("tbody",null,[y("tr",null,[y("td",Qt,"发货人："+I(O(n).sender),1),y("td",Wt,"电话："+I(O(n).sender_phone),1)]),y("tr",null,[y("td",Zt,"收货单位："+I(O(n).recipient_company),1)]),y("tr",null,[y("td",ea,"收货人："+I(O(n).recipient),1),y("td",ta,"电话："+I(O(n).recipient_phone),1)]),y("tr",null,[y("td",aa,"收货地址："+I(O(n).address),1)]),la,y("tr",null,[(h(!0),w(k,null,S(O(n).goodsList,(e=>(h(),w("td",{class:"border-right",key:e.key},I(e.text),1)))),128)),na]),y("tr",null,[(h(!0),w(k,null,S(O(n).goodsList,(e=>(h(),w("td",{class:"border-right",key:e.key},I(e.value),1)))),128)),y("td",ra,I(O(a).total_count),1)]),y("tr",null,[y("td",ia,"体积："+I(O(n).total_volume)+" m³",1),y("td",oa,"重量："+I(O(n).total_weight)+" KG",1)]),y("tr",null,[y("td",sa,"发运时间："+I(O(u)),1)]),y("tr",null,[y("td",ua,"提货人："+I(O(n).delivery_user),1),da]),y("tr",null,[y("td",pa,"日期："+I(O(d)),1)]),y("tr",ca,[y("td",ma,"备注："+I(O(n).remark),1)])])])],4),y("div",ha,[y("div",ga,[g(l,{modelValue:O(i),"onUpdate:modelValue":t[0]||(t[0]=e=>J(i)?i.value=e:null),precision:2,step:.1,min:1,max:2,onChange:o,style:{width:"200px","margin-left":"74px"}},null,8,["modelValue","step"])]),y("div",fa,[g(s,{type:"primary",class:"print-btn",onClick:m},{default:c((()=>[ba])),_:1})]),y("div",va,[g(s,{onClick:p,loading:r.value},{default:c((()=>[ya])),_:1},8,["loading"])])])],64)}}}),[["__scopeId","data-v-d893585c"]]);function xa(e,t){return e=Math.ceil(e),t=Math.floor(t),Math.floor(Math.random()*(t-e))+e}function wa(e){return e<10&&"0"+e||e}const Sa=(e,t)=>{let a={};for(const l in e)if(Object.prototype.hasOwnProperty.call(e,l)){const t=e[l];a[l]=je.json_to_sheet(t)}!function(e,t){let a="";"object"==typeof e&&e instanceof Blob&&(a=URL.createObjectURL(e));var l,n=document.createElement("a");n.href=a,n.download=t||"",window.MouseEvent?l=new MouseEvent("click"):(l=document.createEvent("MouseEvents")).initMouseEvent("click",!0,!1,window,0,0,0,0,0,!1,!1,!1,!1,0,null),n.dispatchEvent(l),n.remove()}(function(e){var t={SheetNames:Object.keys(e),Sheets:{}};for(const l in e)if(Object.prototype.hasOwnProperty.call(e,l)){const a=e[l];t.Sheets[l]=a}var a=De(t,{bookType:"xlsx",bookSST:!1,type:"binary"});return new Blob([function(e){for(var t=new ArrayBuffer(e.length),a=new Uint8Array(t),l=0;l!=e.length;++l)a[l]=255&e.charCodeAt(l);return t}(a)],{type:"application/octet-stream"})}(a),function(e,t){let a=t.lastIndexOf("."),l=1==e.length&&e[0]+"-"||"";return t.substring(0,a)+"-"+l+ +new Date+t.substring(a)}(Object.keys(a),t))};const ka=(e,t,a,l=0,n="\t")=>{let r=e.Sheets[e.SheetNames[t]],i=je.sheet_to_txt(r).split("\n"),o=[];for(let s=a.find((e=>i[0].includes(e.zhKey)||i[0].includes(e.key)))?1:0;s<i.length;s++){let e=i[s].split(n),t={};for(const l of a)t[l.key]=e[l.index].trim();o.push(t)}return o},Va="application/vnd.openxmlformats-officedocument.spreadsheetml.sheet";const ja=y("div",{class:"el-upload__text"},[D(" Drop file here or "),y("em",null,"click to upload")],-1),Da=d({emits:["change"],setup(e,{emit:t}){const a=A(),{valiteFile:l,handleExceed:n,acceptType:r}=(e=>({valiteFile:(e,t)=>{let a=e.raw;if(a){if(a.type==Va)return!0;H({type:"warning",message:"附件格式错误，请删除后重新上传！"})}else H({type:"warning",message:"请上传附件！"});return!1},handleExceed:t=>{e.value.clearFiles();const a=t[0];a.uid=Date.now(),e.value.handleStart(a)},acceptType:Va}))(a),i=(e,a)=>{l(e,a)&&e.raw&&t("change",e.raw)};return(e,t)=>{const l=G;return h(),p(O(Q),{drag:"",ref_key:"uploadRef",ref:a,action:"","on-change":i,"on-exceed":O(n),limit:1,accept:O(r),"auto-upload":!1},{default:c((()=>[g(l,{class:"el-icon--upload"},{default:c((()=>[g(O(ke))])),_:1}),ja])),_:1},8,["on-exceed","accept"])}}}),Ia=[{id:57,text:"陆放",label:"kluger"},{id:38,text:"荣放",label:"rav4"}],Aa={index:-1,label:"全部"},Ca="city",Ta="username",La="phone",Oa="series_id",Ea="dealer_id",Ja="company",Pa="order_at";var Na=(e=>(e[e.DATA=0]="DATA",e[e.SERIES=1]="SERIES",e))(Na||{});const Ma={data:{id:0,text:"数据"},seriesData:{id:1,text:"车系资料"}},Ra=[{key:"city",zhKey:"城市",index:1},{key:"username",zhKey:"姓名",index:5},{key:"phone",zhKey:"电话",index:6}],Ua=[{key:"dealerId",zhKey:"经销商编码",index:0},{key:"name",zhKey:"经销商名称",index:1},{key:"city",zhKey:"城市",index:2}],za={hour:[9,10,11,12,13,14,15,16,17,18,19,20,21,22],weight:[9,6,3,2,1,3,4,3,3,8,8,4,2,1]},Fa=za.weight.reduce(((e,t)=>e+t)),qa=o("ftmsStore",(()=>{let e=new Date;const t=A([new Date(e.getFullYear(),e.getMonth(),e.getDate()-1,18),new Date(e.getFullYear(),e.getMonth(),e.getDate(),17,30,0)]),a=L(Ma);function l(e){return e.label+e.id}function n(e){let t=localStorage.getItem(l(e));return t&&JSON.parse(t)||[]}const r=L({[Ia[0].label]:n(Ia[0]),[Ia[1].label]:n(Ia[1])});return{dateTime:t,uploadTypeRadioKeyList:a,seriesList:r,saveSeries:function(e,t){localStorage.setItem(l(t),JSON.stringify(e)),r[t.label]=e},hasSeriesData:function(e){return r[e.label].length>0}}}));const Ka={class:"title"};var Xa=Ie(d({props:{text:{type:String,default:"项"}},setup:e=>(t,a)=>(h(),w("span",Ka,I(e.text),1))}),[["__scopeId","data-v-0232ad94"]]);const Ya={style:{"margin-bottom":"20px"}};var $a=Ie(d({props:["modelValue"],emits:["update:modelValue"],setup(e,{emit:t}){const a=e,{uploadTypeRadioKeyList:l}=qa(),n=f({get:()=>a.modelValue,set:e=>t("update:modelValue",e)});return(e,t)=>{const a=de,r=Z;return h(),w("div",Ya,[g(Xa,{text:"数据类型"}),g(r,{modelValue:O(n),"onUpdate:modelValue":t[0]||(t[0]=e=>J(n)?n.value=e:null)},{default:c((()=>[(h(!0),w(k,null,S(O(l),(e=>(h(),p(a,{label:e.id,border:""},{default:c((()=>[D(I(e.text),1)])),_:2},1032,["label"])))),256))])),_:1},8,["modelValue"])])}}}),[["__scopeId","data-v-6c197776"]]);const Ba=d({setup(e){const{dateTime:t}=s(qa());return(e,a)=>{const l=se,n=ie,r=ue;return h(),p(r,{inline:!0,class:"demo-form-inline"},{default:c((()=>[g(n,{label:"时间范围"},{default:c((()=>[g(l,{modelValue:O(t),"onUpdate:modelValue":a[0]||(a[0]=e=>J(t)?t.value=e:null),type:"datetimerange","range-separator":"To","start-placeholder":"Start date","end-placeholder":"End date"},null,8,["modelValue"])])),_:1})])),_:1})}}});function Ha(){const{dateTime:e}=qa();let t=function(e,t){let a=xa(0,t);for(let l=0;l<e.length;l++)if(a-=e[l],a<=0)return l;return 0}(za.weight,Fa),a=za.hour[t],l=new Date(xa(e[0].getTime(),e[1].getTime()));for(;l.getHours()!=a;)l=new Date(xa(e[0].getTime(),e[1].getTime()));let n=l.getFullYear(),r=l.getMonth()+1,i=l.getDate(),o=wa(l.getMinutes()),s=wa(l.getSeconds());return n+"-"+wa(r)+"-"+wa(i)+" "+wa(a)+":"+o+":"+s}function Ga(e,t){let a=Ia.filter((t=>e.includes(t.text)));if(a.length>0)return a[0];if(a=Ia.filter((e=>t.includes(e.text))),a.length>0)return a[0];throw new Error("没有从文件名或sheet name 中找到车系名称")}var Qa=(e,o)=>{const{seriesList:u}=s(qa());let d=u.value[o.label],p=e.map((e=>{return s=((e,t)=>{for(var a in t||(t={}))n.call(t,a)&&i(e,a,t[a]);if(l)for(var a of l(t))r.call(t,a)&&i(e,a,t[a]);return e})({},e),u={seriesId:o.id},t(s,a(u));var s,u})),c=new Set;p.forEach((e=>c.add(e.city)));let m={};return c.forEach((e=>{m[e]=d.filter((t=>t.city==e))})),function(e,t){e.forEach((e=>{let a=xa(0,t[e.city].length),l=t[e.city][a];e.dealerId=l.dealerId,e.dealerName=l.name}))}(p,m),function(e){e.forEach((e=>{e.orderAt=Ha()}))}(p),p.map((e=>{let t={};return t[Ca]=e.city,t[Ta]=e.username,t[La]=e.phone,t[Ea]=e.dealerId,t[Ja]=e.dealerName,t[Oa]=e.seriesId,t[Pa]=e.orderAt,t}))},Wa=()=>{const e=qa(),{uploadTypeRadioKeyList:t}=s(e),a=A(t.value.data.id),l=A(),n=L({visible:!1,sheetNames:[],sheetIndex:Aa.index,fileName:""});P((()=>n.fileName),(()=>n.sheetIndex=Aa.index));function r(e){if(e==Na.DATA)return Ra;if(e==Na.SERIES)return Ua;throw new Error(`没有此类型key:${e}`)}return{workBook:l,sheetDialogConfig:n,openSheetDialog:(e,t)=>{n.sheetNames=t,n.visible=!0,n.fileName=e},uploadType:a,handleSheetSelect:t=>{if(!l.value)return;let i={};if(t==Aa.index){let e=l.value.SheetNames,t=r(a.value);for(let a=0;a<e.length;a++)i[e[a]]=ka(l.value,a,t)}else i[l.value.SheetNames[t]]=ka(l.value,t,r(a.value));try{(t=>{const{sheetObject:a,fileName:l,uploadType:n}=t;if(n.value==Na.DATA){let t={};for(const n in a)if(Object.prototype.hasOwnProperty.call(a,n)){const r=a[n];let i=Ga(n,l);if(!e.hasSeriesData(i))throw new Error(`没有该车系的数据：${i.text} 请先上传${i.text}的数据`);t[n]=Qa(r,i)}Sa(t,l)}else{if(n.value!=Na.SERIES)throw new Error("类型错误");for(const t in a)if(Object.prototype.hasOwnProperty.call(a,t)){const n=a[t];let r=Ga(t,l);e.saveSeries(n,r),H.success(`已添加${t}${n.length}条数据`)}}})({sheetObject:i,fileName:n.fileName,uploadType:a})}catch(o){console.error(o),H.error(o.message)}finally{l.value=void 0}}}};var Za=Ie(d({setup(e){const{seriesList:t}=s(qa()),a=A(!1),l=f((()=>{let e=0==t.value[Ia[0].label].length;return{title:`${Ia[0].text} 数据不存在`,show:e}})),n=f((()=>{let e=0==t.value[Ia[1].label].length;return{title:`${Ia[1].text} 数据不存在`,show:e}}));return(e,t)=>(h(),w(k,null,[O(l).show?(h(),p(O(pe),{key:0,title:O(l).title,type:"error",closable:a.value},null,8,["title","closable"])):N("",!0),O(n).show?(h(),p(O(pe),{key:1,title:O(n).title,type:"error",closable:a.value},null,8,["title","closable"])):N("",!0)],64))}}),[["__scopeId","data-v-0bb6ce8f"]]);const el=d({setup(e){const{seriesList:t}=s(qa()),a=f((()=>({label:Ia[0].text,desc:`${t.value[Ia[0].label].length}条`}))),l=f((()=>({label:Ia[1].text,desc:`${t.value[Ia[1].label].length}条`})));return(e,t)=>{const n=ce,r=me;return h(),p(r,{border:"",title:"车系资料"},{default:c((()=>[g(n,{"label-align":"right",align:"center",label:O(a).label},{default:c((()=>[D(I(O(a).desc),1)])),_:1},8,["label"]),g(n,{"label-align":"right",align:"center",label:O(l).label},{default:c((()=>[D(I(O(l).desc),1)])),_:1},8,["label"])])),_:1})}}}),tl={class:"dialog-footer"},al=D("取消"),ll=D(" 确定 "),nl=d({props:{sheetIndex:{type:Number,default:Aa.index},visible:{type:Boolean,default:!1},fileName:{type:String},sheetNames:{type:Array,default:[]}},emits:["update:sheetIndex","update:visible","select"],setup(e,{emit:t}){const a=e,l=f({get:()=>[Aa,...a.sheetNames.map(((e,t)=>({index:t,label:e})))],set(e){console.log(e)}}),n=f({get:()=>a.visible,set(e){t("update:visible",e)}}),r=e=>{t("update:sheetIndex",e)},i=()=>{n.value=!1,t("select",a.sheetIndex)};return(t,a)=>{const o=W,s=Z,u=ne,d=he;return h(),p(d,{modelValue:O(n),"onUpdate:modelValue":a[2]||(a[2]=e=>J(n)?n.value=e:null),title:"选择Sheet"},{footer:c((()=>[y("span",tl,[g(u,{onClick:a[1]||(a[1]=e=>n.value=!1)},{default:c((()=>[al])),_:1}),g(u,{type:"primary",onClick:i},{default:c((()=>[ll])),_:1})])])),default:c((()=>[y("p",null,I(e.fileName),1),g(Xa,{text:"Sheet"}),g(s,{modelValue:e.sheetIndex,"onUpdate:modelValue":a[0]||(a[0]=e=>J(sheetIndex)?sheetIndex.value=e:null),onChange:r},{default:c((()=>[(h(!0),w(k,null,S(O(l),(e=>(h(),p(o,{label:e.index,border:""},{default:c((()=>[D(I(e.label),1)])),_:2},1032,["label"])))),256))])),_:1},8,["modelValue"])])),_:1},8,["modelValue"])}}}),rl=y("h2",{style:{"text-align":"center"}},"2023年1月份留资数据格式化",-1),il=[{path:"/",name:"index",component:St,meta:{menuHidden:!0},children:[{path:"/",name:"dashboard",component:Tt,meta:{title:"首页"}},{path:"/volume",name:"volume",component:gt,meta:{title:"体积计算"}},{path:"/tongji",name:"tongji",component:Qe,meta:{title:"品牌统计"}},{path:"/ftms",name:"ftms",component:d({setup(e){const{uploadType:t,sheetDialogConfig:a,openSheetDialog:l,workBook:n,handleSheetSelect:r}=Wa(),i=e=>{var t;(t=e,new Promise(((e,a)=>{let l=new FileReader;l.onload=t=>{var l;try{e(Ve(null==(l=t.target)?void 0:l.result))}catch(n){a(n)}},l.readAsArrayBuffer(t)}))).then((t=>{let a=t;n.value=a,l(e.name,n.value.SheetNames)})).catch((e=>{n.value=void 0,H.error(e.message),console.error(e)}))};return(e,l)=>{const n=$,o=Y;return h(),w(k,null,[rl,g(Za),g(o,{gutter:20},{default:c((()=>[g(n,{span:12},{default:c((()=>[g(Ba),g(el)])),_:1}),g(n,{span:12},{default:c((()=>[g($a,{modelValue:O(t),"onUpdate:modelValue":l[0]||(l[0]=e=>J(t)?t.value=e:null)},null,8,["modelValue"]),g(Da,{onChange:i})])),_:1})])),_:1}),g(nl,{sheetIndex:O(a).sheetIndex,"onUpdate:sheetIndex":l[1]||(l[1]=e=>O(a).sheetIndex=e),visible:O(a).visible,"onUpdate:visible":l[2]||(l[2]=e=>O(a).visible=e),"sheet-names":O(a).sheetNames,onSelect:O(r),"file-name":O(a).fileName},null,8,["sheetIndex","visible","sheet-names","onSelect","file-name"])],64)}}}),meta:{title:"留资数据格式化"}},{path:"dingnengorder",name:"dingnengOrder",redirect:"/dingnengorder/create",meta:{title:"鼎能面单"},children:[{path:"create",name:"dingnengOrderCreate",component:Kt,meta:{menuHidden:!0}}]},{path:"/:pathMatch(.*)*",name:"NotFound",component:Et,meta:{menuHidden:!0}}]},{path:"/dingnengorder/print",name:"dingnengOrderPrint",component:_a,meta:{menuHidden:!0}}],ol=_e({history:xe(),routes:il});const sl=u();M(Ae).use(ol).use(sl).mount("#app");
