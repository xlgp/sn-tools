var e=Object.defineProperty,t=Object.defineProperties,a=Object.getOwnPropertyDescriptors,l=Object.getOwnPropertySymbols,n=Object.prototype.hasOwnProperty,r=Object.prototype.propertyIsEnumerable,i=(t,a,l)=>a in t?e(t,a,{enumerable:!0,configurable:!0,writable:!0,value:l}):t[a]=l;import{d as o,s,c as u}from"../js1/_pinia-e65071c3.js";import{j as d,K as p,L as c,ad as m,o as h,U as g,f,i as b,e as v,a as y,M as _,O as x,c as w,a6 as S,V as k,al as V,am as j,S as I,T as D,r as A,p as C,H as T,h as L,u as E,Z as O,E as J,w as P,R as N,an as M}from"../js1/_@vue-f7294240.js";import{z as U,E as R,a as z,b as F,c as q,d as K,e as X,f as $,g as Y,h as B,i as H,j as G,k as Q,l as W,m as Z,n as ee,o as te,p as ae,q as le,r as ne,s as re,t as ie,u as oe,v as se,w as ue,x as de,y as pe,A as ce,B as me,C as he}from"../js1/_element-plus-2f6a2c97.js";import{L as ge,M as fe,N as be,O as ve,P as ye,Q as _e}from"../js1/__vendor-b04b9ce5.js";import{y as xe,q as we,A as Se}from"../js1/_@element-plus-4bd16d9e.js";import{r as ke,u as Ve,w as je}from"../js1/_xlsx-8913e6cb.js";!function(){const e=document.createElement("link").relList;if(!(e&&e.supports&&e.supports("modulepreload"))){for(const e of document.querySelectorAll('link[rel="modulepreload"]'))t(e);new MutationObserver((e=>{for(const a of e)if("childList"===a.type)for(const e of a.addedNodes)"LINK"===e.tagName&&"modulepreload"===e.rel&&t(e)})).observe(document,{childList:!0,subtree:!0})}function t(e){if(e.ep)return;e.ep=!0;const t=function(e){const t={};return e.integrity&&(t.integrity=e.integrity),e.referrerpolicy&&(t.referrerPolicy=e.referrerpolicy),"use-credentials"===e.crossorigin?t.credentials="include":"anonymous"===e.crossorigin?t.credentials="omit":t.credentials="same-origin",t}(e);fetch(e.href,t)}}();var Ie=(e,t)=>{const a=e.__vccOpts||e;for(const[l,n]of t)a[l]=n;return a};var De=Ie(d({name:"App",setup:()=>({zIndex:3e3,locale:U})}),[["render",function(e,t,a,l,n,r){const i=m("router-view"),o=R;return h(),p(o,{locale:e.locale,"z-index":e.zIndex},{default:c((()=>[g(i)])),_:1},8,["locale","z-index"])}]]);const Ae=[{name:"奥德赛",leibie:"日本",parent:"本田"},{name:"宝马",leibie:"德国",parent:""},{name:"北京现代",leibie:"其他",parent:""},{name:"奔驰",leibie:"德国",parent:""},{name:"奥迪",leibie:"德国",parent:""},{name:"比亚迪",leibie:"中国",parent:""},{name:"别克",leibie:"美国",parent:""},{name:"宾利",leibie:"英国",parent:""},{name:"长安",leibie:"中国",parent:""},{name:"大众",leibie:"德国",parent:""},{name:"谛艾仕",leibie:"法国",parent:""},{name:"帝豪",leibie:"中国",parent:""},{name:"东风日产",leibie:"其他",parent:""},{name:"东风天龙",leibie:"中国",parent:"吉利"},{name:"东风雪铁龙",leibie:"其他",parent:""},{name:"东风悦达起亚",leibie:"其他",parent:""},{name:"风神",leibie:"中国",parent:""},{name:"丰田",leibie:"日本",parent:""},{name:"广丰",leibie:"日本",parent:"丰田"},{name:"福特",leibie:"美国",parent:""},{name:"福田",leibie:"中国",parent:""},{name:"广汽本田",leibie:"其他",parent:""},{name:"哈弗",leibie:"中国",parent:""},{name:"江淮",leibie:"中国",parent:""},{name:"捷豹",leibie:"英国",parent:""},{name:"晶马",leibie:"中国",parent:""},{name:"凯迪拉克",leibie:"美国",parent:"江铃"},{name:"路虎",leibie:"英国",parent:""},{name:"玛莎拉蒂",leibie:"意大利",parent:""},{name:"马自达",leibie:"日本",parent:""},{name:"尼桑",leibie:"日本",parent:""},{name:"欧曼",leibie:"其他",parent:""},{name:"荣威",leibie:"中国",parent:""},{name:"三菱",leibie:"日本",parent:""},{name:"尚酷",leibie:"德国",parent:"大众"},{name:"斯柯达",leibie:"德国",parent:""},{name:"索兰托",leibie:"韩国",parent:"起亚"},{name:"特斯拉",leibie:"美国",parent:""},{name:"沃尔沃",leibie:"瑞典",parent:""},{name:"五菱",leibie:"中国",parent:""},{name:"现代",leibie:"韩国",parent:""},{name:"雪佛兰",leibie:"美国",parent:""},{name:"雅阁",leibie:"日本",parent:"本田"},{name:"缤智",leibie:"日本",parent:"本田"},{name:"英菲尼迪",leibie:"日本",parent:""},{name:"中华",leibie:"中国",parent:""},{name:"中骏",leibie:"中国",parent:""},{name:"中联",leibie:"中国",parent:""},{name:"东风",leibie:"中国",parent:""},{name:"克莱斯勒",leibie:"美国",parent:""},{name:"北京",leibie:"中国",parent:""},{name:"长城",leibie:"中国",parent:""},{name:"奥铃",leibie:"中国",parent:"福田"},{name:"海马",leibie:"中国",parent:""},{name:"红旗",leibie:"中国",parent:""},{name:"几何",leibie:"中国",parent:"吉利"},{name:"庆铃",leibie:"中国",parent:""},{name:"思威",leibie:"日本",parent:"本田"},{name:"腾势",leibie:"其他",parent:""},{name:"翼虎",leibie:"中国",parent:"长安"},{name:"欧拉",leibie:"中国",parent:"长城"},{name:"远程",leibie:"中国",parent:"吉利"},{name:"圣玛托",leibie:"美国",parent:""},{name:"捷途",leibie:"中国",parent:"奇瑞"},{name:"长城风骏7",leibie:"中国",parent:"长城"}];var Ce=e=>{let t="无品牌类别",a=()=>{let a=[];return null!=e.value&&e.value.length>0&&(a=e.value.split("\n")),a.length>0&&(a=a.filter((e=>null!=e&&e.length>0))),0==a.length?[]:a.map((e=>{let a=e.split("\t"),l={};l.date=a[0]&&a[0].trim()||"无日期",l.dingsunyuan=a[1]&&a[1].trim()||"无定损员",l.xiaoshouyuan=a[2]&&a[2].trim()||"无销售员",l.chepai=a[3]&&a[3].trim()||"车牌",l.pinpai=a[4]&&a[4].trim()||"品牌",l.isChengJiao=!(!a[5]||"是"!=a[5].trim()),l.jine=a[6]&&parseInt(a[6].trim())||0,l.pinpai_leibie=t;try{"品牌"!=l.pinpai&&(l.pinpai_leibie=(n=l.pinpai,Ae.filter((e=>e.name==n||e.parent==n)))[0].leibie)}catch(r){console.error(l,r)}var n;return l}))};const l=f((()=>a())),n=f((()=>{let e=0;return l.value&&l.value.length>0&&l.value.forEach((t=>{isNaN(t.jine)||(e+=t.jine)})),e})),r=f((()=>l.value&&l.value.length>0?l.value.filter((e=>e.pinpai_leibie==t)):[])),i=f((()=>{let e=0,t=[];return l.value&&l.value.length>0&&(t=l.value.filter((t=>!!t.isChengJiao&&(e+=t.jine,!0)))),{list:t,totalAmount:e}}));return{dataList:l,totalAmount:n,chengJiaoData:i,noPinPaiDataList:r}},Te=(e,t,a)=>f((()=>function(){let l=["询价单数","询价金额","供应单数","供应金额","未供应单数","未供应金额"],n=[];if(e.value&&e.value.length>0){n.push({key:l[0],num:e.value.length,rate:1}),n.push({key:l[1],num:t.value,rate:1}),n.push({key:l[2],num:a.value.list.length,rate:a.value.list.length/e.value.length}),n.push({key:l[3],num:a.value.totalAmount,rate:a.value.totalAmount/t.value});let r=e.value.length-a.value.list.length;n.push({key:l[4],num:r,rate:r/e.value.length});let i=t.value-a.value.totalAmount;n.push({key:l[5],num:i,rate:i/t.value})}return n}()));const Le=d({name:"TotalAnalyse",setup(){const e=b("dataList"),t=b("totalAmount"),a=b("chengJiaoData"),l=Te(e,t,a);return v((()=>{new ge("#totalTable")})),{totalAnalyse:l}}}),Ee=y("span",null,"报价总量分析",-1);var Oe=Ie(Le,[["render",function(e,t,a,l,n,r){const i=z,o=F,s=q;return h(),p(s,{class:"box-card",id:"totalCard"},{header:c((()=>[Ee])),default:c((()=>[g(o,{data:e.totalAnalyse,id:"totalTable","data-clipboard-target":"#totalCard",style:{width:"100%"},size:"small"},{default:c((()=>[g(i,{type:"index",label:"序号"}),g(i,{prop:"key",label:"类型"}),g(i,{prop:"num",label:"数量"}),g(i,{prop:"rate",label:"占比"})])),_:1},8,["data"])])),_:1})}]]);var Je=(e,t)=>{function a(){let a={};return e.value&&e.value.length>0&&(e.value.sort(((e,t)=>e.pinpai_leibie.localeCompare(t.pinpai_leibie))),e.value.forEach((e=>{var t;a[e.pinpai_leibie]?function(e,t){e.total+=1,e.jine+=t.jine,e.chengJiaoTotal+=t.isChengJiao?1:0,e.chengJiaoJine+=t.isChengJiao&&t.jine||0}(a[e.pinpai_leibie],e):a[e.pinpai_leibie]={pinpai_leibie:(t=e).pinpai_leibie,total:1,jine:t.jine,totalRate:0,jineRate:0,chengJiaoTotal:t.isChengJiao?1:0,chengJiaoJine:t.isChengJiao&&t.jine||0}})),function(e,t,a){Object.keys(e).forEach((l=>{e[l].totalRate=e[l].total/t,e[l].jineRate=e[l].jine/a}))}(a,e.value.length,t.value)),a}return f((()=>a()))};const Pe=d({name:"PinPaiAnalyse",setup(){const e=b("dataList"),t=b("totalAmount"),a=Je(e,t),l=f((()=>Object.values(a.value)));return v((()=>{new ge("#pinpaiTable")})),{tableData:l}}}),Ne=y("span",null,"品牌构成分析",-1);var Me=Ie(Pe,[["render",function(e,t,a,l,n,r){const i=z,o=F,s=q;return h(),p(s,{class:"box-card",id:"pinpaiCard"},{header:c((()=>[Ne])),default:c((()=>[g(o,{data:e.tableData,id:"pinpaiTable","data-clipboard-target":"#pinpaiCard",style:{width:"100%"},size:"small","show-summary":""},{default:c((()=>[g(i,{type:"index",label:"序号"}),g(i,{prop:"pinpai_leibie",label:"类型"}),g(i,{prop:"total",label:"数量（份）"}),g(i,{prop:"jine",label:"金额"}),g(i,{prop:"totalRate",label:"数量占比"}),g(i,{prop:"jineRate",label:"金额占比"}),g(i,{prop:"chengJiaoTotal",label:"成交数量"}),g(i,{prop:"chengJiaoJine",label:"成交金额"})])),_:1},8,["data"])])),_:1})}]]);var Ue=(e,t)=>{let a=()=>{let a={};return e.value&&e.value.length>0&&(e.value.sort(((e,t)=>e.dingsunyuan.localeCompare(t.dingsunyuan))),e.value.forEach((e=>{var t;a[e.dingsunyuan]?function(e,t){e.total+=1,e.jine+=t.jine,e.chengJiaoTotal+=t.isChengJiao?1:0,e.chengJiaoJine+=t.isChengJiao&&t.jine||0}(a[e.dingsunyuan],e):a[e.dingsunyuan]={total:1,jine:(t=e).jine,totalRate:0,jineRate:0,chengJiaoTotal:t.isChengJiao?1:0,chengJiaoJine:t.isChengJiao&&t.jine||0,dingsunyuan:t.dingsunyuan}})),function(e,t,a){Object.keys(e).forEach((l=>{e[l].totalRate=e[l].total/t,e[l].jineRate=e[l].jine/a}))}(a,e.value.length,t.value)),a};return f((()=>a()))};const Re=d({name:"DingSunYuanAnalyse",setup(){const e=b("dataList"),t=b("totalAmount"),a=Ue(e,t),l=f((()=>Object.values(a.value)));return v((()=>{new ge("#dsytable")})),{tableData:l}}}),ze=y("span",null,"定损员分析",-1);var Fe=Ie(Re,[["render",function(e,t,a,l,n,r){const i=z,o=F,s=q;return h(),p(s,{class:"box-card",id:"dsycard"},{header:c((()=>[ze])),default:c((()=>[g(o,{data:e.tableData,id:"dsytable","data-clipboard-target":"#dsycard",style:{width:"100%"},size:"small","show-summary":""},{default:c((()=>[g(i,{type:"index",label:"序号"}),g(i,{prop:"dingsunyuan",label:"类型"}),g(i,{prop:"total",label:"数量（份）"}),g(i,{prop:"jine",label:"金额"}),g(i,{prop:"totalRate",label:"数量占比"}),g(i,{prop:"jineRate",label:"金额占比"}),g(i,{prop:"chengJiaoTotal",label:"成交数量"}),g(i,{prop:"chengJiaoJine",label:"成交金额"})])),_:1},8,["data"])])),_:1})}]]);const qe=d({name:"DingSunYuanAnalyse",setup(){const e=b("dataList"),t=f((()=>{let t={};return e.value&&e.value.length>0?(e.value.sort(((e,t)=>e.xiaoshouyuan.localeCompare(t.xiaoshouyuan))),e.value.forEach((e=>{t[e.xiaoshouyuan]?(t[e.xiaoshouyuan].total+=1,t[e.xiaoshouyuan].chengJiaoTotal+=e.isChengJiao?1:0):t[e.xiaoshouyuan]={xiaoshouyuan:e.xiaoshouyuan,total:1,chengJiaoTotal:e.isChengJiao?1:0}})),Object.values(t)):[]}));return v((()=>{new ge("#xsytable")})),{tableData:t}}}),Ke=y("span",null,"销售员分析",-1);var Xe=Ie(qe,[["render",function(e,t,a,l,n,r){const i=z,o=F,s=q;return h(),p(s,{class:"box-card",id:"xsycard"},{header:c((()=>[Ke])),default:c((()=>[g(o,{data:e.tableData,id:"xsytable","data-clipboard-target":"#xsycard",style:{width:"100%"},size:"small","show-summary":""},{default:c((()=>[g(i,{type:"index",label:"序号"}),g(i,{prop:"xiaoshouyuan",label:"销售员"}),g(i,{prop:"total",label:"总量"}),g(i,{prop:"chengJiaoTotal",label:"成交数量"})])),_:1},8,["data"])])),_:1})}]]);const $e=d({name:"NoPinPaiList",setup(){const e=b("noPinPaiList"),t=f((()=>e.value.length>0));return{noPinPaiList:e,showable:t}}}),Ye=(e=>(V("data-v-bf8ffa0c"),e=e(),j(),e))((()=>y("span",null,"无品牌类型",-1)));const Be=d({name:"TongJi",components:{TotalAnalyse:Oe,PinPaiAnalyse:Me,DingSunYuanAnalyse:Fe,XiaoShouYuanAnalyse:Xe,NoPinPaiList:Ie($e,[["render",function(e,t,a,l,n,r){const i=K,o=q;return _((h(),p(o,{class:"box-card"},{header:c((()=>[Ye])),default:c((()=>[(h(!0),w(k,null,S(e.noPinPaiList,((e,t)=>(h(),p(i,{key:t},{default:c((()=>[I(D(e.pinpai),1)])),_:2},1024)))),128))])),_:1},512)),[[x,e.showable]])}],["__scopeId","data-v-bf8ffa0c"]])},setup(){const e={date:"日期",dingsunyuan:"定损员",xiaoshouyuan:"销售员",chepai:"车牌",pinpai:"品牌",isChengJiao:"是否成交",jine:"金额",pinpai_leibie:"品牌类别"},t=A(""),{dataList:a,totalAmount:l,chengJiaoData:n,noPinPaiDataList:r}=Ce(t);return C("dataList",a),C("totalAmount",l),C("chengJiaoData",n),C("noPinPaiList",r),{headTableItem:e,content:t,dataList:a,totalAmount:l,chengJiaoData:n}}}),He={style:{width:"100%"}};var Ge=Ie(Be,[["render",function(e,t,a,l,n,r){const i=X,o=$,s=m("no-pin-pai-list"),u=m("total-analyse"),d=m("ding-sun-yuan-analyse"),p=Y,f=m("xiao-shou-yuan-analyse"),b=m("pin-pai-analyse");return h(),w(k,null,[g(o,null,{default:c((()=>[y("table",He,[y("tr",null,[(h(!0),w(k,null,S(e.headTableItem,((e,t)=>(h(),w("th",{key:t},D(e),1)))),128))])]),g(i,{modelValue:e.content,"onUpdate:modelValue":t[0]||(t[0]=t=>e.content=t),rows:22,type:"textarea",placeholder:"请复制数据至此"},null,8,["modelValue"])])),_:1}),g(o,null,{default:c((()=>[g(s)])),_:1}),g(o,{gutter:10},{default:c((()=>[g(p,{span:12},{default:c((()=>[g(u),g(d)])),_:1}),g(p,{span:12},{default:c((()=>[g(f),g(b)])),_:1})])),_:1})],64)}]]);const Qe=e=>(V("data-v-23336cac"),e=e(),j(),e),We={class:"card-header"},Ze=Qe((()=>y("span",{style:{color:"var(--el-color-info)"}},"点击可自动复制",-1))),et=I("打开腾讯文档"),tt=Qe((()=>y("span",null,"计算后结果",-1))),at=Qe((()=>y("span",null,"结果",-1)));var lt=Ie(d({props:{showComputedList:Array,totalCount:[Number,String],showList:Array,region:String},setup(e){const{toClipboard:t}=fe(),a=A("https://docs.qq.com/sheet/DS0FkVVhwd29KdHNk"),l=async e=>{try{if(null==e)return;let a=Array.isArray(e)&&e.join("\n")||e.toString();await t(a),H({message:"复制成功",type:"success"})}catch(a){console.error(a),H.error(a.message||"真奇怪，不知道哪里错了。")}};return(t,n)=>{const r=B,i=Y,o=$,s=q;return h(),w("div",null,[g(s,null,{header:c((()=>[y("div",We,[Ze,g(r,{type:"primary",href:a.value,target:"_blank"},{default:c((()=>[et])),_:1},8,["href"])])])),default:c((()=>[g(o,{gutter:10},{default:c((()=>[g(i,{span:10},{default:c((()=>[T(t.$slots,"default",{},void 0,!0)])),_:3}),g(i,{span:14,onClick:n[0]||(n[0]=t=>l(e.totalCount))},{default:c((()=>[I(" 总计："+D(e.totalCount),1)])),_:1})])),_:3})])),_:3}),g(o,null,{default:c((()=>[g(i,{span:16},{default:c((()=>[g(s,{onClick:n[1]||(n[1]=t=>l(e.showComputedList))},{header:c((()=>[tt])),default:c((()=>[(h(!0),w(k,null,S(e.showComputedList,((e,t)=>(h(),w("div",{key:t},D(e),1)))),128))])),_:1})])),_:1}),g(i,{span:8},{default:c((()=>[g(s,{onClick:n[2]||(n[2]=t=>l(e.showList))},{header:c((()=>[at])),default:c((()=>[(h(!0),w(k,null,S(e.showList,((e,t)=>(h(),w("div",{key:t},D(e),1)))),128))])),_:1})])),_:1})])),_:1})])}}}),[["__scopeId","data-v-23336cac"]]);const nt={class:"upload-wapper"},rt={class:"el-image"},it=["src"],ot={class:"tips"},st=y("small",{style:{color:"var(--el-text-color-disabled)"}},"图片可缩放，也可移动",-1),ut=I("图片还原"),dt=y("div",{class:"el-upload__text"},"拖拽或上传文件",-1),pt=d({setup(e){const t=A(),a=A(""),l=A(1),n=A(1);A(null);const{handleMousedown:r,handleMousemove:i,handleMouseup:o,translate:s,init:u}=(()=>{const e={x:0,y:0},t=L({x:0,y:0});let a=!1;return{handleMousedown:t=>{a=!0,e.x=t.clientX,e.y=t.clientY,t.preventDefault()},handleMousemove:l=>(a&&(t.x=l.clientX-e.x,t.y=l.clientY-e.y),!1),handleMouseup:e=>{a=!1},translate:t,init:()=>{t.x=0,t.y=0}}})(),d=e=>{e&&e.hasOwnProperty("url")&&(a.value=e.url||"")},p=()=>{n.value=1,u()},m=e=>{t.value.clearFiles();const a=e[0];a.uid=+new Date,t.value.handleStart(a)},f=e=>(e.deltaY<0?n.value<2?n.value+=.2:n.value=2:e.deltaY>0&&(n.value>.4?n.value-=.2:n.value=.4),!1);return(e,u)=>{const b=G,v=Q;return h(),w("div",nt,[y("div",rt,[y("img",{src:a.value,onWheel:f,onMousemove:u[0]||(u[0]=(...e)=>E(i)&&E(i)(...e)),onMousedown:u[1]||(u[1]=(...e)=>E(r)&&E(r)(...e)),onMouseup:u[2]||(u[2]=(...e)=>E(o)&&E(o)(...e)),style:O({transform:"scale("+n.value+") translate("+E(s).x+"px, "+E(s).y+"px)","object-fit":"contain"}),class:"el-image__inner"},null,44,it)]),y("p",ot,[st,y("span",{onClick:p},[ut,g(b,null,{default:c((()=>[g(E(xe))])),_:1})])]),g(v,{action:"#",drag:"",ref_key:"upload",ref:t,"auto-upload":!1,limit:l.value,"list-type":"picture","on-change":d,"on-exceed":m},{default:c((()=>[g(b,{class:"el-icon--upload"},{default:c((()=>[g(E(we))])),_:1}),dt])),_:1},8,["limit"])])}}});const ct=I("地区"),mt=y("legend",null,"分隔符：",-1),ht=d({setup(e){const t=A(""),a=A(["请在此输入输入","一行一组","以空格相格","例如：","123 32 23 3","56 65 45 3","234 42 34 6"].join("\n")),l={SPACE:{label:"空格",value:" "},X:{label:"X;",value:"X"}},n=A(""),r=A(l.SPACE.value);let i=f((()=>{let e=t.value.trim();if(!e)return[];let a=e.split("\n");return a&&0!=a.length?(a[0].includes(l.X.value)?r.value=l.X.value:r.value=l.SPACE.value,a.map((e=>{let t=function(e,t){if(t==l.SPACE.value)return e.trim().split(t);if(t==l.X.value){let a=e.trim().split(t),l=a[2].split(";");return[a[0],a[1],l[0],l[1]]}}(e,r.value);return{len:t[0],width:t[1],height:t[2],count:t[3]}}))):[]})),o=f((()=>i.value.map((e=>e.len+"X"+e.width+"X"+e.height+";"+e.count)))),s=f((()=>i.value.map((e=>e.len+"X"+e.width+"X"+e.height+"X"+e.count+"="+e.len*e.width*e.height*e.count)))),u=f((()=>{let e=0;return i.value.forEach((t=>{e+=t.len*t.width*t.height*t.count})),e}));return(e,i)=>{const d=X,m=Y,f=W,b=Z,v=$;return h(),p(v,{gutter:20},{default:c((()=>[g(m,{span:10},{default:c((()=>[g(lt,{"total-count":E(u),"show-computed-list":E(s),"show-list":E(o),region:n.value},{default:c((()=>[g(d,{modelValue:n.value,"onUpdate:modelValue":i[0]||(i[0]=e=>n.value=e),placeholder:"请输入地区"},{prepend:c((()=>[ct])),_:1},8,["modelValue"])])),_:1},8,["total-count","show-computed-list","show-list","region"])])),_:1}),g(m,{span:4},{default:c((()=>[y("fieldset",null,[mt,g(b,{modelValue:r.value,"onUpdate:modelValue":i[1]||(i[1]=e=>r.value=e)},{default:c((()=>[(h(),w(k,null,S(l,(e=>g(f,{label:e.value,size:"small",border:""},{default:c((()=>[I(D(e.label),1)])),_:2},1032,["label"]))),64))])),_:1},8,["modelValue"])]),g(d,{modelValue:t.value,"onUpdate:modelValue":i[2]||(i[2]=e=>t.value=e),rows:20,type:"textarea",placeholder:a.value,style:{"font-size":"large"}},null,8,["modelValue","placeholder"])])),_:1}),g(m,{span:10},{default:c((()=>[g(pt)])),_:1})])),_:1})}}});var gt="1.1.9";const ft={class:"version"};var bt=Ie(d({setup(e){const t=A(gt);return(e,a)=>(h(),w("div",ft,D(t.value),1))}}),[["__scopeId","data-v-61ecf5df"]]);var vt=Ie(d({setup(e){const t=be().getRoutes().filter((e=>!e.meta.menuHidden));return(e,a)=>{const l=m("router-link");return h(),w("div",null,[(h(!0),w(k,null,S(E(t),(e=>(h(),p(l,{to:e.path,key:e.path,class:"link"},{default:c((()=>[I(D(e.meta.title),1)])),_:2},1032,["to"])))),128))])}}}),[["__scopeId","data-v-254a3844"]]);const yt={},_t={style:{float:"right",cursor:"pointer"},href:"https://gitee.com/hzsn-csh/sn-tools",target:"_blank"},xt=[y("img",{alt:"Gitee",src:"/sn-tools/img/logo-gitee-g.svg",title:"Gitee — 基于 Git 的代码托管和研发协作平台",style:{height:"36px","margin-top":"12px"}},null,-1)];var wt=Ie(yt,[["render",function(e,t){return h(),w("a",_t,xt)}]]);const St={},kt=I("小工具");var Vt=Ie(St,[["render",function(e,t){const a=wt,l=ee,n=vt,r=bt,i=te,o=m("router-view"),s=ae,u=le;return h(),p(u,null,{default:c((()=>[g(l,null,{default:c((()=>[kt,g(a)])),_:1}),g(u,{class:"container"},{default:c((()=>[g(i,{width:"200px"},{default:c((()=>[g(n),g(r)])),_:1}),g(s,null,{default:c((()=>[g(o)])),_:1})])),_:1})])),_:1})}],["__scopeId","data-v-5854b6eb"]]);const jt={},It=I("体积计算"),Dt=I("体积计算"),At=I("品牌统计"),Ct=I("品牌统计"),Tt=I("鼎能面单"),Lt=I("鼎能面单");var Et=Ie(jt,[["render",function(e,t){const a=m("router-link"),l=q,n=Y,r=$;return h(),p(r,{gutter:20},{default:c((()=>[g(n,{span:6},{default:c((()=>[g(l,null,{header:c((()=>[It])),default:c((()=>[g(a,{to:"/volume"},{default:c((()=>[Dt])),_:1})])),_:1})])),_:1}),g(n,{span:6},{default:c((()=>[g(l,null,{header:c((()=>[At])),default:c((()=>[g(a,{to:"/tongji"},{default:c((()=>[Ct])),_:1})])),_:1})])),_:1}),g(n,{span:6},{default:c((()=>[g(l,null,{header:c((()=>[Tt])),default:c((()=>[g(a,{to:"/dingnengorder"},{default:c((()=>[Lt])),_:1})])),_:1})])),_:1})])),_:1})}]]);const Ot={},Jt=I("回首页");var Pt=Ie(Ot,[["render",function(e,t){const a=ne,l=m("router-link"),n=re;return h(),p(n,{icon:"error",title:"404","sub-title":"not found"},{extra:c((()=>[g(l,{to:"/"},{default:c((()=>[g(a,{type:"primary"},{default:c((()=>[Jt])),_:1})])),_:1})])),_:1})}]]),Nt={sender:[{required:!0,message:"请输入发货人",trigger:"blur"}],sender_phone:[{required:!0,message:"请输入发货人电话",trigger:"blur"}],recipient_company:[{required:!0,message:"请输入收货单位",trigger:"blur"}],recipient:[{required:!0,message:"请输入收货人",trigger:"blur"}],recipient_phone:[{required:!0,message:"请输入收货人电话",trigger:"blur"}],address:[{required:!0,message:"请输入收货地址",trigger:"blur"}],send_time:[{required:!0,message:"请输入发运时间",trigger:"change"}],recipient_time:[{required:!0,message:"请输入收货时间",trigger:"change"}],total_volume:[{type:"number",required:!0,message:"请输入总体积，数字类型",trigger:"blur"}],total_weight:[{type:"number",required:!0,message:"请输入总重量，数字类型",trigger:"blur"}],delivery_user:[{required:!0,message:"请输入提货人",trigger:"blur"}],remark:[]};const Mt=[{key:"zhixiang",value:0,text:"纸箱"},{key:"muxiang",value:0,text:"木箱"},{key:"tiejian",value:0,text:"铁件"},{key:"qita",value:0,text:"其他"}],Ut=o("dingnengOrder",{state:()=>({dn_order_id:"",sender:"",sender_phone:"",recipient_company:"",recipient:"",recipient_phone:"",address:"",goodsList:[],send_time:0,recipient_time:0,total_volume:0,total_weight:0,delivery_user:"",remark:""}),getters:{total_count:e=>{let t=0;return e.goodsList.forEach((e=>{t+=e.value})),t}},actions:{createDNOrderId:()=>"DN"+(new Date).getTime()+Math.floor(1e3*Math.random()),getGoodsList:()=>Object.assign([],Mt).map((e=>(e.value=0,e))),getFromStorage:()=>({sender:localStorage.getItem("sender")||"",sender_phone:localStorage.getItem("sender_phone")||"",delivery_user:localStorage.getItem("delivery_user")||""}),saveToStorage(){localStorage.setItem("sender",this.sender),localStorage.setItem("sender_phone",this.sender_phone),localStorage.setItem("delivery_user",this.delivery_user)},init(){this.$reset(),this.goodsList=this.getGoodsList(),this.dn_order_id=this.createDNOrderId();let e=this.getFromStorage();this.sender=e.sender,this.sender_phone=e.sender_phone,this.delivery_user=e.delivery_user,this.send_time=+new Date,this.recipient_time=+new Date}}}),Rt={style:{width:"600px",margin:"auto"}},zt=y("h3",{style:{"text-align":"center",color:"var(--el-text-color-primary)"}},"创建面单",-1),Ft=I("m³"),qt=I("KG"),Kt=I("打印"),Xt=I("重置"),$t=d({setup(e){const t=A(),a=Ut();a.init();const l=a.$state,n=be(),r=async()=>{t&&await t.value.validate((e=>{e&&(a.saveToStorage(),n.push({name:"dingnengOrderPrint"}))}))},i=()=>{t&&a.init()};return(e,a)=>{const n=X,o=ie,s=Y,u=$,d=oe,m=se,f=ne,b=ue;return h(),w("div",Rt,[zt,g(b,{ref_key:"elFormRef",ref:t,model:E(l),rules:E(Nt),"label-width":"100px"},{default:c((()=>[g(u,null,{default:c((()=>[g(s,{span:12},{default:c((()=>[g(o,{label:"发货人",prop:"sender"},{default:c((()=>[g(n,{modelValue:E(l).sender,"onUpdate:modelValue":a[0]||(a[0]=e=>E(l).sender=e),placeholder:"请输入发货人",clearable:"",style:{width:"100%"}},null,8,["modelValue"])])),_:1})])),_:1}),g(s,{span:12},{default:c((()=>[g(o,{label:"发货人电话",prop:"sender_phone"},{default:c((()=>[g(n,{modelValue:E(l).sender_phone,"onUpdate:modelValue":a[1]||(a[1]=e=>E(l).sender_phone=e),placeholder:"请输入发货人电话",clearable:"",style:{width:"100%"}},null,8,["modelValue"])])),_:1})])),_:1})])),_:1}),g(o,{label:"收货单位",prop:"recipient_company"},{default:c((()=>[g(n,{modelValue:E(l).recipient_company,"onUpdate:modelValue":a[2]||(a[2]=e=>E(l).recipient_company=e),placeholder:"请输入收货单位",clearable:"",style:{width:"100%"}},null,8,["modelValue"])])),_:1}),g(u,null,{default:c((()=>[g(s,{span:12},{default:c((()=>[g(o,{label:"收货人",prop:"recipient"},{default:c((()=>[g(n,{modelValue:E(l).recipient,"onUpdate:modelValue":a[3]||(a[3]=e=>E(l).recipient=e),placeholder:"请输入收货人",clearable:"",style:{width:"100%"}},null,8,["modelValue"])])),_:1})])),_:1}),g(s,{span:12},{default:c((()=>[g(o,{label:"收货人电话",prop:"recipient_phone"},{default:c((()=>[g(n,{modelValue:E(l).recipient_phone,"onUpdate:modelValue":a[4]||(a[4]=e=>E(l).recipient_phone=e),placeholder:"请输入收货人电话",clearable:"",style:{width:"100%"}},null,8,["modelValue"])])),_:1})])),_:1})])),_:1}),g(o,{label:"收货地址",prop:"address"},{default:c((()=>[g(n,{modelValue:E(l).address,"onUpdate:modelValue":a[5]||(a[5]=e=>E(l).address=e),placeholder:"请输入收货地址",clearable:"",style:{width:"100%"}},null,8,["modelValue"])])),_:1}),g(u,null,{default:c((()=>[(h(!0),w(k,null,S(E(l).goodsList,((e,t)=>(h(),p(s,{span:12,key:e.key},{default:c((()=>[g(o,{label:e.text},{default:c((()=>[g(d,{modelValue:e.value,"onUpdate:modelValue":t=>e.value=t,placeholder:"请输入"+e.text,step:1,max:1e3},null,8,["modelValue","onUpdate:modelValue","placeholder"])])),_:2},1032,["label"])])),_:2},1024)))),128))])),_:1}),g(u,null,{default:c((()=>[g(s,{span:12},{default:c((()=>[g(o,{label:"发运时间",prop:"send_time"},{default:c((()=>[g(m,{type:"datetime",modelValue:E(l).send_time,"onUpdate:modelValue":a[6]||(a[6]=e=>E(l).send_time=e),placeholder:"请输入发运时间",clearable:"","value-format":"x"},null,8,["modelValue"])])),_:1})])),_:1}),g(s,{span:12},{default:c((()=>[g(o,{label:"收货时间",prop:"recipient_time"},{default:c((()=>[g(m,{type:"datetime",modelValue:E(l).recipient_time,"onUpdate:modelValue":a[7]||(a[7]=e=>E(l).recipient_time=e),placeholder:"请输入收货时间",clearable:"","value-format":"x"},null,8,["modelValue"])])),_:1})])),_:1})])),_:1}),g(u,null,{default:c((()=>[g(s,{span:12},{default:c((()=>[g(o,{label:"总体积",prop:"total_volume"},{default:c((()=>[g(n,{modelValue:E(l).total_volume,"onUpdate:modelValue":a[8]||(a[8]=e=>E(l).total_volume=e),modelModifiers:{number:!0},placeholder:"请输入总体积",clearable:"",style:{width:"100%"}},{append:c((()=>[Ft])),_:1},8,["modelValue"])])),_:1})])),_:1}),g(s,{span:12},{default:c((()=>[g(o,{label:"总重量",prop:"total_weight"},{default:c((()=>[g(n,{modelValue:E(l).total_weight,"onUpdate:modelValue":a[9]||(a[9]=e=>E(l).total_weight=e),modelModifiers:{number:!0},placeholder:"请输入总重量",clearable:""},{append:c((()=>[qt])),_:1},8,["modelValue"])])),_:1})])),_:1})])),_:1}),g(o,{label:"提货人",prop:"delivery_user"},{default:c((()=>[g(n,{modelValue:E(l).delivery_user,"onUpdate:modelValue":a[10]||(a[10]=e=>E(l).delivery_user=e),placeholder:"请输入提货人",clearable:"",style:{width:"100%"}},null,8,["modelValue"])])),_:1}),g(o,{label:"备注",prop:"remark"},{default:c((()=>[g(n,{modelValue:E(l).remark,"onUpdate:modelValue":a[11]||(a[11]=e=>E(l).remark=e),type:"textarea",placeholder:"请输入备注",autosize:{minRows:4,maxRows:4},style:{width:"100%"}},null,8,["modelValue"])])),_:1}),g(o,{size:"large"},{default:c((()=>[g(f,{type:"primary",onClick:r},{default:c((()=>[Kt])),_:1}),g(f,{onClick:i},{default:c((()=>[Xt])),_:1})])),_:1})])),_:1},8,["model","rules"])])}}});const Yt=o("dingnengSettings",(()=>{const e="printFontSize",t=()=>{const t=localStorage.getItem(e);return console.log("getFromStorage",t),null==t||null==t?1:parseFloat(t)},a=t(),l=A(a);return{fontSize:l,getFromStorage:t,saveToStorage:()=>{localStorage.setItem(e,""+l.value)}}})),Bt=d({props:{code:{type:String,required:!0}},setup(e){const{code:t}=e,a=A(null);v((()=>{a.value&&l(a.value,t)}));const l=(e,t)=>{ve(e,t,{displayValue:!1,height:60})};return(e,t)=>(h(),w("svg",{ref_key:"barcodeRef",ref:a},null,512))}});const Ht=e=>(V("data-v-d893585c"),e=e(),j(),e),Gt=Ht((()=>y("div",{class:"order-header"},[y("img",{height:"40",width:"40",src:"/sn-tools/img/dingneng.png"}),y("span",null,"杭州鼎能供应链发运单")],-1))),Qt={style:{margin:"10px 0 0 0"}},Wt={style:{"text-align":"center"}},Zt={colspan:"3"},ea={colspan:"2"},ta={colspan:"5"},aa={colspan:"3"},la={colspan:"2"},na={colspan:"5"},ra=Ht((()=>y("tr",null,[y("td",{colspan:"5",style:{"text-align":"center",padding:"10px 0px","font-size":"1.12em"}}," 货物详情 ")],-1))),ia=Ht((()=>y("td",{style:{"text-align":"center"}},"合计",-1))),oa={style:{"text-align":"center"}},sa={colspan:"3"},ua={colspan:"2"},da={colspan:"5"},pa={colspan:"3"},ca=Ht((()=>y("td",{colspan:"2"},"签收人：",-1))),ma={colspan:"5"},ha={style:{border:"none"}},ga={colspan:"5"},fa={class:"other-wapper"},ba={class:"print-btn-wapper"},va={class:"print-btn-wapper"},ya=I("打印"),_a={class:"print-btn-wapper"},xa=I("返回");var wa=Ie(d({setup(e){const t=be(),a=Ut(),l=Yt(),n=a.$state,r=A(!1),{fontSize:i}=s(l),o=e=>{l.saveToStorage()},u=f((()=>{let e=new Date(n.send_time);return e.getFullYear()+"年"+(e.getMonth()+1)+"月"+e.getDate()+"日"})),d=f((()=>{let e=new Date(n.recipient_time);return e.getFullYear()+"年"+(e.getMonth()+1)+"月"+e.getDate()+"日"})),p=()=>{r.value=!0,t.back()},m=()=>{window.print()};return(e,t)=>{const l=oe,s=ne;return h(),w(k,null,[y("div",{class:"order-wapper print",style:O({fontSize:E(i)+"em"})},[Gt,y("p",Qt,"运单号："+D(E(n).dn_order_id),1),y("div",Wt,[g(Bt,{code:E(n).dn_order_id},null,8,["code"])]),y("table",null,[y("tbody",null,[y("tr",null,[y("td",Zt,"发货人："+D(E(n).sender),1),y("td",ea,"电话："+D(E(n).sender_phone),1)]),y("tr",null,[y("td",ta,"收货单位："+D(E(n).recipient_company),1)]),y("tr",null,[y("td",aa,"收货人："+D(E(n).recipient),1),y("td",la,"电话："+D(E(n).recipient_phone),1)]),y("tr",null,[y("td",na,"收货地址："+D(E(n).address),1)]),ra,y("tr",null,[(h(!0),w(k,null,S(E(n).goodsList,(e=>(h(),w("td",{class:"border-right",key:e.key},D(e.text),1)))),128)),ia]),y("tr",null,[(h(!0),w(k,null,S(E(n).goodsList,(e=>(h(),w("td",{class:"border-right",key:e.key},D(e.value),1)))),128)),y("td",oa,D(E(a).total_count),1)]),y("tr",null,[y("td",sa,"体积："+D(E(n).total_volume)+" m³",1),y("td",ua,"重量："+D(E(n).total_weight)+" KG",1)]),y("tr",null,[y("td",da,"发运时间："+D(E(u)),1)]),y("tr",null,[y("td",pa,"提货人："+D(E(n).delivery_user),1),ca]),y("tr",null,[y("td",ma,"日期："+D(E(d)),1)]),y("tr",ha,[y("td",ga,"备注："+D(E(n).remark),1)])])])],4),y("div",fa,[y("div",ba,[g(l,{modelValue:E(i),"onUpdate:modelValue":t[0]||(t[0]=e=>J(i)?i.value=e:null),precision:2,step:.1,min:1,max:2,onChange:o,style:{width:"200px","margin-left":"74px"}},null,8,["modelValue","step"])]),y("div",va,[g(s,{type:"primary",class:"print-btn",onClick:m},{default:c((()=>[ya])),_:1})]),y("div",_a,[g(s,{onClick:p,loading:r.value},{default:c((()=>[xa])),_:1},8,["loading"])])])],64)}}}),[["__scopeId","data-v-d893585c"]]);function Sa(e,t){return e=Math.ceil(e),t=Math.floor(t),Math.floor(Math.random()*(t-e))+e}function ka(e){return e<10&&"0"+e||e}const Va=(e,t)=>{let a={};for(const l in e)if(Object.prototype.hasOwnProperty.call(e,l)){const t=e[l];a[l]=Ve.json_to_sheet(t)}!function(e,t){let a="";"object"==typeof e&&e instanceof Blob&&(a=URL.createObjectURL(e));var l,n=document.createElement("a");n.href=a,n.download=t||"",window.MouseEvent?l=new MouseEvent("click"):(l=document.createEvent("MouseEvents")).initMouseEvent("click",!0,!1,window,0,0,0,0,0,!1,!1,!1,!1,0,null),n.dispatchEvent(l),n.remove()}(function(e){var t={SheetNames:Object.keys(e),Sheets:{}};for(const l in e)if(Object.prototype.hasOwnProperty.call(e,l)){const a=e[l];t.Sheets[l]=a}var a=je(t,{bookType:"xlsx",bookSST:!1,type:"binary"});return new Blob([function(e){for(var t=new ArrayBuffer(e.length),a=new Uint8Array(t),l=0;l!=e.length;++l)a[l]=255&e.charCodeAt(l);return t}(a)],{type:"application/octet-stream"})}(a),function(e,t){let a=t.lastIndexOf("."),l=1==e.length&&e[0]+"-"||"";return t.substring(0,a)+"-"+l+ +new Date+t.substring(a)}(Object.keys(a),t))};const ja=(e,t,a,l,n="\t")=>{let r=e.Sheets[e.SheetNames[t]],i=Ve.sheet_to_txt(r).split("\n");null==l&&(l=a.find((e=>i[0].includes(e.zhKey)||i[0].includes(e.key)))?1:0);let o=[];for(let s=l;s<i.length;s++){let e=i[s].split(n),t={};for(const l of a)t[l.key]=e[l.index].trim();o.push(t)}return o},Ia="application/vnd.openxmlformats-officedocument.spreadsheetml.sheet";const Da=y("div",{class:"el-upload__text"},[I(" Drop file here or "),y("em",null,"click to upload")],-1),Aa=d({emits:["change"],setup(e,{emit:t}){const a=A(),{valiteFile:l,handleExceed:n,acceptType:r}=(e=>({valiteFile:(e,t)=>{let a=e.raw;if(a){if(a.type==Ia)return!0;H({type:"warning",message:"附件格式错误，请删除后重新上传！"})}else H({type:"warning",message:"请上传附件！"});return!1},handleExceed:t=>{e.value.clearFiles();const a=t[0];a.uid=Date.now(),e.value.handleStart(a)},acceptType:Ia}))(a),i=(e,a)=>{l(e,a)&&e.raw&&t("change",e.raw)};return(e,t)=>{const l=G;return h(),p(E(Q),{drag:"",ref_key:"uploadRef",ref:a,action:"","on-change":i,"on-exceed":E(n),limit:1,accept:E(r),"auto-upload":!1},{default:c((()=>[g(l,{class:"el-icon--upload"},{default:c((()=>[g(E(Se))])),_:1}),Da])),_:1},8,["on-exceed","accept"])}}}),Ca=[{id:57,text:"陆放",label:"kluger"},{id:38,text:"荣放",label:"rav4"}],Ta={index:-1,label:"全部"},La="city",Ea="username",Oa="phone",Ja="series_id",Pa="dealer_id",Na="company",Ma="order_at";var Ua=(e=>(e[e.DATA=0]="DATA",e[e.SERIES=1]="SERIES",e))(Ua||{});const Ra={data:{id:0,text:"数据"},seriesData:{id:1,text:"车系资料"}},za=[{key:"city",zhKey:"城市",index:1},{key:"username",zhKey:"姓名",index:5},{key:"phone",zhKey:"电话",index:6}],Fa=[{key:"dealerId",zhKey:"经销商编码",index:0},{key:"name",zhKey:"经销商名称",index:1},{key:"city",zhKey:"城市",index:2}],qa={hour:[9,10,11,12,13,14,15,16,17,18,19,20,21,22],weight:[9,6,3,2,1,3,4,3,3,8,8,4,2,1]},Ka=qa.weight.reduce(((e,t)=>e+t)),Xa=o("ftmsStore",(()=>{let e=new Date;const t=A([new Date(e.getFullYear(),e.getMonth(),e.getDate()-1,18),new Date(e.getFullYear(),e.getMonth(),e.getDate(),17,30,0)]),a=L(Ra);function l(e){return e.label+e.id}function n(e){let t=localStorage.getItem(l(e));return t&&JSON.parse(t)||[]}const r=L({[Ca[0].label]:n(Ca[0]),[Ca[1].label]:n(Ca[1])});return{dateTime:t,uploadTypeRadioKeyList:a,seriesList:r,saveSeries:function(e,t){localStorage.setItem(l(t),JSON.stringify(e)),r[t.label]=e},hasSeriesData:function(e){return r[e.label].length>0}}}));const $a={class:"title"};var Ya=Ie(d({props:{text:{type:String,default:"项"}},setup:e=>(t,a)=>(h(),w("span",$a,D(e.text),1))}),[["__scopeId","data-v-0232ad94"]]);const Ba={style:{"margin-bottom":"20px"}};var Ha=Ie(d({props:["modelValue"],emits:["update:modelValue"],setup(e,{emit:t}){const a=e,{uploadTypeRadioKeyList:l}=Xa(),n=f({get:()=>a.modelValue,set:e=>t("update:modelValue",e)});return(e,t)=>{const a=de,r=Z;return h(),w("div",Ba,[g(Ya,{text:"数据类型"}),g(r,{modelValue:E(n),"onUpdate:modelValue":t[0]||(t[0]=e=>J(n)?n.value=e:null)},{default:c((()=>[(h(!0),w(k,null,S(E(l),(e=>(h(),p(a,{label:e.id,border:""},{default:c((()=>[I(D(e.text),1)])),_:2},1032,["label"])))),256))])),_:1},8,["modelValue"])])}}}),[["__scopeId","data-v-6c197776"]]);const Ga=d({setup(e){const{dateTime:t}=s(Xa());return(e,a)=>{const l=se,n=ie,r=ue;return h(),p(r,{inline:!0,class:"demo-form-inline"},{default:c((()=>[g(n,{label:"时间范围"},{default:c((()=>[g(l,{modelValue:E(t),"onUpdate:modelValue":a[0]||(a[0]=e=>J(t)?t.value=e:null),type:"datetimerange","range-separator":"To","start-placeholder":"Start date","end-placeholder":"End date"},null,8,["modelValue"])])),_:1})])),_:1})}}});function Qa(){const{dateTime:e}=Xa();let t=function(e,t){let a=Sa(0,t);for(let l=0;l<e.length;l++)if(a-=e[l],a<=0)return l;return 0}(qa.weight,Ka),a=qa.hour[t],l=new Date(Sa(e[0].getTime(),e[1].getTime()));for(;l.getHours()!=a;)l=new Date(Sa(e[0].getTime(),e[1].getTime()));let n=l.getFullYear(),r=l.getMonth()+1,i=l.getDate(),o=ka(l.getMinutes()),s=ka(l.getSeconds());return n+"-"+ka(r)+"-"+ka(i)+" "+ka(a)+":"+o+":"+s}function Wa(e,t){let a=Ca.filter((t=>e.includes(t.text)));if(a.length>0)return a[0];if(a=Ca.filter((e=>t.includes(e.text))),a.length>0)return a[0];throw new Error("没有从文件名或sheet name 中找到车系名称")}var Za=(e,o)=>{const{seriesList:u}=s(Xa());let d=u.value[o.label],p=e.map((e=>{return s=((e,t)=>{for(var a in t||(t={}))n.call(t,a)&&i(e,a,t[a]);if(l)for(var a of l(t))r.call(t,a)&&i(e,a,t[a]);return e})({},e),u={seriesId:o.id},t(s,a(u));var s,u})),c=new Set;p.forEach((e=>c.add(e.city)));let m={};return c.forEach((e=>{if(m[e]=d.filter((t=>t.city==e)),0==m[e].length)throw new Error(`没有该字段的车系数据：${e}`)})),function(e,t){e.forEach((e=>{let a=Sa(0,t[e.city].length),l=t[e.city][a];e.dealerId=l.dealerId,e.dealerName=l.name}))}(p,m),function(e){e.forEach((e=>{e.orderAt=Qa()}))}(p),p.map((e=>{let t={};return t[La]=e.city,t[Ea]=e.username,t[Oa]=e.phone,t[Pa]=e.dealerId,t[Na]=e.dealerName,t[Ja]=e.seriesId,t[Ma]=e.orderAt,t}))},el=()=>{const e=Xa(),{uploadTypeRadioKeyList:t}=s(e),a=A(t.value.data.id),l=A(),n=L({visible:!1,sheetNames:[],sheetIndex:Ta.index,fileName:""});P((()=>n.fileName),(()=>n.sheetIndex=Ta.index));function r(e){if(e==Ua.DATA)return za;if(e==Ua.SERIES)return Fa;throw new Error(`没有此类型key:${e}`)}return{workBook:l,sheetDialogConfig:n,openSheetDialog:(e,t)=>{n.sheetNames=t,n.visible=!0,n.fileName=e},uploadType:a,handleSheetSelect:t=>{if(!l.value)return;let i={};if(t==Ta.index){let e=l.value.SheetNames,t=r(a.value);for(let a=0;a<e.length;a++)i[e[a]]=ja(l.value,a,t)}else i[l.value.SheetNames[t]]=ja(l.value,t,r(a.value));try{(t=>{const{sheetObject:a,fileName:l,uploadType:n}=t;if(n.value==Ua.DATA){let t={};for(const n in a)if(Object.prototype.hasOwnProperty.call(a,n)){const r=a[n];let i=Wa(n,l);if(!e.hasSeriesData(i))throw new Error(`没有该车系的数据：${i.text} 请先上传${i.text}的数据`);t[n]=Za(r,i)}Va(t,l)}else{if(n.value!=Ua.SERIES)throw new Error("类型错误");for(const t in a)if(Object.prototype.hasOwnProperty.call(a,t)){const n=a[t];let r=Wa(t,l);e.saveSeries(n,r),H.success(`已添加${t}${n.length}条数据`)}}})({sheetObject:i,fileName:n.fileName,uploadType:a})}catch(o){console.error(o),H.error(o.message)}finally{l.value=void 0}}}};var tl=Ie(d({setup(e){const{seriesList:t}=s(Xa()),a=A(!1),l=f((()=>{let e=0==t.value[Ca[0].label].length;return{title:`${Ca[0].text} 数据不存在`,show:e}})),n=f((()=>{let e=0==t.value[Ca[1].label].length;return{title:`${Ca[1].text} 数据不存在`,show:e}}));return(e,t)=>(h(),w(k,null,[E(l).show?(h(),p(E(pe),{key:0,title:E(l).title,type:"error",closable:a.value},null,8,["title","closable"])):N("",!0),E(n).show?(h(),p(E(pe),{key:1,title:E(n).title,type:"error",closable:a.value},null,8,["title","closable"])):N("",!0)],64))}}),[["__scopeId","data-v-0bb6ce8f"]]);const al=d({setup(e){const{seriesList:t}=s(Xa()),a=f((()=>({label:Ca[0].text,desc:`${t.value[Ca[0].label].length}条`}))),l=f((()=>({label:Ca[1].text,desc:`${t.value[Ca[1].label].length}条`})));return(e,t)=>{const n=ce,r=me;return h(),p(r,{border:"",title:"车系资料"},{default:c((()=>[g(n,{"label-align":"right",align:"center",label:E(a).label},{default:c((()=>[I(D(E(a).desc),1)])),_:1},8,["label"]),g(n,{"label-align":"right",align:"center",label:E(l).label},{default:c((()=>[I(D(E(l).desc),1)])),_:1},8,["label"])])),_:1})}}}),ll={class:"dialog-footer"},nl=I("取消"),rl=I(" 确定 "),il=d({props:{sheetIndex:{type:Number,default:Ta.index},visible:{type:Boolean,default:!1},fileName:{type:String},sheetNames:{type:Array,default:[]}},emits:["update:sheetIndex","update:visible","select"],setup(e,{emit:t}){const a=e,l=f({get:()=>[Ta,...a.sheetNames.map(((e,t)=>({index:t,label:e})))],set(e){console.log(e)}}),n=f({get:()=>a.visible,set(e){t("update:visible",e)}}),r=e=>{t("update:sheetIndex",e)},i=()=>{n.value=!1,t("select",a.sheetIndex)};return(t,a)=>{const o=W,s=Z,u=ne,d=he;return h(),p(d,{modelValue:E(n),"onUpdate:modelValue":a[2]||(a[2]=e=>J(n)?n.value=e:null),title:"选择Sheet"},{footer:c((()=>[y("span",ll,[g(u,{onClick:a[1]||(a[1]=e=>n.value=!1)},{default:c((()=>[nl])),_:1}),g(u,{type:"primary",onClick:i},{default:c((()=>[rl])),_:1})])])),default:c((()=>[y("p",null,D(e.fileName),1),g(Ya,{text:"Sheet"}),g(s,{modelValue:e.sheetIndex,"onUpdate:modelValue":a[0]||(a[0]=e=>J(sheetIndex)?sheetIndex.value=e:null),onChange:r},{default:c((()=>[(h(!0),w(k,null,S(E(l),(e=>(h(),p(o,{label:e.index,border:""},{default:c((()=>[I(D(e.label),1)])),_:2},1032,["label"])))),256))])),_:1},8,["modelValue"])])),_:1},8,["modelValue"])}}}),ol=y("h2",{style:{"text-align":"center"}},"2023年1月份留资数据格式化",-1),sl=[{path:"/",name:"index",component:Vt,meta:{menuHidden:!0},children:[{path:"/",name:"dashboard",component:Et,meta:{title:"首页"}},{path:"/volume",name:"volume",component:ht,meta:{title:"体积计算"}},{path:"/tongji",name:"tongji",component:Ge,meta:{title:"品牌统计"}},{path:"/ftms",name:"ftms",component:d({setup(e){const{uploadType:t,sheetDialogConfig:a,openSheetDialog:l,workBook:n,handleSheetSelect:r}=el(),i=e=>{var t;(t=e,new Promise(((e,a)=>{let l=new FileReader;l.onload=t=>{var l;try{e(ke(null==(l=t.target)?void 0:l.result))}catch(n){a(n)}},l.readAsArrayBuffer(t)}))).then((t=>{let a=t;n.value=a,l(e.name,n.value.SheetNames)})).catch((e=>{n.value=void 0,H.error(e.message),console.error(e)}))};return(e,l)=>{const n=Y,o=$;return h(),w(k,null,[ol,g(tl),g(o,{gutter:20},{default:c((()=>[g(n,{span:12},{default:c((()=>[g(Ga),g(al)])),_:1}),g(n,{span:12},{default:c((()=>[g(Ha,{modelValue:E(t),"onUpdate:modelValue":l[0]||(l[0]=e=>J(t)?t.value=e:null)},null,8,["modelValue"]),g(Aa,{onChange:i})])),_:1})])),_:1}),g(il,{sheetIndex:E(a).sheetIndex,"onUpdate:sheetIndex":l[1]||(l[1]=e=>E(a).sheetIndex=e),visible:E(a).visible,"onUpdate:visible":l[2]||(l[2]=e=>E(a).visible=e),"sheet-names":E(a).sheetNames,onSelect:E(r),"file-name":E(a).fileName},null,8,["sheetIndex","visible","sheet-names","onSelect","file-name"])],64)}}}),meta:{title:"留资数据格式化"}},{path:"dingnengorder",name:"dingnengOrder",redirect:"/dingnengorder/create",meta:{title:"鼎能面单"},children:[{path:"create",name:"dingnengOrderCreate",component:$t,meta:{menuHidden:!0}}]},{path:"/:pathMatch(.*)*",name:"NotFound",component:Pt,meta:{menuHidden:!0}}]},{path:"/dingnengorder/print",name:"dingnengOrderPrint",component:wa,meta:{menuHidden:!0}}],ul=ye({history:_e(),routes:sl});const dl=u();M(De).use(ul).use(dl).mount("#app");
